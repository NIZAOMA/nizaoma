(function (a) {
    with (a) {
        a.Qs = function (b, c) { this.da = b; this.offset = c }, a.Rs = function (b) { return b.length || b.childNodes.length }, a.Ss = function (b, c, d) { for (; 1 == b.nodeType;) { var e = b.childNodes[c]; if (!e && !b.lastChild) break; e ? (b = e.previousSibling, d && b ? c = Rs(b) : (b = e, c = 0)) : (b = b.lastChild, c = Rs(b)) } return new Qs(b, c) }, a.Ts = function (b, c) { b != k && this.append.apply(this, arguments) }; t = Ts.prototype; t.th = ""; t.set = function (b) { this.th = "" + b }; t.append = function (b, c, d) { this.th += b; if (c != k) for (var e = 1; e < arguments.length; e++) this.th += arguments[e]; return this };
        t.clear = function () { this.th = "" }; t.pr = u(47); t.toString = p("th"); a.Us = function (b) { this.type = "anon_change"; this.kb = b }; y(Us, hd); a.Vs = function (b) { if ("outerHTML" in b) return b.outerHTML; var c = Sb(b).createElement("div"); c.appendChild(b.cloneNode(j)); return c.innerHTML }, a.Z = function (b, c) { return da[b] = c }; Of.prototype.expand = Z(60, function (b, c, d, e) { ra(b) ? (this.top -= b.top, this.right += b.right, this.bottom += b.bottom, this.left -= b.left) : (this.top -= b, this.right += c, this.bottom += d, this.left -= e); return this });
        Bp.prototype.expand = Z(59, function () { this.Ka(j) }); Sh.prototype.So = Z(58, function (b) { Th(this); this.Gk = b }); zi.prototype.So = Z(57, function (b) { this.Gk = b; this.Aa && Ai(this) }); ip.prototype.im = Z(53, function (b) { this.Ja(b) }); Yd.prototype.ji = Z(52, ca("RF")); Sh.prototype.Hx = Z(51, function () { return this.vj || 150 > za() - this.Px }); $p.prototype.Eb = Z(50, function () { var b = this.yc(); return 1 == b.nodeType ? b : b.parentNode }); Gr.prototype.Ke = Z(48, function (b) { this.$.st(b) }); Ts.prototype.pr = Z(47, function () { return this.th.length });
        zn.prototype.fireEvent = Z(36, function (b) { this.dispatchEvent(b) }); $n.prototype.Lc = Z(31, function () { return Gc(this.m()) }); lq.prototype.Lc = Z(30, function () { return this.Q.toString() }); qq.prototype.Lc = Z(29, function () { return this.Q.text }); Aq.prototype.Lc = Z(28, function () { return Eq(this).Lc() }); Gq.prototype.Lc = Z(27, s("")); Mq.prototype.Lc = Z(26, function () { return z.map(bq(this), function (b) { return b.Lc() }).join("") });
        Rb.prototype.lv = Z(21, function (b, c, d) { for (var e = this.Ha, g = !!d, d = ["<tr>"], h = 0; h < c; h++) d.push(g ? "<td>&nbsp;</td>" : "<td></td>"); d.push("</tr>"); d = d.join(""); c = ["<table>"]; for (h = 0; h < b; h++) c.push(d); c.push("</table>"); b = e.createElement("DIV"); b.innerHTML = c.join(""); return b.removeChild(b.firstChild) }); ep.prototype.rf = Z(20, function (b, c) { var d = b.Cd(), e = this.M() + "-collapse-left", g = this.M() + "-collapse-right"; b.Wi(d ? g : e, !!(c & 1)); b.Wi(d ? e : g, !!(c & 2)) }); pp.prototype.rf = Z(19, function (b) { this.N.rf(this, b) });
        Xh.prototype.Yo = Z(18, ca("Nj")); ip.prototype.Yo = Z(17, ca("Nj"));
        gf.prototype.Yp = Z(14, function (b, c, d) { var e = za(), g = d ? d : e, h = this.bl.Bg.length ? this.bl.Bg.pop() : this.bl.Nk(); h.dr = 2; h.cr = g; h.type = c; h.oC = b; b = (b = this.aY) && b.isTracing() ? b.totalVarAlloc : -1; h.bI = b; this.gv++; if (d) { d = this.If.length; for (b = 0; b < d; b++) if (this.If[b].cr > g) { z.Qn(this.If, h, b); break } b == d && this.If.push(h) } else this.If.push(h); if (g = h.type) h = this.ck.get(g), h || (h = this.ip.Bg.length ? this.ip.Bg.pop() : this.ip.Nk(), h.type = g, this.ck.set(g, h)), h.count++; this.St += za() - e });
        $d.prototype.config = Z(13, function (b, c) { this.log(fe, b, c) }); Gp.prototype.ow = Z(12, function () { return Jp }); Qr.prototype.nr = Z(0, p("Na"));
        a.Ws = function (b) { b.Ex = j; b.EC = ug(b.m()).height; vr += b.EC; z.forEach(tr, function (b) { b && (!b.Ex && b.gl) && b.Ko() }) }, a.Xs = function (b, c) { var d = b.parentNode, e = z.indexOf(d.childNodes, b) + (c ? 0 : 1), d = Ss(d, e, c); A && (Eb("9") && 1 == d.da.nodeType && "HR" == d.da.tagName) && (e = d.da, d.da = e.parentNode, d.offset = z.indexOf(d.da.childNodes, e) + (c ? 0 : 1)); Tq(d.da, d.offset).select() }, a.Ys = function (b, c) { b.dy = c == k || c instanceof Of ? c : new Of(c, i, i, i); b.S() && b.ma() }, a.Zs = function (b, c) {
            if (tm(b)) b.selectionStart = c, b.selectionEnd = c; else if (A) {
                var c =
                wm(b, c), d = b.createTextRange(); d.collapse(j); d.move("character", c); d.select()
            }
        }, a.$s = function (b) { var c = {}; z.forEach(b.data.Fb(), function (b) { c[b] = this.data.get(b) }, b); return c }, a.at = function (b) { b.ac() && b.fire() }, a.bt = function (b, c) { return b.Fd.get(c) }, a.ct = function (b, c, d) {
            var e = Mi, g = { title: "确认使用匿名身份？", content: '<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>' }, h = { title: "确认放弃匿名身份？", content: "你对该问题的回答、赞同和关注行为将以实名显示。" };
            Di(b ? g : h, function (g) { if (g) { var h = new V(j), q = "/question/" + (b ? "set_anonymous" : "set_public"), r = "qid=" + (d || eh.la); h.on("success", function () { var c = Ie(h); c && !c.r && e.dispatchEvent(new Us(b)) }); h.ajax(q, r) } c && c(g) })
        }, a.dt = function (b, c) { return b.Wb && c ? z.indexOf(b.Wb, c) : -1 }, a.et = function (b) { return b != k }, a.ft = function (b) { return !/[^\t\n\r ]/.test(b) }, a.gt = function (b, c, d) { this.XF = b; this.yS = !!d; b && !c && this.next() }; y(gt, Nd);
        gt.prototype.next = function () { var b = this.XF; b || f(O.bb); this.XF = this.yS ? b.previousSibling : b.nextSibling; return b }; a.ht = function (b) { return 1 == b.nodeType || 3 == b.nodeType && !ft(b.nodeValue) }, a.it = function (b) { try { return b.next() } catch (c) { return k } }, a.jt = function (b, c, d) { la(d) || (d = c && b.childNodes.length ? b.childNodes.length - 1 : 0); gt.call(this, b.childNodes[d], j, c) }; y(jt, gt);
        a.kt = function (b) { return 1 == b.length ? "0" + b : b }, a.lt = /^#(?:[0-9a-f]{3}){1,2}$/i, a.mt = function (b, c) { var d = $.extend({ all: m }, mt.defaults, c || {}), e = $(b).get(0).getBoundingClientRect(); return !d.all && (e.bottom < d.paddingTop || e.bottom > $(window).height()) || d.all && (e.top < d.paddingTop || e.bottom > $(window).height()) ? m : j }; mt.defaults = { paddingTop: 0 };
        a.nt = /^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i, a.ot = /#(.)(.)(.)/, a.pt = function (b) { var c = b.body, b = b.documentElement; return new Nb(c.scrollLeft || b.scrollLeft, c.scrollTop || b.scrollTop) }, a.qt = function (b) { for (var c; c = !b || 1 != b.nodeType ? k : it(O.filter(new jt(b, m), ht)) ;) b = c; return b }, a.rt = function (b, c, d) { Rp.call(this, b, 0, d ? "添加父话题" : "添加子话题"); this.Ix = d; this.vf = c; this.Rr = ""; this.cH = "/topic/parent/remove"; this.gX = j }; y(rt, Rp); t = rt.prototype;
        t.o = function (b) { if (this.isEnabled = !b.getAttribute("data-disabled")) rt.n.o.call(this, b), this.Zd(j), Q(this.vD, m) }; t.gf = function (b) { var c; this.Ix && (c = "/topic/autocomplete?no_create=true"); rt.n.gf.call(this, b, c); this.O.lf.sD = m }; t.dm = function () { return v(function (b, c) { return z.filter(b, function (b) { return 3 >= b.length ? m : z.every(this.data, function (e) { return e[1] === b[2] ? c === b[1] ? (b[0] = "plain_text", b[1] = '"' + c + '"已在现有列表中', j) : m : j }) }, this) }, this) };
        t.Se = function (b, c) { this.Qg || (this.Qg = j, this.xhr = new V(j), P(this.h(), this.xhr, "complete", this.wu), b || (b = -1), this.Ix ? this.xhr.ajax("/topic/add", "tid=" + this.vf + "&pid=" + b + "&topic_text=" + encodeURIComponent(c)) : this.xhr.ajax("/topic/add", "tid=" + this.vf + "&cid=" + b + "&topic_text=" + encodeURIComponent(c))) }; t.CD = function (b) { return '<a class="nor" href="/topic/' + b[1] + '/organize">' + b[0] + "</a>" };
        t.Bo = function (b) { if (!this.ia || !this.ia.ac()) { var c = new V(j); this.h().e(c, "success", function () { var d = Ie(c); d.r ? U(d.msg) : (Tp(this), this.Le(), this.dispatchEvent({ type: "remove_tag", data: { id: b } })) }); this.Ix ? c.ajax(this.cH, "cid=" + this.vf + "&pid=" + b) : c.ajax(this.cH, "pid=" + this.vf + "&cid=" + b); this.ia = c } }; a.st = function (b, c) { this.zh = b instanceof Nb ? b : new Nb(b, c) }; y(st, Wn); st.prototype.ma = function (b, c, d, e) { var g = pt(Sb(b)), h = this.zh.x + g.x, g = this.zh.y + g.y, l = Hm(b), h = h - l.x, g = g - l.y; Im(new Nb(h, g), b, c, d, k, k, e) };
        a.tt = function (b, c) { if (b) { "number" === $.type(c) && (c = { offsetTop: c }); var d = $.extend({ yI: mt }, Vk, c || {}); if (!d.yI(b, d)) { var e = $(b).offset().top - d.paddingTop - d.offsetTop || 0; d.GB ? $(document.documentElement).add(document.body).animate({ scrollTop: e }) : $(window).scrollTop(e) } } }, a.ut = function (b, c) { c.all = j; return mt(b, c) }, a.vt = function (b) { var c = b.match(nt); if (c) { var b = Number(c[1]), d = Number(c[2]), c = Number(c[3]); if (0 <= b && 255 >= b && 0 <= d && 255 >= d && 0 <= c && 255 >= c) return [b, d, c] } return [] }, a.wt = function (b) {
            lt.test(b) || f(Error("'" +
            b + "' is not a valid hex color")); 4 == b.length && (b = b.replace(ot, "#$1$1$2$2$3$3")); return b.toLowerCase()
        }, a.xt = {
            aliceblue: "#f0f8ff", antiquewhite: "#faebd7", aqua: "#00ffff", aquamarine: "#7fffd4", azure: "#f0ffff", beige: "#f5f5dc", bisque: "#ffe4c4", black: "#000000", blanchedalmond: "#ffebcd", blue: "#0000ff", blueviolet: "#8a2be2", brown: "#a52a2a", burlywood: "#deb887", cadetblue: "#5f9ea0", chartreuse: "#7fff00", chocolate: "#d2691e", coral: "#ff7f50", cornflowerblue: "#6495ed", cornsilk: "#fff8dc", crimson: "#dc143c", cyan: "#00ffff",
            darkblue: "#00008b", darkcyan: "#008b8b", darkgoldenrod: "#b8860b", darkgray: "#a9a9a9", darkgreen: "#006400", darkgrey: "#a9a9a9", darkkhaki: "#bdb76b", darkmagenta: "#8b008b", darkolivegreen: "#556b2f", darkorange: "#ff8c00", darkorchid: "#9932cc", darkred: "#8b0000", darksalmon: "#e9967a", darkseagreen: "#8fbc8f", darkslateblue: "#483d8b", darkslategray: "#2f4f4f", darkslategrey: "#2f4f4f", darkturquoise: "#00ced1", darkviolet: "#9400d3", deeppink: "#ff1493", deepskyblue: "#00bfff", dimgray: "#696969", dimgrey: "#696969", dodgerblue: "#1e90ff",
            firebrick: "#b22222", floralwhite: "#fffaf0", forestgreen: "#228b22", fuchsia: "#ff00ff", gainsboro: "#dcdcdc", ghostwhite: "#f8f8ff", gold: "#ffd700", goldenrod: "#daa520", gray: "#808080", green: "#008000", greenyellow: "#adff2f", grey: "#808080", honeydew: "#f0fff0", hotpink: "#ff69b4", indianred: "#cd5c5c", indigo: "#4b0082", ivory: "#fffff0", khaki: "#f0e68c", lavender: "#e6e6fa", lavenderblush: "#fff0f5", lawngreen: "#7cfc00", lemonchiffon: "#fffacd", lightblue: "#add8e6", lightcoral: "#f08080", lightcyan: "#e0ffff", lightgoldenrodyellow: "#fafad2",
            lightgray: "#d3d3d3", lightgreen: "#90ee90", lightgrey: "#d3d3d3", lightpink: "#ffb6c1", lightsalmon: "#ffa07a", lightseagreen: "#20b2aa", lightskyblue: "#87cefa", lightslategray: "#778899", lightslategrey: "#778899", lightsteelblue: "#b0c4de", lightyellow: "#ffffe0", lime: "#00ff00", limegreen: "#32cd32", linen: "#faf0e6", magenta: "#ff00ff", maroon: "#800000", mediumaquamarine: "#66cdaa", mediumblue: "#0000cd", mediumorchid: "#ba55d3", mediumpurple: "#9370d8", mediumseagreen: "#3cb371", mediumslateblue: "#7b68ee", mediumspringgreen: "#00fa9a",
            mediumturquoise: "#48d1cc", mediumvioletred: "#c71585", midnightblue: "#191970", mintcream: "#f5fffa", mistyrose: "#ffe4e1", moccasin: "#ffe4b5", navajowhite: "#ffdead", navy: "#000080", oldlace: "#fdf5e6", olive: "#808000", olivedrab: "#6b8e23", orange: "#ffa500", orangered: "#ff4500", orchid: "#da70d6", palegoldenrod: "#eee8aa", palegreen: "#98fb98", paleturquoise: "#afeeee", palevioletred: "#d87093", papayawhip: "#ffefd5", peachpuff: "#ffdab9", peru: "#cd853f", pink: "#ffc0cb", plum: "#dda0dd", powderblue: "#b0e0e6", purple: "#800080", red: "#ff0000",
            rosybrown: "#bc8f8f", royalblue: "#4169e1", saddlebrown: "#8b4513", salmon: "#fa8072", sandybrown: "#f4a460", seagreen: "#2e8b57", seashell: "#fff5ee", sienna: "#a0522d", silver: "#c0c0c0", skyblue: "#87ceeb", slateblue: "#6a5acd", slategray: "#708090", slategrey: "#708090", snow: "#fffafa", springgreen: "#00ff7f", steelblue: "#4682b4", tan: "#d2b48c", teal: "#008080", thistle: "#d8bfd8", tomato: "#ff6347", turquoise: "#40e0d0", violet: "#ee82ee", wheat: "#f5deb3", white: "#ffffff", whitesmoke: "#f5f5f5", yellow: "#ffff00", yellowgreen: "#9acd32"
        },
        a.yt = /[^\d]+$/, a.zt = function (b) { Tq(qt(b), 0).select() }, a.At = function (b, c) { var d = Hc(b); if (b.getElementsByTagName) for (var e in rr) if (b.tagName == e || 0 < b.getElementsByTagName(e).length) return m; return !c && " " == d || ft(d) }, a.Bt = j, a.Ct = function (b) { if (b = aq(b || window)) if (b.empty) try { b.empty() } catch (c) { } else try { b.removeAllRanges() } catch (d) { } }, a.Dt = function (b) { Rp.call(this); this.FC = k; this.Wc = "例如：互联网、医学、法律、数学..."; this.data = b || [] }; y(Dt, Rp); t = Dt.prototype;
        t.o = function (b) {
            this.g = b; this.Pe = J("zm-tag-editor-labels", this.g); this.Zd(j); this.pe(); this.Ra(); this.Jf = H("zh-expert-topics"); this.Em = H("zh-active-topics"); if (this.Jf) $(this.Jf).on("click", ".del", $.proxy(function (b) { var d = $(b.target).parents(".item"); d.data("active") ? (mc(this.Em, d[0], 0), Gk(d[0])) : L(d[0]); z.forEach(this.data, function (b, c) { b + "" === d.data("url-token") + "" && this.data.splice(c, 1) }, this); Et(this); this.dispatchEvent("remove") }, this)); if (this.Em) $(this.Em).on("click", ".add", $.proxy(function (b) {
                b =
                $(b.target).parents(".item"); mc(this.Jf, b[0], 0); Gk(b[0]); Et(this); this.dispatchEvent("add")
            }, this)); this.data = $("#zh-expert-topics .item").map(function () { return $(this).data("url-token") }).get(); this.cm()
        }; t.qn = function () { this.gc || (this.gc = K("div", "zm-tag-editor-editor", [this.$e = K("div", "zg-section zm-tag-editor-command-buttons-wrap", [this.Qa = H("profile-expert-edit-input")])]), this.Wc && (this.Nx = new Co(this.Wc), this.Nx.o(this.Qa), this.Qa.title = this.Wc), lc(this.gc, this.Pe), this.gf(this.$e)) };
        t.gf = function (b) { this.O = new Oo("/topic/autocomplete", this.Qa, k, k, b, j); this.O.dg(j); this.O.Vh = this.Ed; this.O.Zo(this.dm()); this.O.Sv = [this.Wc]; this.h().e(this.O, "select", this.so); this.h().e(this.O, nm.ph.xi, this.vu); this.h().e(this.O, nm.ph.xi, this.tu); this.h().e(this.O, nm.ph.YI, function () { $(this.O.N.g).hide() }) }; t.tu = function () { if (0 === this.O.hb.length) { var b = K("div", { className: "zu-autocomplete-empty" }, "没有名字为 " + $(this.Qa).val() + " 的话题"); $(this.O.N.g).html(b).show() } };
        t.so = function () { var b = this.O.Fg().slice(1); b && 3 < b.length && (this.JC = b, this.Se(b)) }; t.Se = function (b) { this.data.push(b[1]); var c = $(this.Jf).find("[data-url-token='" + b[1] + "']")[0]; c ? Gk(c) : (ak("TopicMediumV2", { member_url_token: S[1], topic_url_token: b[1] }, this.Iq, this), $(this.Em).find("[data-url-token='" + b[1] + "']").remove(), this.dispatchEvent("add")) }; t.Iq = function (b) { b = $(b)[0]; mc(this.Jf, b, 0); Gk(b); Et(this) }; t.Le = ba();
        t.cm = function () { if (!ch.Ac) { var b = this; this.Ff && this.Ff.H(); var c = new Yl; c.Xq = "expert-item-moving"; Zl(c, this.Jf, 4); c.B(); this.Ff = c; this.h().e(this.Ff, "dragend", function () { this.dispatchEvent("sort") }); $("a, input, .del, .add", this.Jf).each(function () { b.h().e(this, "mousedown", function (b) { b.stopPropagation() }) }); this.h().e(this.Ff, "beforedragstart", function () { return J("editing", this.Jf) ? m : j }) } };
        a.Et = function (b) { var c = $(b.Jf).children().length; 6 < c && L($(b.Jf).children()[6]); Q(H("zh-profile-expert-empty"), 0 >= c); 0 < c && Q(H("zh-profile-expert-warning"), m); Q(H("active-topics-wrap"), $(b.Em).children().length); b.cm() }; t.dm = function () { return v(function (b) { return z.filter(b, function (b) { return z.every(this.data, function (d) { return d + "" !== b[2] + "" && 3 < b.length }) }, this) }, this) }; a.Ft = function (b) { Rp.call(this, b, 0); this.Rr = ""; this.XB = "/topic/ignore" }; y(Ft, rt);
        Ft.prototype.Se = function (b) { this.Qg || (this.Qg = j, this.xhr = new V(j), P(this.h(), this.xhr, "complete", this.wu), this.xhr.ajax(this.XB, "tid=" + b + "&method=add")) }; Ft.prototype.Bo = function (b) { this.Qg || (this.Qg = j, this.xhr = new V(j), this.h().e(this.xhr, "complete", function () { Tp(this); this.Le(); this.Qg = m }), this.xhr.ajax(this.XB, "tid=" + b + "&method=del")) }; a.Gt = function () { Rp.call(this, k, k, "搜索话题"); this.FC = k; this.Wc = ""; this.data = [hh[0]] }; y(Gt, Rp); t = Gt.prototype;
        t.o = function (b) { this.g = b; this.Pe = J("zm-tag-editor-labels", this.g); this.Zd(j); this.pe(); this.Ra() }; t.qn = function () { this.gc || (this.gc = K("div", "zm-tag-editor-editor", [this.mn = K("div", "zg-section zg-clear"), this.$e = K("div", "zg-section zm-tag-editor-command-buttons-wrap", [this.Qa = H("zh-topic-merge-input"), K("a", { "class": "zg-mr15 zg-btn-blue", href: "#", name: "add", style: "display:none;" }, "添加"), this.vD = H("zh-topic-merge-btn")])]), lc(this.gc, this.Pe), this.gf(this.$e)) };
        t.gf = function (b) { this.O = new Oo("/topic/autocomplete", this.Qa, k, k, b, j); this.O.dg(j); this.O.Vh = this.Ed; this.O.Zo(this.dm()); this.O.Sv = [this.Wc]; this.h().e(this.O, "select", this.so); this.h().e(this.O, nm.ph.xi, this.vu) }; t.dm = function () { return v(function (b) { return z.filter(b, function (b) { return z.every(this.data, function (d) { return d[1] !== b[1] && 3 < b.length }) }, this) }, this) }; t.so = function () { var b = this.O.Fg().slice(1); b && 3 < b.length && (this.JC = b, this.Se(b[3], b[0])) };
        t.Se = function (b, c) { var d = this; setTimeout(function () { d.Qa.value = c }); this.FC = b }; t.Le = ba(); a.Ht = function (b) { Rp.call(this, [], 0); this.DC = this.fs = k; this.SB = "/reviewq/question?queue_id=" + b + "&task_id=" }; y(Ht, Rp); Ht.prototype.fR = function () { this.locked = m; var b = Ie(this.xA); b && b.r ? U(b.msg) : (this.data = b.msg, this.Zd(j), Tp(this)) }; a.It = function (b, c, d) { T.call(this, d); this.N = c || Gp.T(); this.xb = b || this.N.ow() }; y(It, T); t = It.prototype; t.Lx = k; t.nb = k; t.N = k; t.xb = k; t.lb = j; t.ic = j; t.ew = j; t.Gb = -1; t.oc = k; t.Uf = m; t.cK = m; t.qR = j;
        t.sg = k; t.kc = function () { return this.Lx || this.N.kc(this) }; t.or = function () { return this.nb || (this.nb = new bl(this.kc())) }; t.w = function () { this.g = this.N.w(this) }; t.Z = function () { return this.N.Z(this.m()) }; t.vc = function (b) { return this.N.vc(b) }; t.ea = function (b) { this.g = this.N.o(this, b); "none" == b.style.display && (this.lb = m) };
        t.C = function () { It.n.C.call(this); Ph(this, function (b) { b.Aa && Jt(this, b) }, this); var b = this.m(); this.N.De(this); this.F(this.lb, j); this.h().e(this, "enter", this.Mw).e(this, "highlight", this.Rw).e(this, "unhighlight", this.$w).e(this, "open", this.GN).e(this, "close", this.RM).e(b, "mousedown", this.Ae).e(Sb(b), "mouseup", this.YM).e(b, ["mousedown", "mouseup", "mouseover", "mouseout", "contextmenu"], this.QM); this.Rh() && Kt(this, j) };
        a.Kt = function (b, c) { var d = b.h(), e = b.kc(); c ? d.e(e, "focus", b.ze).e(e, "blur", b.Uc).e(b.or(), "key", b.Zb) : d.Fa(e, "focus", b.ze).Fa(e, "blur", b.Uc).Fa(b.or(), "key", b.Zb) }; t.jb = function () { this.Qb(-1); this.oc && this.oc.rb(m); this.Uf = m; It.n.jb.call(this) }; t.z = function () { It.n.z.call(this); this.nb && (this.nb.H(), this.nb = k); this.N = this.oc = this.sg = this.Lx = k }; t.Mw = s(j);
        t.Rw = function (b) { var c = dt(this, b.target); if (-1 < c && c != this.Gb) { var d = Lt(this); d && d.pd(m); this.Gb = c; d = Lt(this); this.Uf && d.setActive(j); this.qR && (this.oc && d != this.oc) && (d.Rb & 64 ? d.rb(j) : this.oc.rb(m)) } Oc(this.m(), Vc.Am, b.target.m().id) }; t.$w = function (b) { b.target == Lt(this) && (this.Gb = -1); Oc(this.m(), Vc.Am, "") }; t.GN = function (b) { if ((b = b.target) && b != this.oc && b.getParent() == this) this.oc && this.oc.rb(m), this.oc = b }; t.RM = function (b) { b.target == this.oc && (this.oc = k) };
        t.Ae = function (b) { this.ic && (this.Uf = j); var c = this.kc(); c && Dc(c) ? c.focus() : b.preventDefault() }; t.YM = function () { this.Uf = m }; t.QM = function (b) { var c; a: { c = b.target; if (this.sg) for (var d = this.m() ; c && c !== d;) { var e = c.id; if (e in this.sg) { c = this.sg[e]; break a } c = c.parentNode } c = k } if (c) switch (b.type) { case "mousedown": c.Ae(b); break; case "mouseup": c.Pf(b); break; case "mouseover": c.kd(b); break; case "mouseout": c.Oh(b); break; case "contextmenu": c.Dn(b) } }; t.ze = ba(); t.Uc = function () { this.Qb(-1); this.Uf = m; this.oc && this.oc.rb(m) };
        t.Zb = function (b) { return this.isEnabled() && this.S() && (0 != Qh(this) || this.Lx) && this.ff(b) ? (b.preventDefault(), b.stopPropagation(), j) : m };
        t.ff = function (b) {
            var c = Lt(this); if (c && "function" == typeof c.Zb && c.Zb(b) || this.oc && this.oc != c && "function" == typeof this.oc.Zb && this.oc.Zb(b)) return j; if (b.shiftKey || b.ctrlKey || b.metaKey || b.altKey) return m; switch (b.keyCode) {
                case 27: if (this.Rh()) this.kc().blur(); else return m; break; case 36: Mt(this); break; case 35: Nt(this, function (b, c) { b--; return 0 > b ? c - 1 : b }, 0); break; case 38: if (this.xb == Jp) Ot(this); else return m; break; case 37: if (this.xb == Ip) this.Cd() ? Pt(this) : Ot(this); else return m; break; case 40: if (this.xb ==
                Jp) Pt(this); else return m; break; case 39: if (this.xb == Ip) this.Cd() ? Ot(this) : Pt(this); else return m; break; default: return m
            } return j
        }; a.Jt = function (b, c) { var d = c.m(), d = d.id || (d.id = c.Td()); b.sg || (b.sg = {}); b.sg[d] = c }; t.J = function (b, c) { It.n.J.call(this, b, c) }; t.Ak = function (b, c, d) { b.bk |= 2; b.bk |= 64; (this.Rh() || !this.cK) && lp(b, 32, m); b.Wo(m); It.n.Ak.call(this, b, c, d); b.Aa && this.Aa && Jt(this, b); c <= this.Gb && this.Gb++ };
        t.removeChild = function (b, c) { if (b = oa(b) ? Nh(this, b) : b) { var d = dt(this, b); -1 != d && (d == this.Gb ? b.pd(m) : d < this.Gb && this.Gb--); (d = b.m()) && (d.id && this.sg) && F.remove(this.sg, d.id) } b = It.n.removeChild.call(this, b, c); b.Wo(j); return b }; t.Xo = function (b) { this.m() && f(Error("Component already rendered")); this.xb = b }; t.S = p("lb");
        t.F = function (b, c) { if (c || this.lb != b && this.dispatchEvent(b ? "show" : "hide")) { this.lb = b; var d = this.m(); if (d) { Q(d, b); if (this.Rh() && (d = this.kc())) d.tabIndex = this.ic && this.lb ? 0 : -1; c || this.dispatchEvent(this.lb ? "aftershow" : "afterhide") } return j } return m }; t.isEnabled = p("ic");
        t.$a = function (b) { if (this.ic != b && this.dispatchEvent(b ? "enable" : "disable")) if (b ? (this.ic = j, Ph(this, function (b) { b.CI ? delete b.CI : b.$a(j) })) : (Ph(this, function (b) { b.isEnabled() ? b.$a(m) : b.CI = j }), this.Uf = this.ic = m), this.Rh()) { var c = this.kc(); c && (c.tabIndex = b && this.lb ? 0 : -1) } }; t.Rh = p("ew"); t.Ne = function (b) { b != this.ew && this.Aa && Kt(this, b); this.ew = b; if (this.ic && this.lb) { var c = this.kc(); c && (c.tabIndex = b ? 0 : -1) } }; t.Qb = function (b) { (b = Rh(this, b)) ? b.pd(j) : -1 < this.Gb && Lt(this).pd(m) };
        t.pd = function (b) { this.Qb(dt(this, b)) }; a.Lt = function (b) { return Rh(b, b.Gb) }, a.Mt = function (b) { Nt(b, function (b, d) { return (b + 1) % d }, Qh(b) - 1) }, a.Pt = function (b) { Nt(b, function (b, d) { return (b + 1) % d }, b.Gb) }, a.Ot = function (b) { Nt(b, function (b, d) { b--; return 0 > b ? d - 1 : b }, b.Gb) }, a.Nt = function (b, c, d) { for (var d = 0 > d ? dt(b, b.oc) : d, e = Qh(b), d = c.call(b, d, e), g = 0; g <= e;) { var h = Rh(b, d); if (h && b.cC(h)) { b.Fz(d); break } g++; d = c.call(b, d, e) } }; t.cC = function (b) { return b.S() && b.isEnabled() && !!(b.Rb & 2) }; t.Fz = function (b) { this.Qb(b) };
        a.Qt = function (b, c) { st.call(this, b, c) }; y(Qt, st); Qt.prototype.ao = 0; Qt.prototype.km = ca("ao"); Qt.prototype.ma = function (b, c, d, e) { var g = ag(b), g = fg(g), h; h = Tb(b); h = $b(h.Ha); h = new Nb(this.zh.x + h.scrollLeft, this.zh.y + h.scrollTop); var l = c, n = Im(h, b, l, d, g, 10, e); if (0 != (n & 496)) { if (n & 16 || n & 32) l ^= 2; if (n & 64 || n & 128) l ^= 1; n = Im(h, b, l, d, g, 10, e); 0 != (n & 496) && Im(h, b, c, d, g, this.ao, e) } }; a.Rt = function (b, c, d, e) { Xn.call(this, b, c); this.ao = d ? 5 : 0; this.Qy = e || i }; y(Rt, Xn); Rt.prototype.yn = p("ao"); Rt.prototype.km = ca("ao");
        Rt.prototype.ma = function (b, c, d, e) { var g = Jm(this.element, this.Df, b, c, k, d, 10, e, this.Qy); if (g & 496) { var h = St(g, this.Df), c = St(g, c), g = Jm(this.element, h, b, c, k, d, 10, e, this.Qy); g & 496 && (h = St(g, h), c = St(g, c), Jm(this.element, h, b, c, k, d, this.yn(), e, this.Qy)) } };
        a.St = function (b, c) { b & 48 && (c ^= 2); b & 192 && (c ^= 1); return c }, a.Tt = {}, a.Ut = {}, a.Vt = function (b) { if (b) { var c = b.getBoundingClientRect(), d = c.bottom, c = c.top; d < Zb().height && 0 > c && setTimeout(function () { var c = b.getBoundingClientRect().bottom, g = pt(document); window.scrollTo(g.x, g.y + c - d) }) } }, a.Wt = function (b) {
            function c(b) { return $.isNumeric(b) ? b + " " : b } var d; d = d || +new Date; if (0 >= d - b) return "刚刚"; b = Math.floor((d - b) / 1E3); d = Math.floor(b / 31536E3); if (1 <= d) return c(d) + "年前"; d = Math.floor(b / 2592E3); if (1 <= d) return c(d) + "月前"; d =
            Math.floor(b / 604800); if (1 <= d) return c(d) + "周前"; d = Math.floor(b / 86400); if (1 <= d) return c(d) + "天前"; d = Math.floor(b / 3600); if (1 <= d) return c(d) + "小时前"; d = Math.floor(b / 60); if (1 <= d) return c(d) + "分钟前"; d = Math.floor(b); return c(d) + "秒前"
        }, a.Xt = function () { var b = S; return 1 === b || 0 === b ? "匿名用户" : ['<a data-tip="p$t$', b[1], '" href="/people/', b[1], '" title="' + b[0] + '" class="', 'zm-item-link-avatar">', '<img class="zm-item-img-avatar" src="' + b[2] + '" />', "</a>"].join("") }, a.Yt = function (b, c) {
            return !ma(b) ? "匿名用户" : ['<a data-tip="p$t$',
            b[1], '" href="/people/', b[1], '"', c ? ' class="' + c + '"' : "", ' title="', b[0], '">', b[0], "</a>"].join("")
        }, a.Zt = function (b) { if (0 === b || 1 === b) return "匿名用户"; var c = K("a", { href: "/people/" + b[1], title: b[0] }, b[0]); c.setAttribute("data-tip", "p$t$" + b[1]); return c }, a.$t = function (b) { if (0 === b || 1 === b) return K("span"); if (ma(b)) { var c = K("a", { href: "/people/" + b[1], title: b[0], "class": "zm-item-link-avatar" }, K("img", { src: b[2], "class": "zm-list-avatar" })); c.setAttribute("data-tip", "p$t$" + b[1]); return c } }, a.au = function (b) {
            return 1 ===
            b ? j : ma(b) ? b[3] === S[3] : m
        }, a.bu = function (b, c, d, e, g, h) { h && (e && (e = $.proxy(e, h)), g && (g = $.proxy(g, h))); $.post("/node/" + b, { method: c, params: d }, function (b) { b && b.r ? g && g(b) : e && e(b) }) }, a.cu = function (b, c) { return $.post("/question/askpeople", { qid: b, uid: c, op: "remove" }) }, a.du = function (b, c, d) { return $.post("/question/askpeople", { qid: b, uid: c, _source_type: d, op: "add" }) }, a.eu = function (b, c) { return $.post("/node/AnswerVoteBarV2", { method: c, params: { answer_id: b } }) }, a.fu = function (b, c) {
            return $.get(c ? "/node/AnswerFullVoteInfoV2" :
            "/node/AnswerVoteInfoV2", { params: { answer_id: b } })
        }, a.gu = function (b) {
            var c = {}, b = String(b), d = "#" == b.charAt(0) ? b : "#" + b; if (lt.test(d)) return c.Er = wt(d), c.type = "hex", c; d = vt(b); if (d.length) { var e = d[0], b = d[1], d = d[2], e = Number(e), b = Number(b), d = Number(d); (isNaN(e) || 0 > e || 255 < e || isNaN(b) || 0 > b || 255 < b || isNaN(d) || 0 > d || 255 < d) && f(Error('"(' + e + "," + b + "," + d + '") is not a valid RGB color')); e = kt(e.toString(16)); b = kt(b.toString(16)); d = kt(d.toString(16)); c.Er = "#" + e + b + d; c.type = "rgb"; return c } if (xt && (d = xt[b.toLowerCase()])) return c.Er =
            d, c.type = "named", c; f(Error(b + " is not a valid color string"))
        }, a.hu = function (b) { if (b.altKey && !b.ctrlKey || b.metaKey || 112 <= b.keyCode && 123 >= b.keyCode) return m; switch (b.keyCode) { case 18: case 20: case 93: case 17: case 40: case 35: case 27: case 36: case 45: case 37: case 224: case 91: case 144: case 12: case 34: case 33: case 19: case 255: case 44: case 39: case 145: case 16: case 38: case 224: case 92: return m; case 0: return !B; default: return 166 > b.keyCode || 183 < b.keyCode } }, a.iu = {}, a.ju = function (b) {
            var c = Sb(b), d = A && b.currentStyle;
            if (d && Lc(Tb(c)) && "auto" != d.width && "auto" != d.height && !d.boxSizing) return c = vg(b, d.width, "width", "pixelWidth"), b = vg(b, d.height, "height", "pixelHeight"), new Pb(c, b); d = ug(b); c = xg(b); b = gg(b); return new Pb(d.width - b.left - c.left - c.right - b.right, d.height - b.top - c.top - c.bottom - b.bottom)
        }, a.ku = function (b, c) {
            var d = Tb(c), e = k; if (A) d = e = d.Da().createStyleSheet(), A ? d.cssText = b : d.innerHTML = b; else {
                var g = Ub(d.Ha, "head", i, i)[0]; g || (e = Ub(d.Ha, "body", i, i)[0], g = d.w("head"), e.parentNode.insertBefore(g, e)); var h = e = d.w("style");
                A ? h.cssText = b : h.innerHTML = b; d.appendChild(g, e)
            }
        }, a.lu = function (b, c) { var d = b.style[eb(c)]; return "undefined" !== typeof d ? d : b.style[Uf(b, c)] || "" }, a.mu = function (b) { var c = arguments, d = c.length; return function () { for (var b, g = 0; g < d; g++) b = c[g].apply(this, arguments); return b } }, a.nu = function () { f(Error("unimplemented abstract method")) }, a.ou = function () { M.call(this) }; y(ou, yn);
        ou.prototype.B = function () { this.Pr = H("help-index"); (new ur).o(this.Pr); var b = window.location.href, c = ""; 0 < b.indexOf("#") && (c = b.substring(b.indexOf("#")), b = b.substring(0, b.indexOf("#"))); "/help" === b.substring(b.length - 5) && (b += "/faq"); var d = Vb("a", k, this.Pr); z.forEach(d, function (d) { (d.href === b || d.href === b + c) && Ic(d, function (b) { "UL" === b.tagName && E.add(b, "force-display"); "LI" === b.tagName && E.add(b, "current") }) }, this); this.h().e(this.Pr, "click", this.nN) };
        ou.prototype.nN = function (b) { if ((b = Kk(this.Pr, b.target)) && 0 < b.href.indexOf("#")) { var c = Jc(b, "ul", k), c = Vb("li", k, c); z.forEach(c, function (b) { E.remove(b, "current") }, this); E.add(b.parentNode, "current") } }; a.pu = function (b) { M.call(this); this.view = this.name = k; F.extend(this.options = {}, this.defaults, b || {}) }; y(pu, Hd); a.qu = {}, a.ru = function (b, c) { function d(c) { pu.call(this, c); this.name = b } y(d, pu); ya(d.prototype, c); qu[b] = d }; pu.prototype.defaults = {}; pu.prototype.h = function () { return this.Gg || (this.Gg = new ne(this)) }; pu.prototype.B = ba(); pu.prototype.z = function () { pu.n.z.call(this); this.view && (F.remove(this.view.nd, this.name), this.view = k); this.Gg && (this.Gg.H(), this.Gg = k) }; a.su = function (b) { T.call(this); F.extend(this.G = {}, this.defaults, b || {}); this.source = this.G.source; this.promise = $.Deferred().resolve(); this.nd = {} }; y(su, T); t = su.prototype; t.defaults = { source: k, pa: ["autoload", "shortcut"], bh: j, Tm: "zg-btn-white zu-button-more" }; t.pa = function (b, c) { var d, e = qu[b]; e || f(Error("Cannot find constructor")); d = new e(c); d.view = this; this.Aa ? d.B(this) : this.h().e(this, "initialized", function () { d.B(this) }); this.nd[b] = d; return this };
        t.Ii = function () { !this.Jd && this.G.bh && (this.Jd = this.tq(), lc(this.Jd, this.g), this.h().e(this.Jd, "click", this.Zx)) }; t.C = function () { su.n.C.call(this); this.Ii(); z.forEach(this.Mb(), this.Iq, this); z.forEach(this.G.pa, this.pa, this); this.dispatchEvent("initialized") }; t.z = function () { F.forEach(this.nd, function (b) { b.H() }); this.nd = k; su.n.z.call(this) }; a.tu = function (b, c, d) { b.Aa && z.forEach(b.Mb(), c, d); b.h().e(b, "itemcreated", function (b) { c.call(d, b.item) }) }; t.Mb = function () { return pc(this.g) };
        t.Iq = function (b, c) { this.Ij(b, c); this.dispatchEvent({ type: "itemcreated", item: b, index: c }) }; t.Ij = ha; a.uu = function (b) { b.Jd && (L(b.Jd), b.Jd = k); b.dispatchEvent("complete") }; t.EQ = function (b) { if (b) { var c = b.results, d = !c || !c.length; d || this.Y(c); this.dispatchEvent("next"); (d || b.next === m) && uu(this) } }; t.Y = function (b, c) { var b = $.isArray(b) ? b.join("") : b, d = gc(b + " "); z.forEach($.makeArray(pc(d)), this.Iq, this); mc(this.g, d, c) };
        t.Zx = function () { this.dispatchEvent("beforeloadnext") !== m && "pending" !== this.promise.state() && (this.Qz(j), this.promise = this.source().done(v(this.EQ, this)).always(v(xa(this.Qz, m), this))) }; t.hd = p("Jd"); t.tq = function () { return K("a", { "aria-role": "button", "class": this.G.Tm }, "更多") }; t.Qz = function (b) { this.Jd && (this.Jd.innerHTML = b ? '<i class="spinner-gray"></i> 加载中' : "更多", E.enable(this.Jd, "loading", b)) }; a.wu = function (b, c) { var d = Array.prototype.slice.call(arguments), e = d.shift(); "undefined" == typeof e && f(Error("[goog.string.format] Template required")); return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g, function (b, c, e, n, q, r, w, C) { if ("%" == r) return "%"; var I = d.shift(); "undefined" == typeof I && f(Error("[goog.string.format] Not enough arguments")); arguments[0] = I; return vu[r].apply(k, arguments) }) }, a.vu = {
            s: function (b, c, d) {
                return isNaN(d) || "" == d || b.length >= d ? b : b = -1 < c.indexOf("-", 0) ? b + Array(d - b.length +
                1).join(" ") : Array(d - b.length + 1).join(" ") + b
            }, f: function (b, c, d, e, g) { e = b.toString(); isNaN(g) || "" == g || (e = b.toFixed(g)); var h; h = 0 > b ? "-" : 0 <= c.indexOf("+") ? "+" : 0 <= c.indexOf(" ") ? " " : ""; 0 <= b && (e = h + e); if (isNaN(d) || e.length >= d) return e; e = isNaN(g) ? Math.abs(b).toString() : Math.abs(b).toFixed(g); b = d - e.length - h.length; 0 <= c.indexOf("-", 0) ? e = h + e + Array(b + 1).join(" ") : (c = 0 <= c.indexOf("0", 0) ? "0" : " ", e = h + Array(b + 1).join(c) + e); return e }, d: function (b, c, d, e, g, h, l, n) { return vu.f(parseInt(b, 10), c, d, e, 0, h, l, n) }
        }; vu.i = vu.d;
        vu.u = vu.d; ru("activeSource", {
            defaults: { JK: "%d 条新动态", Tm: "zu-main-feed-fresh-button", oZ: ha }, B: function (b) { this.data = []; this.button = this.tq(); kc(this.button, b.m()); this.h().e(this.button, "click", function () { b.Y(this.data, 0); this.setData([]) }); var c = this, d = this.options.source(function (b) { b && b.length && c.setData(b.concat(c.data)) }, function () { return c.data }); (!d || !qa(d.H)) && f(Error("Source must return a disposable object.")); this.SL = d }, setData: function (b) { this.data = b; this.mQ() }, mQ: function () {
                var b = this.data.length;
                yc(this.button, wu(this.options.JK, b)); Q(this.button, !!b)
            }, tq: function () { return K("a", { href: "javascript:;", style: "display:none", "class": this.options.Tm }) }, H: function () { pu.prototype.H.call(this); Uc(this.SL); this.options = k; this.button && (L(this.button), this.button = k) }
        }); a.xu = function () { M.call(this); this.size = k; this.pX = xg(document.body).top; this.fa = new ne(this); this.pp = k; this.KL = 250; this.Jg() }; y(xu, Hd); ia(xu); xu.prototype.Jg = function () { this.size = Zb(); var b = this.pp = new Qn(this.update, this.KL, this); this.fa.e(window, "scroll", b.fire, m, b).e(window, "resize", b.fire, m, b) }; xu.prototype.h = p("fa"); xu.prototype.z = function () { xu.n.z.call(this); this.fa.H(); this.fa = k; this.pp.H(); this.pp = k }; xu.prototype.update = function () { this.size = Zb(); this.dispatchEvent("update") };
        a.zu = function (b, c, d) { var e = yu; e.fa.e(e, "update", function h() { b.getBoundingClientRect().bottom < this.size.height && (c.call(d), this.fa.Fa(this, "update", h)) }) }, a.yu = xu.T(); $(function () { yu.update() }); ru("autoload", {
            defaults: { ES: function (b) { return 0 !== b % 3 } }, B: function (b) {
                if (b.hd() && S.wa()) {
                    var c = this, d = yu; c.h().e(d, "update", function (d) { var e; e = ua(c); var l = td[e]; if (l) { var n = la("abouttosee"), q = la(i); n && q ? (l = sd.abouttosee, e = !!l && !!l[i] && e in l[i]) : e = !n && !q ? j : z.some(l, function (b) { return n && "abouttosee" == b.type || q && b.capture == i }) } else e = m; e && (rg(b.hd()) && 400 >= b.hd().getBoundingClientRect().top - d.target.size.height) && c.dispatchEvent("abouttosee") }); var e = 0; this.h().e(b, "complete", this.H).e(b, "next",
                    function () { e += 1; this.options.ES(e) && this.enable() }); this.enable()
                }
            }, enable: function () { P(this.h(), this, "abouttosee", function () { this.view.Zx() }) }
        }); ru("childConstructor", { defaults: { Li: k, factory: k }, B: function (b) { qa(this.options.Li) && tu(b, this.oL, this); qa(this.options.factory) && tu(b, this.TR, this) }, oL: function (b) { var c = new this.options.Li; this.view.J(c); c.o(b) }, TR: function (b) { var c = this.options.factory(b); this.view.J(c); c.o(b) } }); ru("dataPagingSource", { defaults: { Yu: j }, B: function (b) { var c = $(b.m()).data("paging").next; c || uu(b); b.source = function () { return $.get(c).then(function (b) { c = b.paging.next; return { results: b.htmls, next: !!c } }) } } }); a.Au = function (b) { F.extend(this.G = {}, this.defaults, b || {}); this.content = ""; this.Ec = this.Re = this.ie = k; this.xd = m; this.valid = j }; y(Au, T); t = Au.prototype; t.defaults = { LT: "textarea.content", aC: ".toggle-expand", DT: ".summary", tC: "zm-editable-content", kr: m };
        t.C = function () { Au.n.C.call(this); var b = this.g, c = this.G; c.kr ? (this.ie = $("." + c.tC, b), this.content = this.ie.val(), this.Ec = $(c.aC, b)) : (this.content = $(c.LT, b).remove().val(), this.ie = $(c.DT, b), this.Ec = $(c.aC, this.ie)); if (this.ie.length) { if (this.Ec.length) this.Ec.click(m).on("click", $.proxy(this.expand, this)); this.ie.on("click", $.proxy(this.PN, this)) } else this.valid = m, this.expand = this.collapse = ha, this.dispatchEvent("invalid") }; t.hd = function () { return this.Ec.get(0) }; t.eb = p("content");
        t.Ka = function (b) { b ? this.expand() : this.collapse() }; t.PN = function (b) { var c = Rq(); if (!c || !c.Lc()) c = $(b.target).closest("a").get(0), c && "javascript:" !== c.protocol || (b.preventDefault(), b.stopPropagation(), this.expand()) }; t.expand = function () { !this.xd && this.dispatchEvent("beforeexpand") !== m && (this.xd = j, this.G.kr ? (this.ie.removeClass("fixed-summary"), this.Ec.remove()) : (this.Re ? this.Re.show() : this.ie.length && (this.Re = $("<div>", { html: this.content, "class": this.G.tC }).insertBefore(this.ie)), this.ie.hide()), this.dispatchEvent("expand")) };
        t.collapse = function () { this.xd && (this.xd = m, this.Re && this.Re.hide(), this.G.kr ? this.ie.addClass("fixed-summary") : this.ie.show()) }; ru("expandLimit", { defaults: { RT: 3 }, B: function (b) { var c = $i.create("ExpandLimit"); c.get("expandCount") || c.Oe("expandCount", "0"); S.wa() || (this.h().e(b, "beforeexpand", function (b) { var e = parseInt(c.get("expandCount"), 10) || 0; if (b.target instanceof Au && (b = e + 1, c.Oe("expandCount", b), b >= this.options.RT)) return new hn("expand"), m }), this.h().e(b, "beforeloadnext", function () { new hn("expand"); return m })) } }); ru("locationSource", { defaults: { ms: 20, param: k, Do: m, offset: function (b) { return b.length } }, B: function (b) { function c(b) { return { start: d.Do ? z.Je(b).id.split("-")[1] : 0, offset: d.offset(b) } } var d = this.options, e = d.url || location.href, g = b.Mb().length; (!g || g < d.ms) && uu(b); b.source = function () { return $.post(e, (d.param || c)(b.Mb())).then(function (c) { if (!c.r) { var c = c.msg, e = c[0]; pa(e) && e < d.ms && uu(b); return { results: c[1] } } }) } } }); ru("nodeSource", { defaults: { Yu: j }, B: function (b) { var c = $(b.m()).data("init"), d = "/node/" + c.nodename, e = c.params, g = e.offset || 0, c = e.limit, h = e.pagesize; this.options.Yu && (c && b.Mb().length < c) && uu(b); b.source = function () { return $.post(d, { method: "next", params: $.extend(e, { offset: g + b.Mb().length }) }).then(function (b) { var c = j; h && (!b.r && b.msg.length < h) && (c = m); return !b.r && { results: b.msg, next: c } }) } } }); ru("shortcut", { defaults: { items: ">div" }, B: function (b) { b.Mb().length && (this.qo = new On(this.options), this.qo.o(b.m()), this.h().e(this.qo, "action", function (c) { c.data.index >= c.data.size && b.hd() && rg(b.hd()) && b.hd().click() })) }, H: function () { pu.prototype.H.call(this); this.qo && (this.qo.H(), this.qo = k) } }); a.Bu = function (b) { su.call(this, b) }; y(Bu, su); a.Cu = function () { M.call(this) }; y(Cu, Hd); Cu.prototype.lB = { question: "问题", comment: "评论", answer: "回答", favlist: "收藏", member: "用户", message: "私信", image: "图片", video: "视频", post: "文章" }; Cu.prototype.nv = "report-dialog"; Cu.prototype.wF = "loading"; Cu.prototype.sM = '<form><div class="header"><% if (headnote) { %><span class="headnote"><%=headnote%></span><% } %>请选择理由</div><ul class="options clearfix"><% each(options, function(option) { %><li><label><input value="<%=option.value%>" name="reason" type="radio"><%=option.label%></label><% if (option.description) { %><div class="description visible-if-checked"><%=option.description%></div><% } %><% if (option.options) { %><ul class="group-options clearfix visible-if-checked"><% each(option.options, function(opt) { %><li><label><input required data-description="<%=opt.description%>" value="<%=opt.value%>" name="reason-<%=option.value%>" type="radio"><%=opt.label%></label></li><% }) %></ul><div class="group-description visible-if-checked"></div><% } %><% if (option.value == 0) { %><p class="input-container visible-if-checked"><input placeholder="请填写原因" type="text" name="detail" class="reason-text zg-form-text-input"></p><p class="error-container visible-if-checked"></p><% } %></li><% }) %></ul><p class="footnote"></p></form>';
        Cu.prototype.submit = nu; t = Cu.prototype; t.pw = p("ln"); t.Ru = function () { var b = new zi; ci(b, j); b.kn = j; ii(b, ki); b.addEventListener(ji, this.VM, m, this); Sc(b, this); return b }; t.VM = function (b) { if ("ok" === b.key) return (b = $("form", this.ln.m()).valid()) && this.submit(), b };
        t.open = function (b, c, d) { var e = this.ln = this.Ru(); e.ab(this.JD(b)); e.Ja(this.Su()); e.F(j); E.add(e.m(), this.nv); E.add(e.m(), this.wF); this.PD(b).then(v(function (g) { e.Ja(Rk(this.sM, { each: z.forEach, options: g, headnote: d })); E.remove(e.m(), this.wF); e.ma(); e.$g(450); this.Ov = { type: b, id: c }; this.Ju(b, g) }, this)) }; t.cE = ba();
        t.Ju = function (b, c) {
            var d = this, e = $(this.ln.m()), g = $("form", e), h = $(".reason-text", e); e.on("change", ":radio", function (b) { b = $(b.target); e.find("li").removeClass("checked"); b.parentsUntil(g, "li").addClass("checked"); var n = this.value, q = z.find(c, function (b) { return n === String(b.value) }); d.cE(q); q = "0" === n; h.toggle(q); q && h.placeholder(); b.closest("li").find("ul, :text").length || g.valid() }); e.find("ul ul").on("change", ":radio", function (b) { $(b.delegateTarget).parent().find(".group-description").text($(this).data("description")) });
            g.validate({ rules: { reason: "required", detail: { rangelength: [2, 100], required: function () { return !!$("input[name=reason]:checked", e).length } } }, messages: { reason: "请选择理由", detail: "理由为 2-100 字" }, errorLabelContainer: $(".error-container", g) })
        }; t.Su = s('<div class="loading">理由加载中<i class="spinner-gray"></i></div>'); a.Du = function () { M.call(this) }; y(Du, Cu); Du.prototype.PD = v(Vj(function (b) { return $.getJSON(Ga("/report/%s/options", b)) }), fa); Du.prototype.JD = function (b) { return Ga("为什么举报这个%s？", this.lB[b] || "条目") }; Du.prototype.submit = function () { var b = this.pw(), c = $($("form", this.ln.m())[0]).serialize() + "&" + $.param(this.Ov); $.post("/report", c).done(function (c) { b.F(m); c.r ? U(c.msg) : U("您的举报我们已经收到，处理完成后会私信告知处理结果。", 2E3) }); Y.V({ type: "ga_click_report", data: { type: this.Ov.type } }) };
        a.Eu = mn(function (b, c, d) { Y.V({ type: "ga_click_report_box", data: { type: b } }); (new Du).open(b, c, d) }, j); a.Fu = function () { M.call(this); this.Ge = "zm-pm-item" }; y(Fu, yn); Fu.prototype.B = function () { var b = H("zh-create-pm"); b && this.h().e(b, "click", this.kQ); var b = H("zh-pm-item-wrap"), c = new Bu; c.pa("locationSource", { param: function (b) { return { start: b[b.length - 1].getAttribute("data-token") } } }); c.o(b); this.h().e(b, "click", this.ka); $(function () { $("#zh-change-pm-admin").change(function () { var b = $(this).find("option:selected").attr("data-token"); location.href = "self" === b ? "/admin_feedback" : "/admin_feedback/" + b }) }) };
        Fu.prototype.kQ = mn(function () { var b; this.Mn(); this.Pb.show(); To(this.Pb, -1); (b = Xa(location.pathname, "admin_inbox") ? "admin" : $("#zh-change-pm-admin option:selected").attr("data-token")) && this.Pb.st(b) }, j); Fu.prototype.Mn = function () { this.Pb || (this.Pb = new Po({ at: j })) };
        Fu.prototype.ka = function (b) {
            if (b = Kk(this.UY, b.target)) {
                var c = b.name, d = Jc(b, k, this.Ge); if (!d || !b.name) return j; var e = $(d).data(), g = e.member, h = e.name; switch (c) {
                    case "reply": mn(v(function () { this.Mn(); this.Pb.show(); var b = this.Pb, c = e.type; b.mp = e.token; b.pA = c; To(this.Pb, g, h, m); this.Pb.$b.focus() }, this), j)(); break; case "report": Eu("message", e.reportToken, "被举报私信将会被管理员查阅"); break; case "delete": var l = d.getAttribute("data-token"); Di("删除私信会话", "你确定要删除与 " + h + "的所有会话吗？", function (b) {
                        if (b) {
                            var c = new V(j); c.on("success",
                            function () { var b = Ie(c); b.r ? U(b.msg) : window.location.reload() }); c.ajax("/inbox/delete", "type=thread&token=" + l)
                        }
                    }, this); break; case "edit": b = this.jg, Q(this.Oc, j), Q(b, m), this.ni = -1
                }
            }
        }; a.Gu = function () { M.call(this); this.Ge = "zm-pm-item" }; y(Gu, yn);
        Gu.prototype.B = function () {
            this.ps = H("zh-pm-detail-item-wrap"); this.h().e(this.ps, "click", this.ka); var b = H("zh-pm-editor-form"); if (b) { this.Pb = new Po({ at: j }); this.Pb.Bp = m; this.Pb.Xg(b); this.Pb.show(); if (b = this.Mb()[0]) { var b = $(b).data(), c = this.Pb, d = b.type; c.mp = b.token; c.pA = d; To(this.Pb, b.member, b.name) } else b = ih, To(this.Pb, b.id, b.kw); this.Pb.focus() } else this.Pb = new Po({ at: j }); this.Mb().length && (b = new Bu, b.pa("locationSource", { param: function (b) { return { start: b[b.length - 1].getAttribute("data-token") } } }),
            b.o(this.ps))
        }; Gu.prototype.Mb = function () { return pc(this.ps) };
        Gu.prototype.ka = function (b) { var c = Kk(this.ps, b.target); if (c && (b = c.name, c = Jc(c, k, this.Ge))) { var c = $(c).data(), d = c.token; switch (b) { case "reply": this.Pb.show(); var b = this.Pb, e = c.type; b.mp = d; b.pA = e; To(this.Pb, c.member, c.name, m); this.Pb.focus(); break; case "delete": Di("删除私信", "你确定要删除这封私信吗？", function (b) { if (b) { var c = new V(j); P(this.h(), c, "success", function () { var b = Ie(c); b.r ? U(b.msg) : window.location.reload() }); c.ajax("/inbox/delete", "type=single&token=" + d) } }, this); break; case "report": Eu("message", d, "被举报私信将会被管理员查阅") } } }; a.Hu = function () { }; y(Hu, $o); ia(Hu); Hu.prototype.M = s("goog-menuheader"); a.Iu = function (b, c, d) { ip.call(this, b, d || Hu.T(), c); lp(this, 1, m); lp(this, 2, m); lp(this, 4, m); lp(this, 32, m); this.aa = 1 }; y(Iu, ip); gp("goog-menuheader", function () { return new Iu(k) }); a.Ju = function () { this.$u = [] }; y(Ju, $o); ia(Ju); a.Ku = function (b, c) { var d = b.$u[c]; if (!d) { switch (c) { case 0: d = b.M() + "-highlight"; break; case 1: d = b.M() + "-checkbox"; break; case 2: d = b.M() + "-content" } b.$u[c] = d } return d }; t = Ju.prototype; t.xc = function () { return Wc.cJ }; t.w = function (b) { var c = b.L().w("div", this.df(b).join(" "), Lu(this, b.eb(), b.L())); Mu(this, b, c, !!(b.Rb & 8) || !!(b.Rb & 16)); bp(this, b, c); return c }; t.Z = function (b) { return b && b.firstChild };
        t.o = function (b, c) { var d = rc(c), e = Ku(this, 2); d && E.has(d, e) || c.appendChild(Lu(this, c.childNodes, b.L())); E.has(c, "goog-option") && (b.To(j), this.To(b, c, j)); return Ju.n.o.call(this, b, c) }; t.Ja = function (b, c) { var d = this.Z(b), e = Nu(this, b) ? d.firstChild : k; Ju.n.Ja.call(this, b, c); e && !Nu(this, b) && d.insertBefore(e, d.firstChild || k) }; a.Lu = function (b, c, d) { b = Ku(b, 2); return d.w("div", b, c) }; t.li = function (b, c, d) { c && (Nc(c, d ? Wc.eJ : this.xc()), Mu(this, b, c, d)) }; t.To = function (b, c, d) { c && (Nc(c, d ? Wc.dJ : this.xc()), Mu(this, b, c, d)) };
        a.Nu = function (b, c) { var d = b.Z(c); if (d) { var d = d.firstChild, e = Ku(b, 1); return !!d && E.has(d, e) } return m }, a.Mu = function (b, c, d, e) { e != Nu(b, d) && (E.enable(d, "goog-option", e), d = b.Z(d), e ? (b = Ku(b, 1), d.insertBefore(c.L().w("div", b), d.firstChild || k)) : d.removeChild(d.firstChild)) }; t.wn = function (b) { switch (b) { case 2: return Ku(this, 0); case 16: case 8: return "goog-option-selected"; default: return Ju.n.wn.call(this, b) } };
        t.Aw = function (b) { var c = Ku(this, 0); switch (b) { case "goog-option-selected": return 16; case c: return 2; default: return Ju.n.Aw.call(this, b) } }; t.M = s("goog-menuitem"); a.Ou = function (b, c, d, e) { ip.call(this, b, e || Ju.T(), d); this.Ba(c) }; y(Ou, ip); t = Ou.prototype; t.X = function () { var b = this.ny; return b != k ? b : this.Cg() }; t.Ba = ca("ny"); t.li = function (b) { lp(this, 8, b); this.Ee() && !b && this.$c(m); var c = this.m(); c && this.N.li(this, c, b) }; t.To = function (b) { lp(this, 16, b); var c = this.m(); c && this.N.To(this, c, b) };
        t.Cg = function () { var b = this.eb(); return ma(b) ? (b = z.map(b, function (b) { var d = E.get(b); return z.contains(d, "goog-menuitem-accel") || z.contains(d, "goog-menuitem-mnemonic-separator") ? "" : Hc(b) }).join(""), Ka(b)) : Ou.n.Cg.call(this) }; t.Pf = function (b) { var c = this.getParent(); if (c) { var d = c.yG; c.yG = k; if (c = d && pa(b.clientX)) c = new Nb(b.clientX, b.clientY), c = d == c ? j : !d || !c ? m : d.x == c.x && d.y == c.y; if (c) return } Ou.n.Pf.call(this, b) }; t.ff = function (b) { return b.keyCode == this.ly && this.$d(b) ? j : Ou.n.ff.call(this, b) }; t.CM = p("ly");
        gp("goog-menuitem", function () { return new Ou(k) }); a.Pu = function () { }; y(Pu, Gp); ia(Pu); t = Pu.prototype; t.xc = function () { return Wc.bJ }; t.vc = function (b) { return "UL" == b.tagName || Pu.n.vc.call(this, b) }; t.xn = function (b) { return "HR" == b.tagName ? new Fp : Pu.n.xn.call(this, b) }; t.Cf = function (b, c) { return tc(b.m(), c) }; t.M = s("goog-menu"); t.De = function (b) { Pu.n.De.call(this, b); Oc(b.m(), Vc.xk, "true") }; a.Qu = function (b) { Fp.call(this, Ep.T(), b) }; y(Qu, Fp); gp("goog-menuseparator", function () { return new Fp }); a.Ru = function (b, c) { It.call(this, Jp, c || Pu.T(), b); this.Ne(m) }; y(Ru, It); t = Ru.prototype; t.Fm = j; t.dK = m; t.M = function () { return this.N.M() }; t.Cf = function (b) { if (this.N.Cf(this, b)) return j; for (var c = 0, d = Qh(this) ; c < d; c++) { var e = Rh(this, c); if ("function" == typeof e.Cf && e.Cf(b)) return j } return m }; t.Ga = function (b) { this.J(b, j) }; t.zi = function (b, c) { this.Ak(b, c, j) }; t.removeItem = function (b) { (b = this.removeChild(b, j)) && b.H() }; t.Mh = function (b) { return Rh(this, b) }; t.ml = function () { return Qh(this) };
        t.Mb = function () { var b = []; Ph(this, function (c) { b.push(c) }); return b }; t.ad = function (b, c) { var d = this.S(); d || Q(this.m(), j); lg(this.m(), b, c); d || Q(this.m(), m) }; t.F = function (b, c, d) { (c = Ru.n.F.call(this, b, c)) && (b && this.Aa && this.Fm) && this.kc().focus(); this.yG = b && d && pa(d.clientX) ? new Nb(d.clientX, d.clientY) : k; return c }; t.Mw = function (b) { this.Fm && this.kc().focus(); return Ru.n.Mw.call(this, b) }; t.cC = function (b) { return (this.dK || b.isEnabled()) && b.S() && !!(b.Rb & 2) };
        t.ea = function (b) { var c = this.N, d; d = this.L(); d = Ub(d.Ha, "div", c.M() + "-content", b); for (var e = d.length, g = 0; g < e; g++) Hp(c, this, d[g]); Ru.n.ea.call(this, b) }; t.ff = function (b) { var c = Ru.n.ff.call(this, b); c || Ph(this, function (d) { !c && (d.CM && d.ly == b.keyCode) && (this.isEnabled() && this.pd(d), c = d.Zb(b)) }, this); return c }; t.Qb = function (b) { Ru.n.Qb.call(this, b); (b = Rh(this, b)) && hg(b.m(), this.m()) }; a.Su = function (b, c, d) { T.call(this); this.offset = this.dh = 0; this.bT = d; this.YL = b; this.url = c || window.location.href; this.Mg = "zm-item"; this.params = {} }; y(Su, T); t = Su.prototype; t.IA = !sb; t.HA = !sb; t.Yg = ca("Mg"); t.B = function () { this.bc = H("zh-load-more"); this.o(this.YL) };
        t.C = function () { Su.n.C.call(this); this.Im = 1; Tu(this); this.vk = $(this.bc); this.bc && Uu(this) && (this.h().e(this.bc, "click", function () { this.Un = j; this.oh && "pending" === this.oh.state() && 1 === this.Im ? (this.oh.done(v(this.mf, this)), this.Oz = j, Vu(this, j)) : this.Gy() }), this.IA && (this.qA = new Qn(this.Dy, 100, this), this.h().e(window, "scroll", function () { this.qA.fire() }))); Wu(this, this.Mb()) }; a.Vu = function (b, c) { c ? b.vk.html('<i class="spinner-gray"></i>正在加载').prop("disabled", j) : b.vk.html("更多").prop("disabled", m) };
        t.Dy = function () { var b = this.bc; if (b && rg(b) && 1E3 >= b.getBoundingClientRect().top - Zb().height && !(this.Rs || this.oh && "pending" === this.oh.state())) this.HA && (3 === this.Im ? (this.Im = 1, this.Oz = m) : (this.Un = m, this.Im++, this.Oz = j)), Xu(this) }; t.Gy = function () { this.IA && this.Rs ? (this.mf(this.Rs), this.Rs = k) : (Vu(this, j), Xu(this)) };
        a.Uu = function (b) { var c = b.Mb(); b.offset = b.Es ? b.Es(c) : c.length; if (b.Cr) return c = b.Cr(), Q(b.bc, c), c; if (b.bc) { if ("-1" === b.vk.attr("data-next") || !c || 10 > c.length) return b.vk.hide(), m; b.vk.removeClass("hidden").show() } return j }, a.Xu = function (b, c, d, e) {
            d = d || ha; if (!(b.oh && "pending" === b.oh.state())) {
                var g = b.OG($.extend(b.params, { offset: b.offset, start: b.dh })); b.oh = $.post(b.url, g).done(d).done($.proxy(function (b) { if (e) return e.call(this, b); this.IA && !c ? this.Oz ? this.mf(b) : (this.Rs = b, Vu(this, m)) : this.mf(b) }, b));
                1 !== b.Im && Vu(b, j); return b.oh
            }
        }; t.OG = aa(); t.mf = function (b) { if (b && !b.r) { var c = b.msg, d = c[0], e = c[1], g; 2 < c.length && (g = c[2], this.bc.setAttribute("data-next", g)); 0 < d && (this.hq(e), this.offset = this.Es ? this.Es(this.Mb()) : this.offset + d); c = j; c = this.Cr ? this.Cr(b) : !(-1 === g || 10 > d); Q(this.bc, c); Vu(this, m); Yu(this) } }; a.Yu = function (b) { b.dispatchEvent({ data: { Un: b.Un, HA: b.HA }, type: "afterload" }) }; t.Mb = function () { return Wb(this.Mg, this.g) }; t.HG = function (b) { return b.id.split("-")[1] };
        a.Tu = function (b) { var c = b.Mb(), d; if (b.bT) if (b.bc && (d = b.bc.getAttribute("data-next")), d) b.dh = d; else if (c = z.Je(c)) b.dh = b.HG(c) }; t.hq = function (b, c) { var d = ma(b) ? b.join("") : b, d = gc(d + " "), e = Wb(this.Mg, d); Wu(this, e); "prepend" === c ? kc(d, this.g.firstChild) : this.g.appendChild(d); Tu(this) }; a.Wu = function (b, c) { z.forEach(c, function (b) { var c = this.Ij(b); this.dispatchEvent({ data: { item: b, kP: c }, type: "itemcreated" }) }, b) }; t.Ij = ha; a.Zu = function (b, c) { return $.post("/node/ColumnPostVoteBarV2", { method: c, params: { post_id: b } }) }, a.$u = function (b, c) { return $.get(c ? "/node/ColumnPostFullVoteInfoV2" : "/node/ColumnPostVoteInfoV2", { params: { post_id: b } }) }; a.av = function (b, c, d) { T.call(this); this.vb = b; this.entryType = c || "answer"; this.wd = k; this.G = $.extend({}, this.defaults, d || {}) }; y(av, T); a.bv = { je: 1, og: -1, dB: 0 }; av.prototype.defaults = { mU: "up", TL: "down", qL: "count", Ss: "pressed" }; F.extend(av.prototype, bv); t = av.prototype; t.aa = bv.dB;
        t.o = function (b) { av.n.o.call(this, b); var c = this.G, b = this.K = $(b); this.hu = $("." + c.mU, b); this.du = $("." + c.TL, b); this.QA = $("." + c.qL, b); c = this.hu.hasClass(this.G.Ss); b = this.du.hasClass(this.G.Ss); c ? this.aa = bv.je : b && (this.aa = bv.og); cv(this); this.hu.click($.proxy(this.Qt, this)); this.du.click($.proxy(this.Pt, this)); return this }; t.Ud = p("aa");
        t.cc = mn(function (b) { if (b !== this.aa && F.ug(bv, b)) { this.dispatchEvent({ type: "action", data: { state: b } }); this.wd && "pending" === this.wd.state() && this.wd.abort(); var c = this.aa, d = +this.QA.text(), e = 0; b === bv.je ? e = 1 : c === bv.je && (e = -1); this.QA.text(d + e); this.aa = b; cv(this); b = {}; b[bv.je] = "vote_up"; b[bv.og] = "vote_down"; b[bv.dB] = "vote_neutral"; this.wd = ("post" === this.entryType ? Zu : eu)(this.vb, b[this.aa]); this.wd.done(v(function (b) { b.r || this.Zh() }, this)) } }, function (b) {
            var c = {}; c[bv.je] = "question_answer_vote_up"; c[bv.og] =
            "question_answer_vote_down"; return { wa: c[b], qg: j }
        }); t.fU = function (b) { b === bv.je ? Ok("vote", "voteup", "side_vote") : b === bv.og && Ok("vote", "votedown", "side_vote") }; t.Qt = function () { this.cc(this.aa === bv.og ? bv.je : this.aa ^ bv.je) }; t.Pt = function () { this.cc(this.aa === bv.je ? bv.og : this.aa ^ bv.og) };
        a.cv = function (b) { var c = b.aa, d = b.G, e = c === bv.je, c = c === bv.og, g = e ? "取消赞同" : "赞同", h = c ? "取消反对" : "反对，不会显示你的姓名"; b.hu.toggleClass(d.Ss, e).find(".label").text(g).end().attr("aria-pressed", e).attr("title", g); b.du.toggleClass(d.Ss, c).find(".label").text(h).end().attr("aria-pressed", c).attr("title", h) }; t.Zh = function () { this.dispatchEvent("change") }; a.dv = function (b) { M.call(this); this.g = b; b = A || D && !Eb("531") && "TEXTAREA" == b.tagName; this.P = new ne(this); this.P.e(this.g, b ? ["keydown", "paste", "cut", "drop", "input"] : "input", this) }; y(dv, Hd); dv.prototype.oa = k;
        dv.prototype.handleEvent = function (b) { if ("input" == b.type) ev(this), (!rb || this.g == Sb(this.g).activeElement) && this.dispatchEvent(fv(b)); else if ("keydown" != b.type || hu(b)) { var c = "keydown" == b.type ? this.g.value : k; A && 229 == b.keyCode && (c = k); var d = fv(b); ev(this); this.oa = Ld(function () { this.oa = k; this.g.value != c && this.dispatchEvent(d) }, 0, this) } }; a.ev = function (b) { b.oa != k && (Id.clearTimeout(b.oa), b.oa = k) }, a.fv = function (b) { b = new ld(b.Yb); b.type = "input"; return b };
        dv.prototype.z = function () { dv.n.z.call(this); this.P.H(); ev(this); delete this.g }; a.hv = function (b, c, d, e) { M.call(this); this.Nd = b; this.Dh = c; this.Sg = d; this.$C = e || gv; this.qj = new dv(b); N(this.qj, "input", this.uo, m, this); this.Gi() }; y(hv, Hd); a.gv = 0; t = hv.prototype; t.uo = function () { this.Gi() }; t.Gi = function () { var b = this.pr(); this.Dh && (0 > this.Sg - b ? (yc(this.Dh, "已超出 " + (b - this.Sg) + " 字"), E.add(this.Dh, "zg-text-error")) : (yc(this.Dh, "还可以输入 " + (this.Sg - b) + " 字"), E.remove(this.Dh, "zg-text-error"))) }; t.z = function () { hv.n.z.call(this); delete this.Nd; this.qj.H(); this.qj = k };
        t.isValid = function () { return 0 <= this.Sg - this.Nd.value.length }; t.pr = function () { return this.Nd.value.length }; a.iv = function (b, c, d, e) { hv.call(this, b, c, d, e) }; y(iv, hv); iv.prototype.pr = function () { return Mk(this.Nd.value) }; a.jv = function (b, c) { M.call(this); this.U = k; this.HL = c; this.VS.apply(this, b); this.B() }; y(jv, yn); jv.prototype.vg = {}; a.kv = Vj(function () { return $.get("/node/WebShareDialogV2") }); t = jv.prototype; t.B = function () { this.h().e(Mi, "question_title_change", function () { this.vg[this.mh] = k }); kv().then(v(function (b) { b = gc(La(b)); this.w(b); this.Ra(); this.show(); lv(this, this.HL) }, this)) }; t.show = function () { mv(this); this.Bc && (this.Bc.checked = m, this.Jj()); Dp.T().refresh(); this.U.F(j) }; t.hide = function () { this.U.F(m) };
        t.VS = function (b, c, d, e) { this.ah = { title: b, type: c, $T: d, params: e }; this.mh = c.type + ":" + d }; a.mv = function (b) { b.U.ab(b.ah.title); b.vg[b.mh] || (b.xhr = new V(j), P(b.h(), b.xhr, "success", b.WS), b.xhr.ajax("/" + b.ah.type + "/" + b.ah.$T + "/sharetext", "", "GET")); H("zh-webshare-sina-pm").value = b.vg[b.mh] && b.vg[b.mh].sina || "加载中..."; b.KH.Gi(); Go(b.Yz); b.Yz.Tt(); var c = b.qk; c.$b.value = b.vg[b.mh] && b.vg[b.mh].pm || "加载中..."; c.OK && c.OK.Gi(); Go(c.KG); c.KG.Tt(); Q(c.Oc, j); Q(c.jg, m) };
        t.WS = function () { var b = Ie(this.xhr); b && b.r ? U(b.msg) : (this.vg[this.mh] = b, mv(this)) }; t.w = function (b) { this.g = b; this.U = new zi(k, m); ii(this.U, k); this.U.kn = j; this.U.Z().appendChild(this.g); this.qk = new Po({ JG: "share" }); this.qk.ob = this.U; this.qk.Xg(H("tb-webshare-letter-content")); this.qk.Lk = m; this.qk.B() }; t.Iz = function () { this.Bc.checked = j; this.Jj() };
        a.lv = function (b, c) { var d = H(c + "-content"), e = H(c); z.forEach(b.GT, function (b) { E.remove(b.parentNode, "active") }); z.forEach(b.FT, function (b) { Q(b, m) }); E.add(e.parentNode, "active"); Q(d, j); b.sS || (b.U.ma(), b.sS = j) };
        t.Ra = function () {
            var b = J("tab-navs", this.g); this.h().e(b, "click", this.aR); this.GT = $(".tab-nav > a", this.g); this.FT = Wb("zm-tab-content", this.g); this.nC = Wb("zm-command", this.g); this.h().e(this.nC[0], "click", this.ka); this.h().e(this.nC[1], "click", this.ka); this.Xy = H("zh-webshare-sina-pm"); this.Yz = new Io(this.Xy); this.KH = new iv(this.Xy, H("zg-webshare-sina-counter"), 140, gv); this.h().e(Y, "sina_callback", function (b) { this.Iz(b.pc.id, b.pc.name) }); this.Iu(); b = J("zg-btn-blue", this.qk.m()); S.yi || E.SH(b, "zg-btn-blue",
            "zg-btn-disabled"); this.h().e(b, "click", this.ka)
        }; t.Iu = function () { this.Bc = J("sina-checkbox", this.g); this.h().e(this.Bc, "change", this.Jy) }; t.Jj = function () { var b = J("weibo-share-button", this.g), c = this.Bc.checked; E.enable(b, "zg-btn-blue", c); E.enable(b, "zg-btn-disabled", !c) }; t.Jy = function (b) { var b = b.target, c = b.getAttribute("data-bindurl"); b === this.Bc && !sh.id ? (window.open(c), b.checked = m, b = j) : b = i; b || this.Jj() }; t.aR = function (b) { (b = this.cf(b.target)) && lv(this, b.id) };
        t.ka = function (b) {
            var c = this.cf(b.target); if (c) switch (c.name) {
                case "send_sina": if (!E.has(c, "zg-btn-disabled")) { var d = this.Xy.value; d && this.mh in this.vg && (c = new Lk(j), c.add("content", d), d = [], this.Bc.checked && d.push("sina"), c.add("via", d.join(",")), this.Wl(c), this.ah && Y.V({ type: "ga_click_share_" + this.ah.type + "_weibo", data: { xI: d } })) } break; case "send": if (!E.has(c, "zg-btn-disabled")) if (c = this.qk, "-1" === String(c.ni)) Ro(c, "请填写收信人。"); else if (d = c.$b.value, this.mh in this.vg) if (La(d)) {
                    var e = new Lk(j); e.add("talker_id",
                    c.ni); e.add("content", d); e.add("via", "pm"); this.Wl(e); this.ah && Y.V("ga_click_share_" + this.ah.type + "_message")
                } else Ro(c, "请填写私信内容。"); break; case "cancel": this.hide()
            } b.stopPropagation(); b.preventDefault()
        }; t.Wl = function (b) { F.forEach(this.ah.params, function (c, d) { b.add(d, c) }); this.xhr = new V(j); P(this.h(), this.xhr, "complete", this.yu); this.xhr.ajax("/" + this.ah.type + "/share", b.Kc()) }; t.yu = function () { var b = Ie(this.xhr); b && b.r ? U(b.msg) : (this.U.F(m), U("分享发送完毕")) }; t.S = function () { return this.U.S() }; a.nv = void 0, a.ov = [], a.pv = [].slice, a.qv = Xk(550, function () { if (ov.length) { var b = ov; S.wa() && (b = { items: JSON.stringify(b) }, $.post("/lastread/touch", b)); ov = [] } }); nv = function () { ov.push(pv.call(arguments)); qv() }; a.rv = function (b) { var c = k; try { c = b.rules || b.cssRules } catch (d) { 15 == d.code && (d.styleSheet = b, f(d)) } return c }, a.sv = function (b) {
            var c = [], b = b || document.styleSheets, d = la(i) ? i : m; if (b.imports && b.imports.length) for (var e = 0, g = b.imports.length; e < g; e++) z.extend(c, sv(b.imports[e])); else if (b.length) { e = 0; for (g = b.length; e < g; e++) z.extend(c, sv(b[e])) } else { var h = rv(b); if (h && h.length) for (var e = 0, g = h.length, l; e < g; e++) l = h[e], l.styleSheet && z.extend(c, sv(l.styleSheet)) } (b.type || b.rules || b.cssRules) && (!b.disabled || d) && c.push(b);
            return c
        }; a.tv = /a(:(link|visited|active|hover))?/, a.uv = function () { this.jn = ""; this.Wg = [] }; uv.prototype.clone = function () { var b = new uv; b.Wg = this.Wg.concat(); b.jn = this.jn; return b };
        a.vv = function (b, c, d) { var e = [], g; for (g in c) { var h = c[g]; h && e.push(g, ":", h, d ? " !important" : "", ";") } b.jn = e.join("") }, a.wv = /(^|;|{)\s*color:([^;]+);/g, a.yv = function (b) { this.Vy = []; this.Du = {}; if (b) { for (var c = [], b = b.split(/\s+/gm), d = 0; d < b.length; d++) if (b[d]) { var e = new xv(b[d]); c.push(e) } this.ci = c } }, a.xv = function (b) {
            var c = zv[b]; if (c) return c; for (var c = b.match(/[#\.]/) ? b.split(/(?=[#\.])/) : [b], d = {}, e = 0; e < c.length; e++) {
                var g = c[e]; "." == g.charAt(0) ? d.className = g.substring(1, g.length) : "#" == g.charAt(0) ? d.id = g.substring(1,
                g.length) : d.tagName = g.toUpperCase()
            } this.NE = b; this.DP = d; this.UH = {}; zv[b] = this
        }, a.zv = {}, a.Av = function (b, c) { var d = c.uid, e = b.UH[d]; if ("undefined" != typeof e) return e; var g = b.DP, e = g.tagName, h = g.className, g = g.id, l = j; e && "*" != e && e != c.nodeName ? l = m : g && g != c.id ? l = m : h && !c.UK[h] && (l = m); return b.UH[d] = l }, a.Cv = function (b) {
            var c = ua(b), d = Bv[c]; if (d) return d; d = []; do { var e = { id: b.id, nodeName: b.nodeName }; e.uid = ua(e); var g = {}; if (b.className) for (var h = E.get(b), l = 0; l < h.length; l++) g[h[l]] = 1; e.UK = g; d.unshift(e) } while (b = b.parentNode);
            this.YF = d; this.uid = ua(this); Bv[c] = this
        }, a.Bv = {}, a.Dv = {}, a.Ev = "color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "), a.Fv = "font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" "); a.Gv = function () { M.call(this); this.ic = this.Xp() }; y(Gv, Hd); t = Gv.prototype; t.D = k; t.tK = j; t.Nb = me("goog.editor.Plugin"); t.mI = function () { this.D && (this.disable(this.D), this.D = k) }; t.enable = function (b) { this.D == b ? this.ic = j : this.Nb.log(ce, "Trying to enable an unregistered field with this plugin.", i) }; t.disable = function (b) { this.D == b ? this.ic = m : this.Nb.log(ce, "Trying to disable an unregistered field with this plugin.", i) }; t.isEnabled = function (b) { return this.D == b ? this.ic : m }; t.Xp = mf; t.eP = mf;
        t.z = function () { this.D && this.mI(this.D); Gv.n.z.call(this) }; a.Hv = F.um({ Tw: 1, rN: 2, wr: 3, ij: 4, xr: 5, execCommand: 6, queryCommandValue: 7, NG: 8, WK: 10, VK: 11 }), a.Iv = F.Ah(8, 10, 11); Gv.prototype.execCommand = function (b, c) { var d = this.eP(b); d || (B && Jv(this.D, j, j), this.D.Ch()); try { var e = this.af.apply(this, arguments) } finally { d || (this.D.Ze(), Kv(this.D)) } return e }; Gv.prototype.Fe = s(m); a.Lv = function (b, c, d, e, g) { this.rD = b; this.aA = c; this.oq = d; this.wD = e; this.Xv = g || {} }, a.Mv = function (b, c) { this.EU = b; this.AC = c }, a.Nv = function (b, c, d, e) {
            var g = []; b.oq && b.aA && g.push("<!DOCTYPE HTML>"); g.push('<html style="background:none transparent;min-width:0;'); b.oq && g.push("height:", b.wD ? "100%" : "auto"); g.push('">'); g.push("<head><style>"); d && d.AC && g.push(d.AC); B && b.aA && g.push(" img {-moz-force-broken-image-icon: 1;}"); g.push("</style></head>"); g.push('<body g_editable="true" hidefocus="true" '); Bt && g.push("contentEditable ");
            g.push('class="editable '); g.push('" id="', b.rD, '" style="min-width:0;'); B && b.oq && (g.push(";width:100%;border:0;margin:0;background:none transparent;", ";height:", b.aA ? "100%" : "auto"), b.wD ? g.push(";overflow:auto") : g.push(";overflow-y:hidden;overflow-x:auto")); rb && g.push(";outline:hidden"); for (var h in b.Xv) g.push(";" + h + ":" + b.Xv[h]); g.push('">', c, "</body></html>"); b = g.join(""); e = e.contentDocument || e.contentWindow.document; e.open(); e.write(b); e.close()
        }; a.Uv = function (b, c) { M.call(this); this.Hg = this.id = b; this.ib = k; this.nd = {}; this.oj = {}; for (var d in Hv) this.oj[d] = []; this.Ok = ""; this.fk = {}; this.fk[Ov] = 1; this.fk[Pv] = 1; this.Cx = this.bs = m; this.Qq = new yj(this.YC, Qv, this); this.Oq = {}; for (var e in Rv) this.Oq[Rv[e]] = 0; B && (this.oe = new yj(this.Cn, Sv, this)); this.jc = new ne(this); this.FU = []; this.Bj = Tv; this.Ql = Tb(c || document); this.Mc = this.Ql.m(this.id); this.Ek = this.Ql.Sa() }; y(Uv, Hd); Uv.prototype.field = k; Uv.prototype.Mc = k; Uv.prototype.Nb = me("goog.editor.Field");
        a.Ov = "change", a.Pv = "delayedchange", a.Rv = { bV: "cvc", SV: "load", cX: "unload", TU: "beforechange", $U: Ov, gV: Pv, UU: "beforefocus", pV: "focus", WU: "blur", VU: "beforetab", FV: "ifrsz", GW: "selectionchange" }, a.Tv = 0, a.Vv = k; t = Uv.prototype; t.Ig = m; t.sI = m; t.Xt = m; t.m = p("field"); t.addListener = function (b, c, d, e) { var g = this.m(); ar && (g && this.tc()) && (g = g.ownerDocument); this.jc.e(g, b, c, d, e) }; t.bj = function (b) { return this.nd[b] }; a.Sv = 15, a.Qv = 250; Uv.prototype.tc = nf; Uv.prototype.Vn = nf; Uv.prototype.FH = mf; a.Wv = { 46: j, 8: j }; A || (Wv[9] = j);
        a.Xv = { 86: j, 88: j }; A && (Wv[229] = j); a.Yv = function (b) { var c = !(b.ctrlKey || b.metaKey) && b.keyCode in Wv; return (b.ctrlKey || b.metaKey) && b.keyCode in Xv || c }, a.Zv = function (b, c) { b.Bj = 2; b.field = c; b.ib = Tb(c); b.bs = m; b.Cx = m; c.setAttribute("g_editable", "true") };
        Uv.prototype.cv = function () { this.jc && this.jc.removeAll(); if ((Mg || Ng) && this.tc() && this.FH()) { try { var b = this.ib.Sa(); b.removeEventListener("keydown", this.Qm, m); b.removeEventListener("touchend", this.Qm, m) } catch (c) { } delete this.Qm } if (rb && this.tc()) { try { b = this.ib.Sa(), b.removeEventListener("focus", this.Nu, m), b.removeEventListener("blur", this.Mu, m) } catch (d) { } delete this.Nu; delete this.Mu } this.oe && this.oe.stop(); this.Qq.stop() };
        Uv.prototype.z = function () { (1 == this.Bj || this.Wd()) && this.Nb.nk("Disposing a field that is in use."); this.Mc && this.execCommand("clearlorem"); this.Bj = Tv; for (var b in this.nd) { var c = this.nd[b]; c.Xp() || c.disable(this) } this.ib = this.field = k; this.cv(); this.dl && (Ad(this.dl), this.dl = k); this.Ql = k; this.jc && (this.jc.H(), this.jc = k); for (; b = this.FU.pop() ;) b.H(); Vv == this.id && (Vv = k); for (var d in this.nd) b = this.nd[d], b.tK && b.H(); delete this.nd; Uv.n.z.call(this) };
        a.$v = ["DOMNodeInserted", "DOMNodeRemoved", "DOMNodeRemovedFromDocument", "DOMNodeInsertedIntoDocument", "DOMCharacterDataModified"]; Uv.prototype.Lz = function () { if (Yq || !this.tc()) this.jc.e(this.m(), "DOMSubtreeModified", this.Uw); else { var b = this.ib.Da(); this.jc.e(b, $v, this.Uw, j); this.jc.e(b, "DOMAttrModified", v(this.UD, this, this.Uw), j) } };
        a.aw = function (b, c) { if (9 == c.keyCode && !b.dispatchEvent({ type: "beforetab", shiftKey: c.shiftKey, altKey: c.altKey, ctrlKey: c.ctrlKey }) || B && c.metaKey && (37 == c.keyCode || 39 == c.keyCode)) return c.preventDefault(), m; var d; if (!(d = c.charCode)) d = Yv(c) ? j : !(!B || c.ctrlKey || c.metaKey || B && !c.charCode); b.Dw = d; b.Dw && b.Ch(); return j }, a.bw = { 8: 1, 9: 1, 13: 1, 33: 1, 34: 1, 35: 1, 36: 1, 37: 1, 38: 1, 39: 1, 40: 1, 46: 1 }, a.cw = { 65: j, 86: j, 88: j }, a.dw = { 8: 1, 9: 1, 13: 1, 27: 1, 33: 1, 34: 1, 37: 1, 38: 1, 39: 1, 40: 1 }; t = Uv.prototype;
        t.Tn = function (b, c) { for (var d = this.oj[b], e = z.slice(arguments, 1), g = 0; g < d.length; ++g) { var h = d[g]; if ((h.isEnabled(this) || Iv[b]) && h[Hv[b]].apply(h, e)) return j } return m }; t.SO = function (b, c) { for (var d = this.oj[b], e = z.slice(arguments, 1), g = 0; g < d.length; ++g) { var h = d[g]; (h.isEnabled(this) || Iv[b]) && h[Hv[b]].apply(h, e) } }; t.Ys = function (b, c, d) { for (var e = this.oj[b], g = z.slice(arguments, 1), h = 0; h < e.length; ++h) { var l = e[h]; if (l.isEnabled(this) || Iv[b]) g[0] = l[Hv[b]].apply(l, g) } return g[0] };
        a.ew = function (b, c, d) { var e = {}, b = b.Ys(8, c || "", e); Tf(d, e); d.innerHTML = b }; t.ef = function (b) { (B || aw(this, b)) && !this.Tn(1, b) && hr && fw(this, b) }; t.sN = function (b) { if (B) { if (!aw(this, b)) return } else this.Dw = j, this.Ch(); !this.Tn(2, b) && !hr && fw(this, b) }; t.tN = function (b) { !B && (this.Dw || Yv(b)) && this.Cn(); this.Tn(3, b); gw(this, "selectionchange") || (bw[b.keyCode] || (b.ctrlKey || b.metaKey) && cw[b.keyCode]) && this.wH.start() };
        a.fw = function (b, c) { if (!c.altKey) { var d = kb ? c.metaKey : c.ctrlKey; if (d || dw[c.keyCode]) { var e = c.charCode || c.keyCode; 17 != e && b.Tn(5, c, String.fromCharCode(e).toLowerCase(), d) && c.preventDefault() } } }; t.execCommand = function (b, c) { for (var d = arguments, e, g = this.oj[6], h = 0; h < g.length; ++h) { var l = g[h]; if (l.isEnabled(this) && l.Fe(b)) { e = l.execCommand.apply(l, d); break } } return e };
        t.queryCommandValue = function (b) { var c = this.Wd() && this.jf; if (oa(b)) return this.Vs(b, c); for (var d = {}, e = 0; e < b.length; e++) d[b[e]] = this.Vs(b[e], c); return d }; t.Vs = function (b, c) { for (var d = this.oj[7], e = 0; e < d.length; ++e) { var g = d[e]; if (g.isEnabled(this) && g.Fe(b) && (c || g.Xp())) return g.queryCommandValue(b) } return c ? k : m }; t.UD = function (b, c) { if (!gw(this, Ov)) { var d = c.Yb; try { if (d.originalTarget.prefix || "scrollbar" == d.originalTarget.nodeName) return } catch (e) { return } d.prevValue != d.newValue && b.call(this, d) } };
        t.Uw = function (b) { gw(this, Ov) || (b = b.GD ? b.Yb : b, b.target.firebugIgnore || (this.Cx = this.bs = j, this.oe.start())) }; t.ur = function () { A && this.execCommand("clearlorem", j); B && this.Cv(); this.Ze() }; a.hw = function (b) { var c; return b.tc() && (c = b.ib) ? (b = c.Sa()) && b.frameElement : k }, a.iw = function (b) { return (b = b.ib && b.ib.Sa()) && Rq(b) }, a.Kv = function (b, c, d) { if (!gw(b, "selectionchange")) { var e = iw(b), e = e && e.Eb(); b.jf = !!e && tc(b.m(), e); b.dispatchEvent("cvc"); b.dispatchEvent({ type: "selectionchange", SY: c && c.type }); b.Tn(4, c, d) } };
        t.NN = function () { var b = this.vH; this.vH = k; Kv(this, i, b) }; t.Ch = function () { gw(this, "beforechange") || this.dispatchEvent("beforechange") }; a.Jv = function (b, c, d) { c && (b.oe && at(b.oe), b.fk[Ov] = 1); d && (jw(b), b.fk[Pv] = 1) }, a.kw = function (b, c, d) { !c && b.oe && at(b.oe); b.fk[Ov] = 0; b.fk[Pv] = 0; c && b.Cn(); d && b.YC() }, a.gw = function (b, c) { return !!b.fk[c] || b.Oq[c] && 500 >= za() - b.Oq[c] }; t.Ze = function (b) { kw(this, j, b) }; t.Cn = function () { gw(this, Ov) || (this.oe && this.oe.stop(), this.Cx = this.bs = j, gw(this, Pv) || this.Qq.start()) };
        t.YC = function () { gw(this, Pv) || (this.Qq.stop(), this.bs = m, this.dispatchEvent(Pv)) }; a.jw = function (b) { b.oe && at(b.oe); at(b.Qq) }; t.Cv = function () { this.XC(); this.ZC() }; t.XC = function () { gw(this, "beforefocus") || (this.execCommand("clearlorem", j), this.dispatchEvent("beforefocus")) }; t.ZC = function () { if (!gw(this, "focus")) { Vv = this.id; this.jf = j; this.dispatchEvent("focus"); if (B) { var b = this.m(), c = iw(this); if (c) { var d = dq(c); 0 == eq(c) && (!d || d == b || "BODY" == d.tagName) && zt(b) } } !Zq && this.tc() && this.ib.Sa().parent.getSelection().removeAllRanges() } };
        t.Uq = function () { gw(this, "blur") || (Vv == this.id && (Vv = k), this.jf = m, this.dispatchEvent("blur")) }; a.lw = function (b) { Jc(b.target, "A") && b.preventDefault() }; t.fj = function (b) { Vv = this.id; if (A) { var c = b.target; c && ("A" == c.tagName && b.ctrlKey) && this.Ql.Sa().open(c.href) } this.Xt = j }; t.Lw = function () { this.Xt = m }; t.$D = function (b) { if (!this.sI || this.Xt) this.Xt = m, Kv(this, b), A && (this.vH = b.target, this.wH.start()) }; t.zN = function (b) { Kv(this, b) };
        t.il = function () { if (this.queryCommandValue("usinglorem")) return " "; if (!this.Wd()) { var b = this.Mc; b || this.Nb.log(be, "Couldn't get the field element to read the contents", i); return b.innerHTML } var c = this.m(), b = c.cloneNode(m), c = c.innerHTML; A && c.match(/^\s*<script/i) && (c = " " + c); b.innerHTML = c; this.SO(11, b); return this.Ys(10, b.innerHTML) };
        t.Gd = function (b, c, d, e) { if (1 == this.Bj) this.Nb.log(ce, "Can't set html while loading Trogedit", i); else { e && this.execCommand("clearlorem"); c && b && (c = "<p>" + c + "</p>"); d && Jv(this, m, j); b = c; if (c = this.m()) { if (this.tc() && D) for (var g = c.ownerDocument.getElementsByTagName("HEAD"), h = g.length - 1; 1 <= h; --h) g[h].parentNode.removeChild(g[h]) } else c = this.Mc; c && ew(this, b, c); e && this.execCommand("updatelorem"); this.Wd() && (d ? (B && at(this.oe), kw(this)) : this.Ze()) } };
        t.AA = function () { var b = this.ib.Da(); b.designMode = "on"; dr && b.execCommand("styleWithCSS", m, m) }; t.PE = function () { this.Ok && mw(this) && ku(this.Ok, this.m()) }; t.Wd = function () { return 2 == this.Bj }; t.focus = function () { if (!Bt && this.tc()) this.ib.Sa().focus(); else { if (rb) var b = this.Ek.pageXOffset, c = this.Ek.pageYOffset; this.m().focus(); rb && this.Ek.scrollTo(b, c) } }; t.Mf = function () { (Wq || D) && nw(this); this.focus() }; a.nw = function (b) { var c = b.m(); if (c) { var d = qt(c); c == d ? Tq(c, 0).select() : Xs(d, j); Kv(b) } };
        t.Zd = function (b) { this.Bj = 1; var c = this.Mc; this.nodeName = c.nodeName; this.iZ = c.className; this.cssText = c.style.cssText; c.className += " editable"; this.by(b) }; t.by = function (b) { var c = this.Mc; if (c) { var c = c.innerHTML, d = {}, c = this.Ys(8, c, d), e = this.Ql.w("IFRAME", this.ND()); if (mw(this)) { var g = v(this.CE, this, e, c, d); this.dl = N(e, "load", g, j); b && (e.src = b) } this.NB(e); mw(this) || this.CE(e, c, d) } };
        t.vr = function () {
            A && Ct(this.ib.Sa()); Vv != this.id && this.execCommand("updatelorem"); if ((Mg || Ng) && this.tc() && this.FH()) { var b = this.ib.Sa(); this.Qm = v(b.focus, b); b.addEventListener("keydown", this.Qm, m); b.addEventListener("touchend", this.Qm, m) } rb && this.tc() ? (this.Nu = v(this.Cv, this), this.Mu = v(this.Uq, this), b = this.ib.Sa(), b.addEventListener("focus", this.Nu, m), b.addEventListener("blur", this.Mu, m)) : (gr ? (this.addListener("focus", this.ZC), this.addListener(jd, this.XC)) : this.addListener("focus", this.Cv), this.addListener("blur",
            this.Uq, B)); if (B) this.Lz(); else { this.addListener(["beforecut", "beforepaste", "drop", "dragend"], this.Ch); var c = this.Ze, d; d = d || 0; this.addListener(["cut", "paste"], function () { return c.apply(this, Array.prototype.slice.call(arguments, 0, d)) }); this.addListener("drop", this.ur) } this.addListener(D ? "dragend" : "dragdrop", this.ur); this.addListener("keydown", this.ef); this.addListener("keypress", this.sN); this.addListener("keyup", this.tN); this.wH = new yj(this.NN, 250, this); er && this.addListener("click", lw); this.addListener("mousedown",
            this.fj); this.sI ? (this.jc.e(this.ib.Da(), "mouseup", this.$D), this.addListener("dragstart", this.Lw)) : this.addListener("mouseup", this.$D); this.addListener("mouseover", this.zN); this.PE(); kw(this); this.Nb.info("Dispatching load " + this.id); this.dispatchEvent("load"); for (var e in this.nd) this.nd[e].enable(this)
        }; a.mw = function (b) { if (!la(b.Fx) && (b.Fx = m, A && b.tc())) { for (var c = b.Ql.Sa() ; c != c.parent;) try { c = c.parent } catch (d) { break } c = c.location; b.Fx = "https:" == c.protocol && -1 == c.search.indexOf("nocheckhttps") } return b.Fx };
        t.NB = function (b) { var c = this.Mc; b.className = c.className; b.id = c.id; nc(b, c) }; t.qw = function (b) { var c = Lc(Tb(this.Mc)); return new Lv(this.id, c, m, m, b) }; t.HI = function (b, c, d) { d = this.qw(d); mw(this) ? (b = (b.contentDocument || b.contentWindow.document).body, Bt && (b.contentEditable = j), b.className = "editable", b.setAttribute("g_editable", j), b.hideFocus = j, b.id = d.rD, Tf(b, d.Xv), b.innerHTML = c) : Nv(d, c, new Mv(this.m(), this.Ok), b) };
        t.CE = function (b, c, d) { this.dl && (Ad(this.dl), this.dl = k); b.hX = "true"; this.HI(b, c, d); Zv(this, (b.contentDocument || b.contentWindow.document).body); !Bt && this.tc() && this.AA(); this.vr() }; t.ND = function () { var b = "padding:0;" + this.Mc.style.cssText; Fa(b, ";") || (b += ";"); b += "background-color:white;"; A && (b += "overflow:visible;"); return { frameBorder: 0, style: b } }; a.ow = function (b, c) { Uv.call(this, b, c) }, a.pw = void 0; y(ow, Uv); t = ow.prototype; t.Nb = me("goog.editor.SeamlessField"); t.VE = m; t.XO = m; t.Vn = p("VE"); t.dE = function () { gw(this, Ov) || qw(this) };
        t.Zz = function () {
            if (this.ep ? 0 : this.ep = j) {
                var b = m, c = hw(this); if (c) {
                    var d, e = hw(this), g = e.contentDocument.body; d = g.parentNode; 0 === parseInt(lu(e, "height"), 10) && Tf(e, "height", "1px"); if (Lc(Tb(g))) e = d.offsetHeight; else if (e = d.scrollHeight, d.clientHeight != d.offsetHeight) {
                        d = e; if (!(e = pw)) e = document.createElement("div"), e.style.cssText = "overflow:auto;position:absolute;top:0;width:100px;height:100px", g = document.createElement("div"), mg(g, "200px", "200px"), e.appendChild(g), document.body.appendChild(e), g = e.offsetWidth -
                        e.clientWidth, L(e), e = pw = g; e = d + e
                    } d = e; this.KP && (d = Math.max(d, this.KP)); parseInt(lu(c, "height"), 10) != d && (c.style.height = d + "px", b = j)
                } this.ep = m; b && this.dispatchEvent("ifrsz")
            }
        };
        a.qw = function (b) { if (b.ep ? 0 : b.ep = j) { var c = hw(b), d = b.m(), e = m; if (c && d) { var g, h = c.parentNode, l = h.offsetWidth; parseInt(lu(c, "width"), 10) != l && (g = xg(d), c.style.width = l + "px", d.style.width = l - g.left - g.right + "px", e = j); h = h.offsetHeight; b.Vn() && parseInt(lu(c, "height"), 10) != h && (g || (g = xg(d)), c.style.height = h + "px", d.style.height = h - g.top - g.bottom + "px", e = j) } b.ep = m; e && b.dispatchEvent("ifrsz") } }, a.rw = function (b) { b.m() && (qw(b), b.Vn() || b.Zz()) }; t.ex = ""; a.sw = m; t = ow.prototype; t.tc = function () { return !Bt };
        t.Lz = function () { ow.n.Lz.call(this); if (this.tc()) { var b = hw(this).ownerDocument; this.jc.e(b, $v, this.dE, j); this.rP = xd(this.ib.Sa(), "load", this.Zz, j, this); this.jc.e(b, "DOMAttrModified", v(this.UD, this, this.dE), j) } }; t.Cn = function () { gw(this, Ov) || (ow.n.Cn.call(this), this.tc() && this.Zz()) };
        t.Uq = function () { if (!gw(this, "blur") && (ow.n.Uq.call(this), !Bt && !Zq)) { var b = this.ib.Sa(), c = m; Ad(this.nF); this.nF = xd(b.document.body, "dragover", function () { c = j }); fa.setTimeout(v(function () { if (!c && this.ib) { var b = iw(this), e = this.ib.Sa(); Ct(e); b && (b.collapse(j), b.select()) } }, this), 0) } }; t.AA = function () { ow.n.AA.call(this); var b = this.ib.Da(); b.execCommand("enableInlineTableEditing", m, "false"); b.execCommand("enableObjectResizing", m, "false") };
        t.PE = function () { !this.tc() && !sw && (this.Ok && ku(this.Ok, this.m()), sw = j) }; t.by = function (b) { if (this.tc()) ow.n.by.call(this, b); else if (b = this.Mc) Zv(this, b), b.contentEditable = j, ew(this, b.innerHTML, b), this.vr() }; t.vr = function () { if (this.tc()) { var b = this; fa.setTimeout(function () { rw(b) }, 0) } ow.n.vr.call(this) }; t.ND = function () { return { frameBorder: 0, style: "padding:0;" } };
        t.NB = function (b) {
            if (!this.XO) { var c = this.Mc; c && (this.VE = "auto" == Xf(c, "overflowY")) } var c = this.Mc, d = Tb(c), e = c.style.width, g = c.style.height; Tf(c, "visibility", "hidden"); var d = d.w("DIV", { style: "height:0;clear:both", innerHTML: "&nbsp;" }), h = d.cloneNode(j); c.insertBefore(d, c.firstChild); c.appendChild(h); var h = ju(c), d = h.width, h = h.height, l = ""; this.Vn() && (l = "&nbsp;", Tf(c, "position", "relative"), Tf(c, "overflow", "visible"), Tf(b, "position", "absolute"), Tf(b, "top", "0"), Tf(b, "left", "0")); mg(c, d, h); Lc(Tb(c)) && (this.RY =
            c.style.lineHeight, Tf(c, "lineHeight", "0")); c.innerHTML = l; mg(b, d, h); mg(c, e, g); Tf(c, "visibility", ""); c.appendChild(b); mw(this) || (c = b.contentWindow.document, Lc(Tb(b.ownerDocument)) && (c.open(), c.write("<!DOCTYPE HTML><html></html>"), c.close()))
        }; t.qw = function (b) { var c = this.Mc; if (c) return new Lv(this.id, Lc(Tb(c)), j, this.Vn(), b); f(Error("no field")) };
        t.HI = function (b, c, d) {
            Tf(b, "visibility", "hidden"); var d = this.qw(d), e = this.Mc, g = this.Ok; if (!this.ex) {
                var h = this.Mc; if (h) {
                    var l = h.ownerDocument, n = ua(l); if (!Dv[n]) {
                        for (var q = ua(l), r = [], l = sv(l.styleSheets), w = 0, C; C = l[w]; w++) if ((C = rv(C)) && C.length) for (var I = 0, G = C.length; I < G; I++) {
                            var R = new uv, X; X = R; var ja = C[I], Na = ja.style; if (Na) {
                                var Ra = i, Wa = i; Na && (Ra = ja.selectorText) && (Wa = Na.cssText) ? A && (Wa += "/* */") : ja.cssText && (Wa = /([^\{]+)\{/, Ra = Wa.exec(ja.cssText)[1], Wa = ja.cssText.replace(Wa, "").replace(/\}[^\}]*$/g,
                                "")); if (Ra) { ja = X; ja.Wg = []; Ra = Ra.split(/,\s*/gm); for (Na = 0; Na < Ra.length; Na++) { var ie = Ra[Na]; 0 < ie.length && ja.Wg.push(new yv(ie)) } X.jn = Wa; X = j } else X = m
                            } else X = m; X && r.push(R)
                        } Dv[q] = r
                    } q = Dv[n]; n = []; for (r = 0; r < q.length; r++) n.push(q[r].clone()); l = new Cv(h); w = new xv("body"); for (q = 0; q < n.length; q++) {
                        C = n[q].Wg; r = C.length; for (I = 0; I < r; I++) {
                            G = C[I]; R = G; X = l.uid; if (R.Du[X]) X = R.Du[X]; else {
                                for (var Wa = 0, Na = Ra = ja = k, ie = l.YF, YD = ie.length, Pj = 0; Pj <= R.ci.length; Pj++) {
                                    for (Ra = R.ci[Pj]; Wa < YD;) {
                                        var Ex = ie[Wa]; if (Ra && Av(Ra, Ex)) {
                                            ja =
                                            { hD: Wa, xH: Pj }; Wa++; break
                                        } else Na && Av(Na, Ex) && (ja = { hD: Wa, xH: Pj - 1 }); Wa++
                                    } Na = Ra
                                } X = R.Du[X] = ja
                            } X && (R = X.xH, G = G.ci, Wa = G.length - 1, X.hD == l.YF.length - 1 || R < Wa ? (G = G.concat(), G.splice(0, R + 1, w), R = new yv, R.ci = G, C.push(R)) : 0 < R && R == Wa && (R = new yv, R.ci = [w, G[Wa]], C.push(R)))
                        }
                    } l = new uv; h = h.currentStyle || Sb(h).defaultView.getComputedStyle(h, "") || {}; q = new yv; q.ci = [new xv("html")]; l.Wg = [q]; w = {}; for (q = 0; r = Ev[q]; q++) w[r] = h[eb(r)]; vv(l, w); n.push(l); l = new uv; w = new yv; w.ci = [new xv("body")]; C = {
                        position: "relative", top: "0", left: "0",
                        right: "auto", display: "block", visibility: "visible"
                    }; for (q = 0; r = Fv[q]; q++) C[r] = h[eb(r)]; vv(l, C, j); l.Wg = [w]; n.push(l); h = []; r = n.length; for (q = 0; q < r; q++) { C = n[q]; l = h; I = C.Wg.length; w = m; for (G = 0; G < I; G++) { R = C.Wg[G].ci; X = R.length; for (Wa = 0; Wa < X; Wa++) l.push(R[Wa].NE, " "); G < I - 1 && l.push(","); B && !Eb("1.9a") && (w = w || tv.test(R[X - 1].NE)) } C = C.jn; w && (C = C.replace(wv, "$1 color: $2 ! important; ")); l.push("{", C, "}\n") } this.ex = h.join("")
                }
            } e = new Mv(e, g + this.ex); d.oq && (g = xg(e.EU), (g.top || g.left || g.right || g.bottom) && Tf(b, "margin",
            -g.top + "px " + -g.right + "px " + -g.bottom + "px " + -g.left + "px")); Nv(d, c, e, b); rw(this); Tf(b, "visibility", "visible")
        }; t.cv = function () { Ad(this.nF); Ad(this.rP); ow.n.cv.call(this) }; a.tw = {}; tw._default_ = { uw: function (b) { return $.get("/node/CommentV2", { params: { comment_id: b } }) }, jl: nu, kl: nu, add: function (b) { return $.post("/node/AnswerCommentAddV2", { method: "add_comment", params: b }) }, remove: function (b) { return $.post("/node/CommentV2", { method: "remove_comment", params: { comment_id: b } }) }, Vx: function (b, c) { return $.post("/node/CommentV2", { method: c ? "like_comment" : "undo_like_comment", params: { comment_id: b } }) } };
        tw.answer = { jl: function (b, c) { return $.get("/node/AnswerCommentBoxV2", { params: { answer_id: b, load_all: c } }) }, kl: function (b) { return $.get("/node/AnswerCommentListV2", { params: { answer_id: b } }) }, add: function (b) { return $.post("/node/AnswerCommentAddV2", { method: "add_comment", params: b }) }, sK: function (b, c) { return $.post("/node/AnswerCommentV2", { method: "author_remove_comment", params: { comment_id: b, is_block: c } }) } };
        tw.question = { jl: function (b) { return $.get("/node/QuestionCommentBoxV2", { params: { question_id: b } }) }, kl: function (b) { return $.get("/node/QuestionCommentListV2", { params: { question_id: b } }) }, add: function (b) { return $.post("/node/QuestionCommentAddV2", { method: "add_comment", params: b }) } };
        tw.favlist = { jl: function (b) { return $.get("/node/FavlistCommentBoxV2", { params: { favlist_id: b } }) }, kl: function (b) { return $.get("/node/FavlistCommentListV2", { params: { favlist_id: b } }) }, add: function (b) { return $.post("/node/FavlistCommentAddV2", { method: "add_comment", params: b }) } };
        tw.post = {
            uw: function (b) { return $.get("/node/PostCommentV2", { params: { comment_id: b } }) }, jl: function (b, c) { return $.get("/node/PostCommentBoxV2", { params: { post_id: b, load_all: c } }) }, kl: function (b) { return $.get("/node/PostCommentListV2", { params: { post_id: b } }) }, add: function (b) { return $.post("/node/PostCommentV2", { method: "add_comment", params: b }) }, Vx: function (b, c) { return $.post("/node/PostCommentV2", { method: c ? "like_comment" : "undo_like_comment", params: { comment_id: b } }) }, remove: function (b) {
                return $.post("/node/PostCommentV2",
                { method: "remove_comment", params: { comment_id: b } })
            }
        };
        tw.roundtable = {
            uw: function (b) { return $.get("/roundtable/comments/" + b) }, jl: function (b, c) { return $.get("/node/RoundtableCommentBoxV2", { params: { roundtable_id: b, load_all: c } }) }, kl: function (b) { return $.get("/roundtable/comments", { roundtable_id: b }) }, add: function (b) { return $.post("/node/RoundtableCommentV2", { method: "add_comment", params: b }) }, Vx: function (b, c) { return $.post("/node/RoundtableCommentV2", { method: c ? "like_comment" : "undo_like_comment", params: { comment_id: b } }) }, remove: function (b) {
                return $.post("/node/RoundtableCommentV2",
                { method: "remove_comment", params: { comment_id: b } })
            }
        }; a.vw = function (b, c) { var d = b.split("!"); this.type = d[0] + "!"; this.namespace = d[1]; this.Qc = new uw(c) }; y(vw, hd); a.uw = function (b) { this.category = b.category; this.action = b.action; this.label = b.label; this.value = b.value }; uw.prototype.fill = function (b, c) { this[b] = this[b].replace("?", c); return this }; a.ww = function () { M.call(this) }; y(ww, Cu); a.xw = function (b, c, d) { $.post(b, c).done(function (b) { if (b.r) U(b.msg); else { var c = b.msg; (c = c && c.redirect) ? window.location.href = c : (U("操作成功！"), d && d(b)) } }) }, a.yw = void 0, a.zw = Vj($.getJSON); yw = function (b, c) { return zw(Ga("/manage/%s/options?action=%s", b, c)) }; t = ww.prototype; t.$A = { remove: "删除", lock: "锁定", unlock: "解除锁定", collapse: "折叠", uncollapse: "解除折叠", mute: "隔离", unmute: "解除隔离" }; t.PD = function (b) { return yw(b, this.hl()) };
        t.Ru = function () { var b = ww.n.Ru.call(this); b.uc.set("ok", this.$A[this.hl()]); return b }; t.hl = function () { return $(this.Qu).data("op").split("-")[0] }; t.JD = function (b) { return Ga("确定要%s该%s？", this.$A[this.hl()], this.lB[b] || "条目") }; t.zH = function (b) { $(".footnote", this.pw().m()).text(b) }; t.cE = function (b) { b && (b.trackable ? (b = $.extend({ action: "get_member_info", reason: b.value }, this.Ov), $.post("/manage", b).then(function (b) { return Ga("用户已被警告 %s 次，禁言 %s 次", b.warn_num, b.ban_num) }).then(v(this.zH, this))) : this.zH("")) };
        ww.prototype.submit = function () { var b = $(this.Qu).data(), c = b.action, b = b.content, d = $($("form", this.ln.m())[0]).serialize(); b && (d += "&" + b); xw(c, d, this.Kk) }; ww.prototype.z = function () { this.Kk = this.Qu = k; ww.n.z.call(this) }; ww.prototype.open = function (b, c, d) { this.Qu = b; this.Kk = d || ea.MY; ww.n.open.call(this, c.type, c.id, "") }; a.Aw = function (b) { T.call(this); F.extend(this.G = {}, this.defaults, b || {}); this.yk = new Od; this.zf = k }; y(Aw, T); t = Aw.prototype; t.defaults = { trigger: { A: "data-editable" }, BJ: "hc-actionbar", iP: "checked", fT: 100, jO: 100 };
        t.C = function () { Aw.n.C.call(this); this.Lm = K("div"); document.body.appendChild(this.Lm); var b = this.G, c = new qo(b.trigger, m, k, this.g); c.yt = b.fT; c.Gr = b.jO; c.Xg(this.Lm); N(c, "trigger", function (b) { c.ad(new Xn(b.anchor, 1)) }); N(c, "beforeshow", function (b) { this.zf = b.target.anchor; this.Y() }, m, this); c.className = b.BJ; this.oO = c }; t.sw = p("oO");
        a.Bw = function (b, c) { var d = b.G.iP, e = pc(b.Lm), g = z.find(e, function (b) { return b.getAttribute("data-action") === c }); if (!g || E.has(g, d)) return m; z.forEach(e, function (b) { E.remove(b, d) }); E.add(g, d); return j }; t.IK = function (b, c, d) { c = K("div", { title: b.R, "data-action": b.name, className: "button " + b.name + (0 === c ? " first" : c === d.length - 1 ? " last" : "") }, [K("i", "icon icon-actionbar-" + b.name)]); tg(c, j); this.h().e(c, "click", function () { Bw(this, b.name) && b.Jk(this.zf) }); return c };
        t.Y = function () { this.Lm.innerHTML = ""; ic(this.Lm, z.map(F.La(this.yk.Ot()), this.IK, this)) }; a.Cw = function (b) { T.call(this); F.extend(this.G = {}, this.defaults, b || {}) }; y(Cw, T); Cw.prototype.defaults = { tE: {}, pK: j };
        Cw.prototype.C = function () {
            Cw.n.C.call(this); var b = this, c = this.g; if (this.G.pK) {
                var d = new Aw({}); d.yk.set("link", { name: "link", R: "链接", Jk: function (b) { yc(b, b.href) } || ha }); d.yk.set("text", { name: "text", R: "文本", Jk: function (b) { yc(b, b.getAttribute("data-title")) } || ha }); d.o(c); var e = d.sw(); Ys(e, new Of(2, 0, 0, 0)); e.Bl = new Of(2, 0, 0, 0) || k; var g = d.h(); g.e(e, "beforeshow", function (b) { var b = b.target.anchor, c = Gc(b); c === b.href ? Bw(d, "link") : (c !== b.getAttribute("data-title") && b.setAttribute("data-title", c), Bw(d, "text")) }).e(e,
                "beforehide", function (b) { if ((b = b.target) && c.contains(b) && Dw(b)) return m }); var h; g.e(e, "show", function (b) { h = b.target.anchor; E.add(h, "hover") }).e(e, "hide", function () { h && (E.remove(h, "hover"), h = k) }); this.Wp = d
            } this.h().e(c, "paste", function () {
                setTimeout(function () {
                    var c = b.G, d = b.g, e = Ac(d, function (b) { return 3 === b.nodeType && !Ew(b, d, function (b) { return Dw(b) || "CODE" === b.nodeName || "PRE" === b.nodeName }) }), g, h = Rq(), C = h && cq(h); z.forEach(e, function (b) {
                        var c = b.nodeValue, d = c.replace(Fw, function (b) {
                            Ea(b, "http") || (b =
                            "http://" + b); return b.link(b)
                        }); d !== c && (c = gc(d), C === b && (g = c.lastChild), nc(c, b))
                    }); g && Xs(g); var I = c.tE, c = z.filter(d.getElementsByTagName("A"), function (b) { var c = b.getAttribute("href"); if (c = !(!c || "#" === c)) if (c = !b.getAttribute("data-editable")) if (c = z.contains(Gw, b.protocol)) c = Gc(b), Ea(b.href, c) ? b = i : (b.setAttribute("data-editable", j), b.setAttribute("data-title", c), b = j), c = !b; return c }), c = z.map(c, function (b) {
                        return Hw(b.href).done(function (c) {
                            var e = I; if (c && d.contains(b)) {
                                var e = e || {}, g = function (b, c, d) {
                                    var e =
                                    Rq(); if (e) { var g = e.W(), h = e.ua(), l = e.ha(), n = e.Ia(); tc(c, g) && (g = b, h = 0); tc(c, l) && (l = b, n = 0); d(function () { g === b && l === b ? Xs(b) : Dq(g, h, l, n).select() }) } else d(ha)
                                }, h = {
                                    link: function (b, c) { b.setAttribute("data-editable", j); c.title === b.href ? b.setAttribute("data-title", b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname) ? -2 : -3).join(".").replace(/^www\./, "") + " 的页面") : (b.setAttribute("data-title", c.title), g(b, b, function (d) { yc(b, c.title); d() })) }, image: function (b, c) {
                                        var d = document.createElement("img");
                                        d.src = c.src; d.setAttribute("data-rawwidth", c.width); d.setAttribute("data-rawheight", c.height); g(d, b, function (c) { nc(d, b); c() })
                                    }
                                }; (e = e[c.type] || h[c.type]) && e(b, c)
                            }
                        })
                    }); c.length && (b.dispatchEvent("willScrape"), $.when.apply($, c).always(function () { b.dispatchEvent("didScrape") }))
                })
            }).e(c, "keydown", this.bO)
        };
        Cw.prototype.bO = function (b) {
            var c = uh(b.keyCode), d = 8 === b.keyCode; if (!(b.ctrlKey || (b.altKey || b.metaKey) || !c && !d)) {
                var c = Rq(), e = c.W(), g = c.ha(), h = this.g, l, n = Ew(e, h, Dw) || g !== e && (l || (l = Ew(g, h, Dw))); if (n) {
                    var q = Gc(n), r = c.ua(), w = c.Ia(); if (n.getAttribute("data-editable") && q === n.href) {
                        var C = m; l = l || Ew(g, h, Dw) || n; var h = n.contains(e), I = l.contains(g); if (d) h && (e = n, r = 0, C = j), I && (g = l, w = Rs(l), C = j), C && Dq(e, r, g, w).select(); else if (h && I && l === n) { if (!c.isCollapsed() || !(0 === r || q.length === r)) b.preventDefault(), Xs(n) } else h &&
                        (e = n.nextSibling, r = 0, C = j), I && (g = l.previousSibling, w = Rs(g), C = j), C && Dq(e, r, g, w).select()
                    }
                }
            }
        }; a.Fw = /\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig, a.Gw = ["http:", "https:"], a.Ew = function (b, c, d) { for (; b && b !== c;) { if (d(b)) return b; b = b.parentNode } }, a.Dw = function (b) { return "A" === b.nodeName }, a.Hw = Vj(function (b) { return $.post("/scraper", { url: b }) }); a.Iw = function (b, c, d) { T.call(this); this.id = b; this.type = c; this.field = k; this.xd = this.$f = m; this.ae = "写下你的评论…"; this.placeholder = '<p style="color:#999">' + this.ae + "</p>"; this.Gl = ""; this.ga = -1; this.uF = $.Deferred().resolve(); this.cz = this.ss = k; this.kC = "zm-comment-box"; this.lh = k; (b = tw[c]) || f(Error("API not found")); this.Bi = $.extend({}, tw._default_, b); F.extend(this.G = {}, this.defaults, d || {}) }; y(Iw, T); t = Iw.prototype; t.defaults = { rF: m, autofocus: j, Gv: "empty", Ge: "zm-item-comment" };
        t.ea = function (b) { Iw.n.ea.call(this, b); Jw(this); Kw(this); this.xd = j; z.forEach(Lw(this), this.Ay, this) }; a.Mw = function (b, c, d) { var e = J(b.kC, c); d && (b.lh = d); e ? b.o(e) : (b.$f = j, b.Y(c)) }; t.nK = "zm-comment-bubble"; t.JB = "." + Iw.prototype.nK; t.bu = function (b) { return $(b, this.g) }; t.w = function () { this.g = K("div", { "class": this.kC, style: "display:none" }); this.Od() }; t.Ki = s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');
        t.z = function () { Iw.n.z.call(this); this.field = this.pC = this.$m = this.BB = this.lh = this.cz = this.sF = k }; a.Nw = function (b) { var c = b.Xk, d = c.m(); if (c.il() !== b.placeholder) { c.Gd(m, b.placeholder); var e = ["click", "focus", "keydown"], g = function () { c.Gd(m, this.Gl || ""); this.field.lastChild ? Xs(this.field.lastChild) : c.Mf(); yd(d, e, g, m, this) }; N(d, e, g, m, b); var h; window.getSelection ? (h = window.getSelection(), h.anchorNode && tc(b.field, h.anchorNode) && h.removeAllRanges()) : document.selection && b.field.blur() } };
        t.Ur = function (b) { (b = b.m && b.m()) && (new Cw({ tE: { image: ha } })).o(b) }; t.Tr = function (b, c) { if (b.m) { var d = (new kj).add("type", this.type + "_comment").add("resource_id", this.id), e = b.m(); this.FY = d = new Ir(e, { Cm: { source: "/people/autocomplete?" + d.toString() }, Mj: J("zu-main") || document.body }); new Er(e, { oz: Kr }); qa(c) && c(d) } };
        t.jT = mn(function (b) {
            var c = J("zm-comment-content-wrap", b), d = J("zm-comment-form", b), e = b.getAttribute("data-id"), g = this, h; if (d) { h = J("zm-comment-editable", d); if (rg(d)) { if (mt(d)) return Q(d, m) } else Q(d, j); Ow(h) } else {
                (b = J("zm-comment-reply-hack")) ? (b = gc(Vs(b)), E.Bk(b, "zm-comment-reply-hack", "zm-comment-reply-hacked"), lc(b, c)) : (b = "", S.wa() && (b = '<img class="avatar" src="' + S.zM() + '">'), b = gc('<div class="zm-comment-form expanded"><div class="zm-comment-editable-wrap">' + b + '<div class="zm-comment-editable" aria-label="写下你的回复"></div></div><div class="zm-command zg-clear"><a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a><a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a></div></div>'),
                c.appendChild(b)); d = b; h = J("zm-comment-editable", d); var l = new ow(h); l.Gd(m, ""); l.Zd(); this.Tr(l, function () { Ow(h) }); this.Ur(l); c = J("zm-comment-close", d); b = J("zm-comment-submit", d); b.name = ""; var n = function () { var b = La(l.il()), c = La(Gc(h)); b && c ? Pw(g, { content: b, qS: e }, function (b) { b.r || (Q(d, m), l.Gd(m, ""), (b = z.Je(Lw(g))) && tt(b, { offsetTop: 100, GB: j })) }) : (U("请填写内容"), h.focus()) }; N(c, "click", function () { Q(d, m) }); N(b, "click", n); N(h, "keydown", function (b) { if (13 === b.keyCode && (b.ctrlKey || b.metaKey)) n(), b.preventDefault() })
            } tt(d,
            100)
        }, function () { return { wa: { question: "question_comment_reply", answer: "question_answer_comment_reply" }[this.type] || j, qg: j } }); a.Ow = function (b) { b.focus(); b = fq(b); b.collapse(); b.select() }, a.Kw = function (b) { var c = location.hash.slice(1).split("-"), d = "comment" === c[0] && c[1]; d && (b = z.find(Lw(b), function (b) { return b.getAttribute("data-id") === d }), Gk(b), tt(b)) }, a.Lw = function (b) { return $(b.$m).children(".zm-item-comment").get() }; t.xt = function (b) { E.enable(this.pC, "expanded", b) };
        t.oi = function (b, c) { this.dispatchEvent(new vw("click!comment", { category: "?", action: this.type + "_comments", label: "?_" + b, value: pa(c) ? c : this.Va() })) }; t.ej = function () { this.xd ? Qw(this) : this.$f = j }; t.CQ = function (b) { if (13 === b.keyCode && (b.ctrlKey || b.metaKey)) this.Yp(), $(this.field).blur(), b.preventDefault(); 27 === b.keyCode && Rw(this) };
        t.ka = function (b) {
            var c = Kk(this.g, b.target, "BUTTON") || Kk(this.g, b.target); if (c && c.name) {
                var d = Jc(c, k, this.G.Ge); b.preventDefault(); switch (c.name) {
                    case "reply_comment": this.jT(d); break; case "cancelanon": b = $(this.g).parents(".feed-item-hook").data("qid"); ct(0, k, b); break; case "delcomment": this.vl(c); break; case "like_comment": this.vN(c); break; case "author_delcomment": var e = this, g = Jc(c, k, this.G.Ge), h = g.getAttribute("data-id"), b = $(".zm-item-link-avatar", g).prop("href"); $.get(b + "/block", function (b) {
                        var c =
                        Di("删除评论", "你确定要删除这条评论吗？" + ('<p style="margin-top: 0.2em;color:#999;' + (b.r || b.msg ? "display:none" : "") + '"><label><input type="checkbox">同时将此人屏蔽</label></p>'), function (b) { if (b) { var b = $(":checkbox", c.m()).prop("checked"), d = xa(L, g); e.Bi.sK(h, Number(b)).done(v(function () { qa(d) && d(); this.ga -= 1; Sw(this) }, e)) } }, e)
                    }); break; case "admin_delcomment": var l = Jc(c, k, this.G.Ge); (new ww).open(c, { id: l.getAttribute("data-id"), type: "comment" }, v(function () { L(l); this.ga -= 1; Sw(this) }, this)); break; case "closeform": Rw(this);
                        break; case "report": this.yr(c); b.stopPropagation(); break; case "addnew": this.Yp(); break; case "load-more": this.oi("comments_all"), this.sF(c)
                }
            }
        };
        t.sF = function (b) { this.ss && "pending" === this.ss.state() || (b && E.add(b, "loading"), this.ss = this.cz || this.tF(), this.ss.done(v(function (c) { c = $(c).filter(".zm-item-comment").get(); if (c.length) { var d = Lw(this); d.length && (c = z.filter(c, function (b) { return !z.find(d, function (c) { return c.getAttribute("data-id") === b.getAttribute("data-id") }) }), c = z.concat(d, c).sort(function (b, c) { return b.getAttribute("data-id") - c.getAttribute("data-id") }), z.forEach(c, this.LB, this), b && L(b)); ic(this.$m, c) } }, this))) };
        t.vN = mn(function (b) { var c = $(b), d = Jc(b, k, this.G.Ge), b = $(".like-num", d), e = d.getAttribute("data-id"); (d = !c.hasClass("liked")) && this.oi("like_comment"); this.Bi.Vx(e, d); var e = $("em", b), g = +e.text() + (d ? 1 : -1); b.toggleClass("liked", d).toggleClass("nil", 0 >= g).attr("data-tip", "s$r$" + g + " 人觉得这个很赞"); e.text(g); c.toggleClass("liked", d); zk(c[0], d ? "取消赞" : "赞") }, j); a.Rw = function (b) { 0 < b.Va() ? (b.Gl = b.eb(), b.xt(m), Nw(b)) : b.lh ? b.collapse() : b.xt(); b.ue() }; t.expand = function () { this.Ka(j) }; t.collapse = function () { this.Ka(m) };
        t.lc = p("xd"); t.Ka = function (b) { if (b !== this.xd) { b && (this.bu(this.JB).hide(), this.Od()); this.xd = b; this.dispatchEvent(b ? "beforeexpand" : "beforecollapse"); Q(this.g, this.xd); var c = v(function () { b && Tw(this); this.dispatchEvent(b ? "expand" : "collapse"); this.fl && !b && (Ar(this.fl), tt(this.fl.g)) }, this), d; b && this.$f ? (d = Qw(this)) && d.done(c) : setTimeout(c); this.lh && (b ? (this.yR = Gc(this.lh), zk(this.lh, "收起评论")) : zk(this.lh, 0 > this.ga ? this.yR : this.ga ? this.ga + " 条评论" : "添加评论")) } }; t.yf = function () { this.Ka(!this.xd) };
        a.Tw = function (b) { if (b.lh) { var c = $(b.lh); b.bu(b.JB).show().css("left", c.position().left + c.width() / 2) } }, a.Qw = function (b) { if ("pending" !== b.uF.state()) { b.jb(); b.g.innerHTML = b.Ki(); b.expand(); var c = b.Bi.jl(b.id, b.G.rF).done(v(b.jS, b)); return b.uF = c } }; t.tF = function () { return this.Bi.kl(this.id) }; a.Uw = function (b, c, d, e) { var c = $(c), g = $(d); d ? ($(".zm-command, .zm-comment-info", b.g).hide(), $(b.field).hide().after(g).after(c)) : c.insertAfter(b.field); e && e.call(b, c, g) };
        t.jS = function (b) { b = gc(La(b)); Q(b, this.xd); z.forEach($("." + this.G.Ge, b).get(), this.Ay, this); this.$f = m; this.jb(); nc(b, this.g); this.g = b; Jw(this) };
        a.Jw = function (b) {
            F.forEach({ BB: ".load-more", $m: ".zm-comment-list", pC: ".zm-comment-form", field: ".zm-comment-editable" }, function (b, c) { this[c] = $(b, this.g)[0] }, b); b.field && b.field.setAttribute("aria-label", b.ae); if (Rg) { var c = b.field; c.setAttribute("contentEditable", j); var d = b.Xk = { m: function () { return c }, il: function () { return c.innerHTML }, Gd: function (b, d) { c.innerHTML = d }, Mf: function () { zt(c) } }; b.Tr(d); b.Ur(d) } else {
                var e = K("textarea", { placeholder: b.ae, "class": "zm-comment-textarea" }); nc(e, b.field); new Io(e,
                22); b.field = e; b.Xk = { m: function () { return e }, il: function () { return e.value }, Gd: function () { e.value = ""; e.style.height = Zf(22, j) }, Mf: function () { e.focus() } }
            } b.h().e(b.field, ["change", "keyup"], function (b) { 27 !== b.keyCode && (this.Gl = At(this.field) ? "" : this.eb()) }); S.wa() && !S.yi && Uw(b, '<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>', '<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>', function (b, c) {
                function d() { Zk.T().F(j) } b.on("click", d); c.on("click",
                d)
            }); S.wa() || Uw(b, '<div class="signin-mask-tip-comment"></div>', k, function (c, d) { function e() { new hn({ question: "question_comment_box", answer: "question_answer_comment_box" }[b.type]) } c.on("click", e); d.on("click", e) }); Nw(b); b.h().e(b.g, "click", b.ka).e(b.field, "keydown", b.CQ).e(Mi, "anon_change", b.ej).e(b.Xk.m(), ["click", "focus"], xa(b.xt, j)).e(b.Xk.m(), "focus", xa(b.oi, "add_comment_start")); b.ga = Number(b.g.getAttribute("data-count")); $(b.g).on("focusin focusout", "." + b.G.Ge, function (b) {
                $(this).toggleClass("focusin",
                "focusin" === b.type)
            }); !sb && b.BB && (b.cz = $.Deferred(function (b) { setTimeout(b.resolve, 2E3) }).promise().then($.proxy(b.tF, b))); Sw(b); Tw(b)
        }, a.Sw = function (b) { var c = b.G, d = !b.Va(); E.enable(b.g, c.Gv, d); d && b.field && c.autofocus && b.field.focus(); b.dispatchEvent("change") }; t.eb = function () { var b = La(this.Xk.il()); return b === this.placeholder ? "" : b }; t.Yp = function () { var b = this.eb(), c = La(Gc(this.field)); b && "TEXTAREA" === this.field.tagName && c || b ? Pw(this, b) : (U("请填写内容"), this.field.focus()) }; t.Va = p("ga");
        a.Pw = function (b, c, d) { if (!(b.Xl && "pending" === b.Xl.state())) { var e; ra(c) && (e = c.qS, c = c.content); var c = Oa(c), g = new Od; g.set(b.type + "_id", b.id); g.set("content", c); e && g.set("reply", e); c = b.Bi.add(g.Ot()); c.done($.proxy(b.KM, b)).done(d); b.Xl = c; b.Gl = b.eb(); b.oi("add_comment_submit") } }; t.KM = function (b) { if (b.r) return U(b.msg); this.Bi.uw(b.msg).done($.proxy(this.kS, this)); this.Xk.Gd(""); Nw(this); this.xt(m) }; t.Ay = function (b) { this.LB(b) };
        t.LB = function (b) { if (rh("auth_f_manage") && !("favlist" === this.type || $(".del, .op.remove", b).length)) { var c = b.getAttribute("data-id"); $("<a>", { href: "#", name: "admin_delcomment", "class": "del zm-comment-op-link op needsfocus", html: '<i class="zg-icon zg-icon-comment-del"></i>删除', "data-op": "remove-comment", "data-action": "/manage?" + $.param({ comment_id: c, action: "remove_comment2" }) }).appendTo($(".zm-comment-ft, .actions", b)) } };
        t.kS = function (b) { this.Gl = ""; b = gc(b); this.$m.appendChild(b); this.Ay(b); this.ga += 1; Sw(this) }; t.yr = function (b) { b = Jc(b, k, this.G.Ge).getAttribute("data-id"); Eu("comment", b) }; t.vl = function (b) { var c = Jc(b, k, this.G.Ge), d = c.getAttribute("data-id"); Di("删除评论", "你确定要删除这条评论吗？", function (b) { if (b) { var g = xa(L, c); this.Bi.remove(d).done(v(function () { qa(g) && g(); this.ga -= 1; Sw(this) }, this)) } }, this) }; t.Od = function () { $(window).on("beforeunload.CommentForm", v(function () { if (this.Gl) return "你的评论还未保存，确认离开该页面吗？" }, this)) }; t.ue = function () { $(window).off("beforeunload.CommentForm") };
        a.Vw = function (b) { if (!b.fl && !ch.Ac) { var c = Jc(b.g, k, "zm-item-meta"); if (c) { var d = J("zm-meta-panel", c); d && (b.fl = new Cr(k, c), b.fl.hh = "comment", b.fl.o(d)) } } }; a.Ww = function (b) { T.call(this); this.entryType = b }; y(Ww, T); t = Ww.prototype; t.Vv = "zm-item-expanded"; t.jy = "zm-item-meta"; t.xj = k; t.C = function () { Ww.n.C.call(this); var b = $(this.g), c = {}; $("meta[itemprop]", b).each(function () { var b = $(this); c[b.attr("itemprop")] = b.attr("content") }); this.vb = c[this.entryType + "-id"]; this.Gh = c[this.entryType + "-url-token"]; this.br = c; this.Om(); this.le() };
        t.Om = function (b) {
            var c = { 'a[name="expand"]': function (b) { this.Ka(j); this.Xn && (b.currentTarget.name = "toggleExpanded") }, 'a[name="collapse"]': function () { this.Ka(m) }, 'a[name="toggleExpanded"]': this.yf, 'a[name="ignore"]': this.Qw, ".js-close": this.hE, ".js-collect": this.tl, ".js-hiderelated": this.gE, ".js-report": this.LN, ".js-share": this.zc, ".js-toggle-commentbox": this.mE, ".js-unhide": this.qE, 'a[name="dislike"]': this.WM }; F.extend(c, b || {}); F.forEach(c, function (b, c) { $(this.g).on("click", c, $.proxy(b, this)) }, this);
            var d = $(".zm-meta-panel", this.g); F.forEach({ 'a[name="toggle-comment"]': function (b) { this.mE(b); d.toggleClass("focusin", this.ra.lc()) }, 'a[name="share"]': this.zc }, function (b, c) { d.on("click", c, $.proxy(b, this)) }, this)
        }; t.mE = function (b) { this.tp(); this.ra.lc() && (b = parseInt(Gc(b.currentTarget), 10) || 0, this.ra.oi("view_comments", b)) }; t.LN = function () { Eu(this.entryType, this.vb) }; t.ey = function () { nv(this.entryType, this.Gh, "read") }; t.Dj = function () { nv(this.entryType, this.Gh, "touch") };
        t.lc = function () { return E.has(this.g, this.Vv) }; t.yf = function () { this.Ka(!this.lc()) }; t.Ka = function (b) { if (b === this.lc()) return m; b && ju(this.g).height < Zb().height && 1 < $("a.collapse", this.g).length && $("a.collapse", this.g).eq(0).remove(); E.enable(this.g, this.Vv, b); this.dispatchEvent(b ? "expand" : "collapse"); return j }; t.pR = function () { window.open(J(this.xj, this.g).href) }; t.hE = function () { $(this.g).fadeOut(150, function () { $(this).remove() }) }; t.qE = ha; t.gE = ha;
        t.zc = mn(function () { new jv(arguments, "tb-webshare-sina") }, { wa: "question_answer_share" });
        t.WM = function () {
            var b = $(this.g), c = $(".feed-item-inner", this.g), d = $(".dislike-wrap", this.g), e = d.data(); d.one("click", ".revert", function () { c.slideDown(); d.slideUp(); $.post("/topstory/item/uninterest/revert", e) }).one("click", ".close", function () { b.slideUp(function () { b.remove() }) }).on("click", ".zg-unfollow", function () { var c = $(this).data(), d = { roundtable: ck, column: bk }; Di("确定取消关注？", wu("确定取消关注%s吗？", c.title), function (e) { e && (d[c.follow](c.token, m), b.slideUp(function () { b.remove() })) }, this) }); $.post("/topstory/item/uninterest",
            e).done(function () { c.slideUp(); d.slideDown() })
        }; t.tp = function () { if (!this.ra) { var b = $(".toggle-comment", this.g)[0]; this.ra = new Iw(this.vb, this.entryType); this.J(this.ra); Mw(this.ra, J(this.jy, this.g), b); Vw(this.ra) } this.ra.yf() }; t.Pw = function () { this.ra ? this.ra.field.focus() : this.tp() };
        t.le = function () { this.eg = xk.FI(this.g); wk(this.eg.register("shift+o", this.pR, this), { group: "操作", name: "新窗口打开条目" }); var b = $('a[name="dislike"], a[name="ignore"]', this.g); b.length && wk(this.eg.register("i g", function () { b.click() }), { group: "操作", name: "不感兴趣" }) }; a.Xw = function (b) { T.call(this); this.zI = "votebar-mobile"; this.zv = "votebar-mobile-dialog"; this.OA = b; this.AI = K("span", "_votebar-holder") }; y(Xw, T); Xw.prototype.ea = function (b) { Xw.n.ea.call(this, b); this.h().e(b, "click", this.sR) }; Xw.prototype.OL = function () { var b = this.OA; nc(b.m(), this.AI); E.remove(b.m(), this.zI) }; Xw.prototype.oP = '<div class="text zg-clear"><label class="zg-left">赞同</label><label class="zg-right">反对</label></div>';
        Xw.prototype.sR = function () { this.ob && this.ob.H(); var b = new zi(k, m); b.kn = j; b.So(j); b.qM = j; var c = this.OA; nc(this.AI, c.m()); E.add(c.m(), this.zI); this.h().e(c, "action", function () { this.ob && setTimeout(v(function () { this.ob.F(m) }, this), 150) }); P(this.h(), b, "hide", this.OL); c = b.Z(); c.appendChild(this.OA.m()); c.appendChild(gc(this.oP)); E.add(b.m(), this.zv); b.F(j); this.ob = b; Sc(this, b) }; a.Yw = function () { Ww.call(this, "post") }; y(Yw, Ww); t = Yw.prototype; t.xj = "post-link";
        t.C = function () {
            Yw.n.C.call(this); var b = this.Gt = new Au; this.J(b); Sc(this, b); this.h().e(b, "expand", function () { this.Ka(j) }); b.o(this.g); b.hd() && P(this.h(), b, "expand", this.ey); zu(this.g, this.Dj, this); if (b = J("zm-votebar", this.g)) this.tb = new av(this.vb, this.entryType), Sc(this, this.tb), this.tb.o(b), (b = J("votenum-mobile", this.g)) && (new Xw(this.tb)).o(b); if (b = J("zm-item-vote-info", this.g)) {
                var c = this.AZ = new Zw(this.vb, this.entryType); Sc(this, c); c.o(b); this.tb && this.h().e(this.tb, "change", function () { c.ei() }).e(c,
                "change", function () { var b = J("zm-item-vote-count", this.g), e = $(".zm-votebar .count", this.g)[0]; b && zk(b, c.Va()); e && zk(e, c.Va()) })
            }
        }; t.zc = function () { Yw.n.zc.call(this, "分享文章", "post", this.vb, { post_id: this.vb }) }; t.Ka = function (b) { Yw.n.Ka.call(this, b) && (b || Vt($(".entry-body", this.g)[0]), this.Gt.Ka(b), this.Kz(b)) }; t.Kz = function (b) { var c = this.Pn(); c && zr(c, b) };
        t.Pn = function () { if (this.Fp) return this.Fp; var b = !sb, c = J("zm-editable-content", this.g), d = this.tb && this.tb.m(); b && (d && $(d).is(":visible") && c && 230 < $(c).height()) && (b = this.Fp = new Cr(k, c), this.J(b), b.hh = "votebar", b.Ry = 50, b.o(d)) }; t.Qw = function () { $(".feed-hide-options", this.g).show().siblings().hide(); $.post(wu("/post/uninterest"), { id: this.vb }) }; t.qE = function () { $(".feed-hide-options", this.g).hide().siblings().show(); $.post(wu("/post/undo_uninterest"), { id: this.vb }) };
        t.gE = function (b) { var b = $(b.currentTarget), c = b.data(); Di(b.attr("title"), wu("确定%s吗？", b.text()), function (b) { b && (this.hE(), $.post(wu("/%s/uninterest", c.type), { id: c.id })) }, this) };
        t.le = function () { Yw.n.le.call(this); wk(this.eg.register("v", function () { this.tb && this.tb.Qt() }, this), { group: "操作", name: "赞同" }); wk(this.eg.register("d", function () { this.tb && this.tb.Pt() }, this), { group: "操作", name: "反对" }); wk(wk(wk(wk(this.eg.register("o", this.yf, this), { group: "操作", name: "显示全部/收起" }).register("c", this.tp, this), { group: "操作", name: "打开评论" }).register("f x", this.zc, this), { group: "操作", name: "分享" }).register("shift+c", this.Pw, this), { group: "操作", name: "定位到评论框" }) }; a.$w = function (b) { Ww.call(this, b) }; y($w, Ww); $w.prototype.xj = "question_link"; $w.prototype.Qw = function () { var b = this.br["question-id"]; this.dispatchEvent({ type: "ignore", key: "question-id", value: b }); $.post("/question/uninterest", { qid: b }) }; a.ax = function () { Ww.call(this, "question") }; y(ax, $w); ax.prototype.C = function () { ax.n.C.call(this); zu(this.g, function () { nv("question", this.Gh, "touch") }, this) }; ax.prototype.zc = function () { ax.n.zc.call(this, "分享问题", "question", this.Gh, { qid: this.vb }) };
        ax.prototype.le = function () { ax.n.le.call(this); wk(wk(wk(this.eg.register("c", this.tp, this), { group: "操作", name: "打开评论" }).register("f x", this.zc, this), { group: "操作", name: "分享" }).register("shift+c", this.Pw, this), { group: "操作", name: "定位到评论框" }) }; a.bx = function () { Ww.call(this, "answer") }; y(bx, $w); a.cx = function (b) { return J("zm-item-answer", b) || J("entry-body", b) }; t = bx.prototype; t.C = function () { bx.n.C.call(this); this.HB = cx(this.g); this.Xn = this.HB.getAttribute("data-isowner"); this.px(); this.Dl() }; t.zc = ha;
        t.Ka = function (b) { bx.n.Ka.call(this, b) && (b || (Vt(this.rg.m()), dx(this, m)), b && this.Dl(), this.rg.Kz(b), this.rg.Gt.Ka(b)) }; t.px = function () { var b = J("zm-item-answer-author-wrap", this.g); b && (b = J("zm-list-avatar", b), ek.add(b)) }; t.Dl = function () { this.rg = new ex(this.br["question-id"], { Jb: this.br["question-url-token"] }, this.vb); var b = J("zm-item-meta", this.g); this.rg.nc = b; this.J(this.rg); this.rg.o(this.HB); b = this.rg.Gt; this.h().e(b, "expand", function () { this.Ka(j) }); this.Dl = ha };
        t.le = function () { bx.n.le.call(this); wk(this.eg.register("o", this.yf, this), { group: "操作", name: "显示全部/收起" }) }; t.Om = function () { bx.n.Om.call(this, { "a[name=expandQuestionDetail]": function () { dx(this, j) } }) }; a.dx = function (b, c) { $(".feed-question-detail-item", b.g).toggleClass("question-detail-expanded", c) }; a.fx = function () { Ww.call(this, "roundtable") }; y(fx, Ww); t = fx.prototype; t.C = function () { fx.n.C.call(this); this.MA() }; t.xj = "roundtable_link"; t.Qw = function () { $.post("/roundtable/" + this.Gh, { action: "mute" }); this.dispatchEvent({ type: "ignore", key: "roundtable-id", value: this.vb }) }; t.MA = function () { var b = J("roundtable", this.g); zu(b, this.Dj, this) }; t.Dj = function () { nv("roundtable", this.Gh, "touch") }; a.gx = function () { Ww.call(this, "column") }; y(gx, Ww); gx.prototype.C = function () { gx.n.C.call(this); this.MA() }; gx.prototype.MA = function () { var b = J("column", this.g); zu(b, this.Dj, this) }; gx.prototype.Dj = function () { nv("column", this.Gh, "touch") }; a.hx = function (b) { var c = b.getAttribute("data-type"); return (c = { p: Yw, a: bx, q: ax, r: fx, c: gx }[c]) ? new c : cx(b) ? new bx : new T }; a.ix = function (b, c, d) { Su.call(this, b, c, d) }; y(ix, Su); ix.prototype.Ij = function (b) { var c = hx(b); this.J(c); c.o(b); c instanceof bx && c.Ka(m) }; a.jx = function () { M.call(this); this.U = k; this.qa = 0; this.Wx = []; this.os = []; this.tA = "最多输入 20 字"; this.xv = "最多输入 256 字" }; y(jx, yn); a.kx = k, a.lx = function () { kx || (kx = new jx); return kx }; t = jx.prototype;
        t.w = function () {
            this.cD = j; this.g = K("div", k, [this.yj = K("div", k, [this.Pg = K("div", "zm-favo-list-content"), this.tB = K("div", "zh-favo-add-new-wrap zm-command", this.vT = K("a", { "class": "zm-favo-dialog-create zg-left", href: "javascript:;" }, "+ 创建收藏夹"), this.dv = K("a", { href: "javascript:;", "class": "zg-btn-blue" }, "关闭")), this.uu = K("div", "zh-favo-add-new-wrap zm-command", this.aL = K("a", { href: "javascript:;", "class": "" }, "取消"), this.wT = K("a", { "class": "zm-favo-dialog-create zg-btn-blue", href: "javascript:;" }, "创建收藏夹"))]), this.iw =
            K("div", { style: "display:none" }, [K("div", k, ["标题", this.sA = K("span", { "class": "zh-favo-add-title-error" }, "请填写标题")]), K("div", "zg-section", this.zj = K("input", { "class": "zg-form-text-input", style: "width:97%;font-size:13px" })), K("div", k, "描述（可选）"), K("div", "zg-section zg-editor-simple-wrap zg-form-text-input", this.Hl = K("textarea", { "class": "zg-editor-input", style: "height:66px" })), this.UR = K("label", k, [this.bP = K("input", { type: "radio", checked: "checked", value: "public", name: "mode" }), K("strong", k, " 公开 "), K("span", "zg-gray-normal",
            "公开后不能设置为私密")]), this.mP = K("br"), this.RR = K("label", k, [this.aP = K("input", { type: "radio", value: "private", name: "mode" }), K("strong", k, " 私密 "), K("span", "zg-gray-normal", "只有你可以查看这个收藏夹")]), K("div", "zm-command", [this.eA = K("a", { href: "javascript:;", "class": "zg-mr10" }, "取消"), this.Aq = K("a", { href: "javascript:;", "class": "zg-mr10" }, "完成"), this.rB = K("a", { "class": "zg-btn-blue" }, "确认创建")])])]); Q(this.sA, m); Q(this.uu, m); (new Co(this.tA)).o(this.zj); (new Co(this.xv)).o(this.Hl); z.forEach(this.Wx, function (b) { mx(this, b) }, this);
            this.Wx.length || (this.Pg.innerHTML = '<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ', Q(this.uu, j), Q(this.tB, m)); nx(this); this.U.Z().innerHTML = ""; this.U.Z().appendChild(this.g); this.U.ma()
        };
        a.nx = function (b, c, d) { b.U || (b.U = new zi(k, m), ii(b.U, k), b.U.ab(c || ""), d && (b.U.Z().innerHTML = d), b.h().e(b.U, "afterhide", function () { this.ue() })) }, a.mx = function (b, c, d) {
            var e = H("zh-fav-list-item-place-holder"); e && Q(e, m); b.dz = c[5] ? "" : K("span", "zm-fav-list-item-lock", [K("i", "icon icon-lock")]); e = K("span", "zm-favo-list-item-title"); yc(e, c[1]); e = K("a", { "class": "zg-r5px zm-favo-list-item-link", href: "javascript:;" }, [b.dz, e, K("span", {
                className: "meta zg-gray", innerHTML: '<span class="num">' + c[3] + '</span> 条答案 <span class="zg-bull">•</span> ' +
                c[4] + " 人关注"
            })]); b.dz && b.dz.setAttribute("data-tip", "s$t$私密收藏夹"); e.setAttribute("data-lid", c[0]); z.contains(b.os, c[0]) && E.add(e, "zm-favo-list-item-link-active"); c = J("zm-favo-list-item-link", b.Pg); d && c ? kc(e, c) : b.Pg.appendChild(e)
        };
        t.Ra = function () { this.h().e(this.eA, "click", function () { this.qa ? ox(this, 0) : px(this) }).e(this.vT, "click", function () { Y.V({ type: "ga_click_add_collection" }); ox(this, 1) }).e(this.dv, "click", function () { px(this) }).e(this.wT, "click", function () { Y.V({ type: "ga_click_add_collection" }); ox(this, 1) }).e(this.aL, "click", function () { px(this) }).e(this.Aq, "click", function () { px(this) }).e(this.rB, "click", this.nf).e(this.Pg, "click", this.UQ).e(this.zj, "change", function () { Q(this.sA, m) }) };
        t.UQ = function (b) { var c = Jc(b.target, "A"); if (c && !this.locked) { var b = c.getAttribute("data-lid"), d = m; E.has(c, "zm-favo-list-item-link-active") ? (d = j, this.HC = b) : this.CC = b; c = new Lk; c.add("answer_id", this.qa); c.add("favlist_id", b); this.zz = new V(j); this.locked = j; P(this.h(), this.zz, "complete", this.XJ); this.zz.ajax(d ? "/collection/remove" : "/collection/add", c.Kc()) } };
        t.XJ = function () { this.locked = m; this.dv.innerHTML = "关闭"; var b = Ie(this.zz); b && !b.r ? (b = Wb("zm-favo-list-item-link", this.Pg), z.forEach(b, function (b) { var d = b.getAttribute("data-lid"), e = J("num", b), g = parseInt(e.innerHTML, 10); d === this.HC ? (e.innerHTML = g - 1 + "", E.remove(b, "zm-favo-list-item-link-active")) : d === this.CC && (e.innerHTML = g + 1 + "", E.add(b, "zm-favo-list-item-link-active")) }, this), this.CC = this.HC = k, Ok("Favorite", "add_favorite")) : U("添加失败: " + b.msg) };
        a.qx = function (b, c) { if (b.qa !== c && b.Pg) { var d = Wb("zm-favo-list-item-link", b.Pg); z.forEach(d, function (b) { E.remove(b, "zm-favo-list-item-link-active") }, b) } b.qa = c }; t.show = function (b) { b || (nx(this, "添加到收藏夹", '<div style="text-align: center; color: #999;">收藏夹加载中<i class="spinner-gray"></i></div>'), this.U.F(j), this.qr()); this.iy && (this.dv.innerHTML = "关闭", this.qa ? (Q(this.Aq, m), ox(this, 0)) : (ox(this, 1), Q(this.eA, m), this.Aq.innerHTML = "取消")) };
        a.tx = function (b, c, d, e) { var g = H("zh-fav-head-title"), h = H("zh-fav-head-description-source"), c = c || (g ? Gc(g) : ""), d = d || (h ? Gc(h) : ""); b.GC = e || jh; b.cD ? rx(b) : b.w(); b.iy = j; b.Ra(); ox(b, 1); Q(b.eA, m); b.Aq.innerHTML = "取消"; b.rB.innerHTML = "保存"; b.U.ab("编辑收藏夹"); b.zj.value = Za(c); b.Hl.value = Za(d); b.GC[1] ? (Q(b.UR, m), Q(b.RR, m), Q(b.mP, m)) : b.aP.setAttribute("checked", j); b.DO = sx(b); b.U.F(j); b.$r = j }; t.qr = function () { this.qa && !this.iy && $.get("/collections/json", { answer_id: this.qa }).done(v(this.IQ, this)) };
        a.rx = function (b) { var c = Wb("zm-favo-list-item-link", b.Pg); z.forEach(c, function (b) { var c = b.getAttribute("data-lid"); E.remove(b, "zm-favo-list-item-link-active"); z.contains(this.os, +c) && E.add(b, "zm-favo-list-item-link-active") }, b) }; t.IQ = function (b) { b && !b.r && (this.Wx = b.msg[0], this.os = b.msg[1], this.cD ? rx(this) : this.w(), this.iy = j, this.Ra(), this.show(j)) };
        a.ox = function (b, c) { var d = !!c; b.U.ab(0 === c ? "添加到收藏夹" : "创建新收藏夹"); Q(b.yj, !d); Q(b.iw, d); new Tl(b.zj, b.tA); new Tl(b.Hl, b.xv); if (1 === c) $(b.iw).on("change.FavoDiag", "input, textarea, select", function () { b.Od() }); else $(b.iw).off("change.FavoDiag"), b.ue() }, a.sx = function (b) { var c = new Lk, d = Bk(b.zj.value), e = Va(b.Hl.value === b.xv ? "" : b.Hl.value); e || (e = -1); c.add("title", d); c.add("description", e); c.add("is_public", b.bP.checked ? 1 : 0); return c };
        t.nf = function () { var b = Bk(this.zj.value); if (!b || b === this.tA) Q(this.sA, j); else { b = sx(this); this.qa && b.add("answer_id", this.qa); if (this.$r) { if (this.DO.Kc() === b.Kc()) { px(this); return } b.add("favlist_id", this.GC[0]) } this.xhr = new V(j); P(this.h(), this.xhr, "complete", this.HJ); this.xhr.ajax(this.$r ? "/collection/update" : "/collection/create", b.Kc()) } };
        t.HJ = function () { var b = Ie(this.xhr); b && !b.r ? this.$r ? (px(this), U("编辑成功"), setTimeout(function () { window.location.reload() }, 1E3), this.$r = m) : this.qa ? (Q(this.uu, m), Q(this.tB, j), ox(this, 0), this.os.push(b.msg[0]), mx(this, b.msg, j), this.zj.value = "", this.Hl.value = "") : (px(this), U("创建成功"), setTimeout(function () { window.location.href = "/collections/mine" }, 1E3)) : U(b.msg) }; t.S = function () { return this.U.S() };
        a.px = function (b) { b.U.F(m); b.dispatchEvent(ux); Y.V({ type: "ga_click_collect_answer", data: { count: $(".zm-favo-list-item-link-active", b.Pg).length } }) }, a.ux = "close"; jx.prototype.Od = function () { $(window).on("beforeunload.FavoDiag", v(s("你对收藏夹的修改还未保存，确认离开该页面吗？"), this)) }; jx.prototype.ue = function () { $(window).off("beforeunload.FavoDiag") }; a.vx = function (b) { var c = b.type; if (!la(c)) return k; switch (c.toLowerCase()) { case "checkbox": case "radio": return b.checked ? b.value : k; case "select-one": return c = b.selectedIndex, 0 <= c ? b.options[c].value : k; case "select-multiple": for (var c = [], d, e = 0; d = b.options[e]; e++) d.selected && c.push(d.value); return c.length ? c : k; default: return la(b.value) ? b.value : k } }, a.wx = function (b, c) { var d = b.elements[c]; if (d.type) return vx(d); for (var e = 0; e < d.length; e++) { var g = vx(d[e]); if (g) return g } return k }; a.xx = function () { T.call(this) }; y(xx, T); xx.prototype.ea = function (b) { xx.n.ea.call(this, b); this.h().e(Y, "sina_callback", this.Gs); this.h().e(Y, "qqconn_callback", this.Gs); this.h().e(H("zh-setting-page-bind-sina-unbindbtn"), "click", this.wG); this.h().e(H("zh-setting-page-bind-qqconn-unbindbtn"), "click", this.wG) };
        xx.prototype.Gs = function (b) { if ("sina_callback" === b.type) { var c = sh.name = b.pc.name, b = sh.id = b.pc.id; H("zh-setting-page-bind-sinaname").innerHTML = '<a href="http://weibo.com/' + b + '" target="_blank">@' + c + "</a>"; yx(j) } else "qqconn_callback" === b.type && (H("zh-setting-page-bind-qqconnname").innerHTML = b.pc.name, zx(j)) };
        xx.prototype.wG = function (b) { var c = b.target.getAttribute("data-weibotype"); if (window.confirm("你确定要解除与" + { sina: "新浪微博", qqconn: " QQ " }[c] + "的绑定吗？")) { var d = new V(j); P(this.h(), d, "success", function () { var b = Ie(d); b && !b.r ? "sina" === c ? yx() : "qqconn" === c && zx() : U(b.msg) }); d.ajax("/oauth/unbind/" + c) } };
        a.yx = function (b) { Q(H("zh-setting-page-bind-sina-binded-wrap"), !!b); Q(H("zh-setting-page-bind-sina-tobind-wrap"), !b) }, a.zx = function (b) { Q(H("zh-setting-page-bind-qqconn-binded-wrap"), !!b); Q(H("zh-setting-page-bind-qqconn-tobind-wrap"), !b) }; a.Ax = function () { T.call(this) }; y(Ax, T); t = Ax.prototype;
        t.ea = function (b) {
            Ax.n.ea.call(this, b); if (b = J("profile-edit-avatar-btn")) this.Jm = new Ql(Pl), this.Jm.o(b), this.h().e(this.Jm, "beforepost", function () { $(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>")) }), this.h().e(this.Jm, "success", function (b) { $("img.zm-avatar-editor-preview").attr("src", b.src); $(".avatar-edit-preview-loading").remove() }); this.O = []; var c = this; $(".editable-group", this.g).each(function () { var b = new Rm; c.O.push(b); b.o(this) });
            b = H("zm-profile-edit-submit"); this.h().e(b, "click", this.Hy); (new xx).o(this.g); $(this.g).on("change", "input, textarea, select", function () { c.Od() })
        };
        t.C = function () {
            Ax.n.C.call(this); var b = H("zm-profile-progress-anim"), c = new Bx; c.addEventListener("update", function () { var d = 100 * c.X() | 0; 10 > d && (d = 10); b.style.width = b.innerHTML = d + "%" }); z.forEach(this.O, function (b, d) { c.watch({ name: "name" + d, target: b, Hh: ["add", "remove"], yh: function () { return !!b.td.children().length } }) }, this); var d = this.g, e = H("zm-profile-edit-male"), g = H("zm-profile-edit-female"), h = H("zm-profile-edit-description"), l = $(".business-selection select")[0], n = H("zm-profile-edit-expert-disable");
            c.watch({ name: "expert_progress", target: H("zm-profile-edit-expert-enable"), Hh: ["change"], yh: function () { return k !== wx(d, "enable_expert") } }).watch({ name: "expert_progress", target: n, Hh: ["change"], yh: function () { return k !== wx(d, "enable_expert") } }).watch({ name: "gender_progress", target: e, Hh: ["change"], yh: function () { return k !== wx(d, "gender") } }).watch({ name: "gender_progress", target: g, Hh: ["change"], yh: function () { return k !== wx(d, "gender") } }).watch({ name: "desc_progress", target: h, Hh: ["blur"], yh: function () { return !!La(h.value) } }).watch({
                name: "business_progress",
                target: h, Hh: ["blur"], yh: function () { return !!La(h.value) }
            }).watch({ name: "headline_progress", target: l, Hh: ["blur"], yh: function () { return !!La(l.value) } })
        }; t.Od = function () { $(window).on("beforeunload.profileedit", v(s("你的更改还未保存，确认离开该页面吗？"), this)) }; t.ue = function () { $(window).off("beforeunload.profileedit") };
        t.Hy = function () {
            function b(b) { U(ma(b) ? b[0][1] : b) } var c = $("#zm-profile-edit-male").is(":checked") ? 1 : 0, d = $("#zm-profile-edit-headline").val(), e = $("#zm-profile-edit-description").val(), g = $(".business-selection select").val(), h = []; $("#zm-profile-edit-loc-container").children().each(function () { h.push($(this).data("title")) }); var l = []; $("#zm-profile-edit-co-container").children().each(function () { var b = $(this); l.push([b.data("title"), b.data("sub-title") || ""]) }); var n = []; $("#zm-profile-edit-edu-container").children().each(function () {
                var b =
                $(this); n.push([b.data("title"), b.data("sub-title") || ""])
            }); var q = $("#zm-profile-edit-weibo-enable").is(":checked") ? 1 : 0, r = $("#zm-profile-edit-expert-enable").is(":checked") ? 1 : 0, c = F.filter({ avatar_path: this.Jm ? this.Jm.getData() : k, gender: c, headline: d, description: e, location: h, business: g, employment: l, education: n, enable_weibo: q, enable_expert: r }, et), w = v(function () { this.ue(); window.location.href = "/people/" + S[1] + "/about" }, this), d = new V(j); d.addEventListener("complete", function () {
                var c; try { c = Ie(this) } catch (d) { } c &&
                !c.r && qa(w) ? w.call(this, c) : qa(b) && b.call(this, c.msg)
            }); d.ajax("/people/edit", "data=" + encodeURIComponent($c(c)))
        }; a.Bx = function () { this.Vy = {} }; y(Bx, Hd); Bx.prototype.update = function (b, c) { this.Vy[b] = c; this.dispatchEvent({ type: "update" }); return this }; Bx.prototype.watch = function (b) { var c = v(function () { this.update(b.name, b.yh()) }, this); N(b.target, b.Hh, c); c(); return this }; Bx.prototype.X = function () { var b = F.La(this.Vy); return b.length && z.filter(b, Boolean).length / b.length }; a.Cx = function () { this.Ui = "editing"; T.call(this) }; y(Cx, T); Cx.prototype.ea = function (b) { Cx.n.ea.call(this, b); this.K = $(b); this.K.on("click", 'a[href^="javascript"]', $.proxy(this.ka, this)); this.K.on("click", 'a[href^="javascript"], input', m); this.K.on("click", ".item", $.proxy(this.rR, this)) }; a.Dx = function (b, c, d) { if (!ch.Ac || navigator.userAgent.match(/iPad/i) != k) b = $(".item", b.K).index(c), c.siblings().eq(b - b % 2).height(d ? "auto" : c.height()) };
        Cx.prototype.rR = function (b) { var c = $(b.currentTarget), d = c.data("href"), c = d && !c.hasClass(this.Ui), b = b.metaKey || b.ctrlKey; c && (b ? window.open(d) : location.href = d) };
        Cx.prototype.ka = function (b) {
            var c = $(b.currentTarget), d = c.closest(".item"), b = c.attr("name"); if ("edit" === b) c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.Ui).closest(".skilled-topics").addClass(this.Ui), Dx(this, d); else if ("cancel" === b) c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.Ui).closest(".skilled-topics").removeClass(this.Ui), Dx(this, d, j); else if ("save" === b) {
                var e =
                new V(j); this.h().e(e, "success", function () { var b = Ie(e); b.r ? U(b.msg) : (c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.Ui).closest(".skilled-topics").removeClass(this.Ui), Dx(this, d, j)) }); e.ajax("/topic/bio/update", "tid=" + c.closest(".item").data("id") + "&bio=" + c.parent().siblings("input").val(), "POST")
            }
        }; a.Fx = function () { T.call(this) }; y(Fx, T);
        Fx.prototype.ea = function (b) {
            Fx.n.ea.call(this); if (b && (this.K = $(b), $(".editable-group", this.K).each(function () { (new Gx).o(this) }), (b = H("profile-header-description-input")) && new Io(b), (b = J("zm-profile-header-avatar-container")) && E.has(b, "self"))) {
                var c = new Ql(Pl); c.o(b); this.h().e(c, "beforepost", function () { $(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>")) }); this.h().e(c, "success", function (b) {
                    b.src && (J("zm-avatar-editor-preview").src = b.src,
                    bu("ProfileHeaderV2", "save", { data: { avatar_path: c.getData() } }, function () { $(".avatar-edit-preview-loading").remove() }))
                })
            }
        }; a.Gx = function () { T.call(this) }; y(Gx, T); t = Gx.prototype; t.ea = function (b) { Gx.n.ea.call(this); this.K = $(b); this.fe = $(".info-wrap", this.K); this.Id = $(".edit-wrap", this.K); this.KU = $(".title", this.fe); this.JU = $("input", this.Id) };
        t.C = function () {
            Gx.n.C.call(this); this.K.on("click", "[name='edit']", $.proxy(function () { this.K.addClass("editing"); var b = this.Id.find("input").get(0); b ? b.focus() : (b = this.Id.find("textarea").get(0)) && b.focus() }, this)); var b = this; this.Vp = []; $("input[type=text]", this.K).each(function () { var c = new Sm("/topic/autocomplete", this, $(this).parents(".topic-input-wrap")[0]); b.Vp.push(c) }); this.Id.on("keydown", "input", function (b) {
                13 === b.keyCode && setTimeout(function () {
                    var c = $(b.target), g = c.parents(".edit-wrap").children().index(c.parent()),
                    h = c.parents(".edit-wrap").find("input, select").get(g + 1), g = c.parents(".edit-wrap").find("input, select").get(g - 1); c.val() && (h ? h.focus() : g && !$(g).val() && g.focus())
                })
            }); this.Id.on("click", "[name='cancel'], [name='save']", $.proxy(function (b) { b = b.target.name; "cancel" === b ? this.cancel() : "save" === b && this.save() }, this)); var c = $(".fold-wrap"); c.click(function (b) { "fold" === b.target.name ? c.addClass("fold") : "unfold" === b.target.name && c.removeClass("fold") })
        };
        t.save = function () {
            var b = this.K.data("name"); if ("location" === b) {
                var b = this.Id.find("input.location"), c = this.Id.find("select"), d = this.Id.find("input.male").is(":checked") ? 1 : 0; bu("ProfileHeaderV2", "save", { data: { location: [b.val()], business: c.val(), gender: d } }, function (b) {
                    b = b.msg; b.location[0].html || (b.location[0].html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>"); b.business.html || (b.business.html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>");
                    this.fe.find("span.location").attr("title", b.location[0].text).html(b.location[0].html); this.fe.find("span.business").attr("title", b.business.text).html(b.business.html); this.fe.find("i.gender").removeClass("male female").addClass(1 === parseInt(b.gender, 10) ? "male" : "female"); this.cancel()
                }, this.ai, this)
            } else "employment" === b ? (c = this.Id.find("input.employment"), b = this.Id.find("input.position"), c = c.val(), b = b.val(), bu("ProfileHeaderV2", "save", { data: { employment: [[c, b]] } }, function (b) {
                b = b.msg; !b.employment[0][0].text &&
                !b.employment[0][1].text ? this.K.addClass("empty") : this.K.removeClass("empty"); b.employment[0][0].html || (b.employment[0][0].html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>"); b.employment[0][1].html || (b.employment[0][1].html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>"); this.fe.find(".employment").attr("title", b.employment[0][0].text).html(b.employment[0][0].html); this.fe.find(".position").attr("title", b.employment[0][1].text).html(b.employment[0][1].html);
                this.cancel()
            }, this.ai, this)) : "education" === b ? (c = [this.Id.find("input.education"), this.Id.find("input.education-extra")], b = c[0].val(), c = c[1].val(), bu("ProfileHeaderV2", "save", { data: { education: [[b, c]] } }, function (b) {
                b = b.msg; !b.education[0][0].text && !b.education[0][1].text ? this.K.addClass("empty") : this.K.removeClass("empty"); b.education[0][0].html || (b.education[0][0].html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>"); b.education[0][1].html || (b.education[0][1].html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>");
                this.fe.find(".education").attr("title", b.education[0][0].text).html(b.education[0][0].html); this.fe.find(".education-extra").attr("title", b.education[0][1].text).html(b.education[0][1].html); this.cancel()
            }, this.ai, this)) : "description" === b && (b = this.Id.find("textarea.description"), bu("ProfileHeaderV2", "save", { data: { description: b.val() } }, function (b) {
                b = b.msg; b.description.text ? this.K.removeClass("empty") : (b.description.fold_html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",
                b.description.unfold_html = "<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>", this.K.addClass("empty")); this.fe.find(".fold-item .content").empty().html(b.description.fold_html); this.fe.find(".unfold-item .content").html(b.description.unfold_html); b.description.shortened ? this.fe.removeClass("disable-fold") : this.fe.addClass("disable-fold"); this.cancel()
            }, this.ai, this))
        }; t.ai = function (b) { U(b.msg) }; t.cancel = function () { this.K.removeClass("editing") }; a.Hx = function () { M.call(this); this.Mg = "zm-item"; this.sX = "zm-item-top-btn"; this.GS = j }; y(Hx, yn); t = Hx.prototype; t.B = function (b) { this.Xb = b; this.h().e(b, "click", this.ka); this.refresh() }; t.Yg = ca("Mg");
        t.ka = function (b) { if (b.target) { var c = Kk(this.Xb, b.target); c && (this.type = c.getAttribute("data-type"), this.id = c.getAttribute("data-id"), this.action = c.name, this.item = Jc(b.target, k, this.Mg), this.type && (this.id && this.action && this.item) && (this.JI || (this.JI = j, this.xhr = new V(j), this.h().e(this.xhr, "complete", this.mf), this.xhr.ajax("/people/" + ("top" === this.action ? "pin" : "unpin") + "_" + this.type, this.type + "_id=" + this.id, "POST")), this.qX = c)) } };
        t.mf = function () { if ("cancel-top" === this.action) bj(this.item, j); else if ("top" === this.action) { var b = Wb(this.Mg, this.Xb); this.YY = dg(this.item).y; b && 2 <= b.length && kc(L(this.item), J(this.Mg, this.Xb)); this.scroll(); Gk(this.item); Q(J("zm-item-top-btn-top", this.item), m); Q(J("zm-item-top-btn-cancel", this.item), j); this.refresh() } this.JI = m }; t.scroll = function () { if (this.GS) { var b = J("zm-profile-section-wrap"), c = Mc(Tb((fa || window).document)).y; b && 0 > dg(b).y - c && b.scrollIntoView() } };
        t.refresh = function () { var b = Wb(this.Mg, this.Xb); b && 0 < b.length && z.forEach(b, function (b, d) { if (0 !== d) { var e = J("zm-item-top-btn-top", b); e && Q(e, j) } }, this) }; a.Ix = function (b, c) { b.h().e(c, "next", b.refresh) }; a.Jx = function () { this.fw = ["zg-btn-follow", "zg-btn-unfollow"]; this.gw = "people" }; y(Jx, T); Jx.prototype.C = function () { this.h().e(this.g, "click", this.ka) }; Jx.prototype.ka = function (b) { var c = Kk(this.g, b.target); this.Ym && this.Ym(c); c && (c.name && "focus" === c.name) && on(c, this.gw, function () { c.getAttribute("data-followme") && (E.has(c, "zg-btn-follow") ? c.setAttribute("data-tip", "s$b$对方已关注你") : c.setAttribute("data-tip", "s$b$已互相关注")) }, this.fw, { XX: "question" === this.gw ? "关注问题" : k }) }; Jx.prototype.Cz = ca("Ym"); a.Lx = function (b, c, d, e) { M.call(this); this.Nd = b; this.Dh = c; this.Sg = d; this.$C = e || Kx; b.maxLength = d; this.qj = new dv(b); N(this.qj, "input", this.uo, m, this); this.Gi() }; y(Lx, Hd); a.Kx = 0; Lx.prototype.uo = function () { this.Gi() }; Lx.prototype.Gi = function () { var b = this.Nd.value.length; if (b > this.Sg) { var c = this.Nd.scrollTop, d = this.Nd.scrollLeft; this.Nd.value = this.Nd.value.substring(0, this.Sg); b = this.Sg; this.Nd.scrollTop = c; this.Nd.scrollLeft = d } this.Dh && yc(this.Dh, 1 == this.$C ? b : this.Sg - b) };
        Lx.prototype.z = function () { Lx.n.z.call(this); delete this.Nd; this.qj.H(); this.qj = k }; a.Mx = function (b) { M.call(this); this.U = k; this.la = b; this.jt = 0; this.QG = "" }, a.Nx = void 0; y(Mx, yn); t = Mx.prototype; t.B = function () { this.El || (this.El = j, this.w(), this.Ra()) }; t.Ra = function () { A || (new Co("搜索问题")).o(this.Oc); this.O = new Oo("/redirect-question/autocomplete", this.Oc, k, k, H("zh-question-redirect-diag-content"), m); this.O.Hm = m; this.O.dg(j); this.h().e(this.O, nm.ph.xi, Wk); this.h().e(this.O, "select", this.VQ).e(this.HK, "click", function () { this.U.F(m) }) };
        t.VQ = function () { var b = this.O.Fg(); if ("search_link" === b[0]) window.open("/search?q=" + encodeURIComponent(b[1]) + "&type=question"); else { this.Oc.value = ""; var c = b[3], b = b[1]; this.U.F(m); this.Oc.value = ""; this.xhr = new V(j); P(this.h(), this.xhr, "complete", this.YJ); this.xhr.ajax("/question/redirect", "qid=" + this.la + "&rqid=" + c); this.jt = c; this.QG = b } }; t.YJ = function () { var b = Ie(this.xhr); b && (b.r ? U(b.msg) : this.mb ? (this.mb.innerHTML = "已经重定向", this.mb.setAttribute("data-disabled", 1)) : this.dispatchEvent("change")) };
        t.w = function () { this.g = K("div", { id: "zh-question-redirect-diag" }, ["将问题跳转至", K("div", { id: "zh-question-redirect-diag-content" }, this.Oc = K("input", { type: "text", "class": "zg-form-text-input" })), K("div", "zm-command", this.HK = K("a", { href: "javascript:;", "class": "zm-command-cancel", name: "cancel" }, "放弃操作"))]); this.U = new zi(k, m); this.U.ab("问题重定向"); ii(this.U, k); this.U.Z().appendChild(this.g) }; t.show = function () { this.B(); this.U.F(j) }; a.Ox = {}, a.Ox = function () { M.call(this) }; y(Ox, yn); Ox.lu = [["需要详细阐述", "答案过于简短或表述不清晰，请完善答案。"], ["答非所问", "没有正面或直接回答问题，请修改答案。"], ["应作为问题的评论", "该内容是对问题本身的评论而不是回答，请改为发布到评论。"], ["应作为答案的评论", "该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"], ["内容重复", "与已有答案重复，请修改答案。"], ["内容已过期", "答案的时效性已过，请更新答案。"], ["需要注明关联利益", "有广告、推销嫌疑，请注明作者与利益方的关系。"]]; Ox.rj = k; Ox.T = function () { Ox.rj || (Ox.rj = new Ox, Ox.rj.B()); return Ox.rj }; t = Ox.prototype;
        t.B = function () { if (!this.g) { this.w(); this.Ra(); var b = new Zn(this.g); Th(b); b.wE = j; b.So(j); b.F(m); b.$y = 0; b.S() && b.ma(); Ys(b, new Of(13, 0, 0, -22)); this.Zy = b } }; t.Ra = function () { this.h().e(this.g, "click", this.TQ) }; t.TQ = function (b) { "A" === b.target.tagName && (b = b.target.getAttribute("data-index"), this.xL.WX(b), this.Zy.F(m)) };
        t.w = function () {
            var b = K("div", { id: "zh-answer-flag-popup", "class": "zg-r5px zu-hovercard-wrap" }, [K("div", "zg-r5px zu-hovercard-inner", [K("div", { id: "zh-answer-flag-popup-header" }, [K("a", { "class": "zg-right", href: "http://www.zhihu.com/question/19867017", target: "_blank" }, "这是什么？"), "选择一个理由："]), this.zG = K("div", { id: "zh-answer-flog-options-wrap" })]), K("div", "zu-hovercard-spin-top")]); z.forEach(Ox.lu, function (b, d) {
                var e = K("a", { href: "javascript:;", "class": "zm-menu-item-link" }, b[0]); e.setAttribute("data-index",
                d); this.zG.appendChild(e)
            }, this); document.body.appendChild(b); this.g = b
        }; t.show = function (b, c) { this.Zy.ad(new Xn(b, 1)); var d = c.dY(), e = Wb("zm-menu-item-link", this.zG); z.forEach(e, function (b, c) { Q(b, !z.contains(d, c)) }, this); this.Zy.F(j); this.xL = c }; a.Px = function () { M.call(this) }, a.Qx = void 0; y(Px, yn);
        Px.prototype.B = function () { this.w(); this.h().e(this.el, "change", function () { var b = this.el.value; this.gz.value = "no" === b ? "" : Ox.lu[+b][1] }).e(this.Hi, "click", function (b) { "cancel" === b.target.name ? this.U.F(m) : this.gz.value && "no" !== this.el.value && (this.bw = new V(j), this.h().e(this.bw, "complete", function () { var b = Ie(this.bw); b && !b.r ? (this.mb.innerHTML = "已经标记", this.U.F(m)) : U(b.msg) }), b = Bk(this.gz.value), this.bw.ajax("/answer/flag", "answer_id=" + this.AJ + "&flag=" + this.el.value + "&reason=" + encodeURIComponent(b))) }) };
        Px.prototype.w = function () {
            this.g = K("div", k, [K("div", "zg-section", [K("div", k, "标记："), this.el = K("select")]), K("div", k, [K("div", k, "原因"), this.gz = K("textarea", { style: "width:96%;border:solid 1px #666;height:66px;padding:5px" })]), this.Hi = K("div", "zm-command", [K("a", { "class": "zg-mr10", href: "javascript:void(0);", name: "cancel" }, "取消"), K("a", { "class": "zg-btn-blue", href: "javascript:void(0);", name: "confirm" }, "确定")])]); this.el.appendChild(K("option", { value: "no" }, "选择标记原因")); z.forEach(Ox.lu, function (b, c) {
                this.el.appendChild(K("option",
                { value: c }, b[0]))
            }, this); this.U = new zi(k, m); this.U.ab("标记答案"); ii(this.U, k); this.U.Z().appendChild(this.g)
        }; Px.prototype.show = function () { this.U.F(j) }; a.Rx = function (b) {
            var c = b && b.name; if (c) switch (c) {
                case "adminflag": Qx || (Qx = new Px, Qx.B()); c = Qx; c.mb = b; c.AJ = b.id.split("-")[1]; c.show(); break; case "redirect": case "cancel_redirect": if (!b.getAttribute("data-disabled")) { var d; Nx || (Nx = new Mx, Nx.B()); d = Nx; d.mb = b; d.la = b.id.split("-")[1]; "redirect" === c ? d.show() : (Gi("/question/unredirect", k, "POST", "qid=" + d.la + "&rqid=" + d.jt), d.mb.innerHTML = "重定向已撤销", d.mb.setAttribute("data-disabled", 1)) } break; case "revert": var e = Di("撤销", '<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
                function (c) { if (c) { var c = g.value, d = b.getAttribute("id").split("-")[1], c = (new kj).add("revision", d).add("reason", c), n = new V(j); n.on("success", function () { var b = Ie(n); b.r ? U(b.msg) : (e.F(m), b.msg ? window.location.href = b.msg : location.reload()) }); n.ajax("/revert", c.toString()); return m } }), g = J("content", e.Z()); new Tl(g); new Io(g, 48); new Lx(g, k, 200)
            }
        }, a.Sx = function (b) { $(b).on("click", 'a[name="revert"]', function () { Rx(this) }) }; a.Tx = function () { T.call(this) }; y(Tx, T); t = Tx.prototype; t.B = function () { zs.J(this); this.o(document.body) };
        t.C = function () {
            Tx.n.C.call(this); var b = J("zm-profile-header-operation"); b && (new Jx).o(b); (b = J("zm-profile-header")) && (new Fx).o(b); (b = H("zh-profile-activity-wrap")) && this.h().e(b, "click", function (b) { if ((b = b.target) && "focus" === b.name) { var c = b.getAttribute("data-type"); on(b, c, k, ["zm-profile-follow-link-gray", "zm-profile-unfollow-link-gray"]) } }); (this.hw = b = H("zh-profile-page-force-to-rename")) && this.h().e(b, "click", this.XT); this.sx(); if (b = H("zh-profile-activity-page-list")) {
                var c = new Bu({
                    pa: ["expandLimit"],
                    bh: j
                }); c.pa("locationSource", { url: "/people/" + ih[1] + "/activities", ms: 10, Do: j }); c.pa("childConstructor", { factory: hx }); this.J(c); c.o(b); this.h().e(c, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("category", "profile").fill("label", "profile_feed") })
            } (b = J("zm-profile-fav-wrap")) && this.h().e(b, "click", this.eM); (b = H("zm-profile-details-editform")) && (new Ax).o(b); if (b = J("zm-profile-answer-sort")) this.sh = new Ru, this.sh.Ga(this.kK = new Ou("按时间排序")), this.sh.Ga(this.lK = new Ou("按投票排序")), this.sh.Ga(this.jK =
            new Ou("问" + S[0] + "的问题")), this.sh.Y(b), this.sh.F(m), this.h().e(b, "click", function (b) { this.sh.F(j); b.stopPropagation(); P(this.h(), document, "click", function () { this.sh.F(m) }) }), this.h().e(this.sh, "action", this.ON); (b = H("zh-profile-edit-expert")) && (new Ux).o(b); var d = J("profile-expert-tip"); d && this.h().e(d, "click", function (b) { var c = b.target; ("enable" === c.name || "close" === c.name) && bu("ProfileExpertTopicsV2", c.name, k, function () { "enable" === c.name ? location.reload() : bj(d, j) }) }); $(".zm-profile-section-wrap.skilled-topics").each(function () { (new Cx).o(this) });
            $(".zm-profile-module.skilled-topics").each(function () { (new Cx).o(this) }); $(".zm-profile-module.active-topics").each(function () { (new Cx).o(this) }); if (c = H("zh-profile-ask-list")) if (b = new Bu({ pa: ["autoload", "locationSource"], bh: m }), this.J(b), b.o(c), c = J("zm-profile-section-list")) { var e = new Hx; e.Yg("zm-profile-section-item"); Ix(e, b); e.B(c) } if (c = $("#zh-profile-answer-list > .zh-general-list").get(0) || $("#zh-profile-answer-list").get(0)) if (b = new Bu({ bh: m }), this.J(b), b.pa("childConstructor", { Li: bx }).pa("expandLimit"),
            b.o(c), this.h().e(b, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("category", "profile").fill("label", "profile_answers_list") }), c = J("zm-profile-section-list")) e = new Hx, Ix(e, b), e.B(c); if (b = $("#zh-profile-log-list").get(0)) c = new Bu, c.pa("locationSource", { Do: j }), this.J(c), c.o(b), Sx(b); if (c = H("zh-profile-topic-list")) if (b = new Bu({ pa: ["autoload", "locationSource"] }), this.J(b), this.h().e(b, "itemcreated", function (b) {
            var b = b.item, c = b.getAttribute("data-tid").split("-")[1]; if (S[3] === ih[3]) {
            var d = new Qr(j,
            "/topic/bio/update", "bio"); d.Vt = j; d.params = ["tid=" + c]; d.yb = '<a href="javascript:;" name="edit">添加你在该话题的经验</a>'; d.o(b)
            }
            }), b.o(c), c = J("zm-profile-section-list")) e = new Hx, e.Yg("zm-profile-section-item"), Ix(e, b), e.B(c); if (b = $("#zh-profile-column-list > .zh-general-list").get(0)) c = new Bu({ pa: ["autoload", "nodeSource"] }), this.J(c), c.o(b); if (b = $("#zh-profile-follows-list > .zh-general-list").get(0)) c = new Bu({ pa: ["autoload", "nodeSource"] }), this.J(c), c.o(b); if (b = $("#zh-profile-follows-list-old").get(0)) c = new Bu({
                pa: ["autoload",
                "locationSource"]
            }), this.J(c), c.o(b); if (b = $("#zh-profile-fav-list > .zh-general-list").get(0)) c = new Bu({ pa: ["autoload", "nodeSource"], bh: m }), this.J(c), c.o(b); this.On(); -1 < location.search.indexOf("clean-followers-noti=1") && (new V(j)).ajax("/notification/clear", "no_refresh_content=true&type=follow"); $("#__signin").click(function () { kn(new hn, m) })
        }; t.XT = function () { Di("确定", "确定要强制此用户改名吗？", function (b) { b && (H("realname_form").submit(), this.hw.innerHTML = "已发送", E.add(this.hw, "zg-gray"), Cd(this.hw)) }, this) };
        t.On = function () { this.pj(); var b = H("zm-profile-header-pm-btn"); b && N(b, "click", mu(function (b) { b.preventDefault() }, mn(function () { var c = new Po; c.show(); To(c, ih[3], ih[0]); So(c, b.href); c.$b.focus() }, j))); var c = H("zh-profile-cancel-block"); c && this.h().e(c, "click", this.cG); (c = H("zh-report-people")) && this.h().e(c, "click", this.fH); (c = H("zh-profile-search-query-mirro")) && new Tl(c, c.getAttribute("placeholder")) };
        t.cG = function () { Di("确定取消屏蔽？", "取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。", function (b) { b && Vx(this, m) }, this) }; t.Hk = function () { P(this.h(), document, "click", function () { this.fb.F(m) }) }; t.pj = function () { var b = H("profile-side-op"); b && this.h().e(b, "click", this.hj) }; t.ON = function (b) { var c = ""; b.target === this.kK ? c = "time" : b.target === this.lK ? c = "vote" : b.target === this.jK && (c = "ask"); location.href = "/people/" + S[1] + "/answers?sort=" + c };
        t.hj = function (b) { b = b.target.name; "block" === b ? Di("确定要屏蔽该用户？", "屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。", function (b) { b && Vx(this, j) }, this) : "report" === b ? this.fH() : "cancel-block" === b && this.cG() }; t.fH = function () { Eu("member", ih[3]) }; a.Vx = function (b, c) { var d = new V(j); P(b.h(), d, "complete", function () { window.location.reload() }); d.ajax("/people/" + ih[1] + "/block", "action=" + (c ? "add" : "cancel")) };
        t.eM = function (b) { if (b && b.target && (b = Kk(this.g, b.target))) { var c = J("zm-profile-fav-item-title", b), d = J("zm-profile-fav-item-des", b); c && d && "fav-edit" === b.name && (c = c.innerHTML, d = d.innerHTML || "", b = [Number(b.getAttribute("data-id")), Number(b.getAttribute("data-public"))], tx(lx(), c, d, b)) } };
        t.sx = function () {
            if (this.xz = H("zh-profile-search-form")) {
                var b = H("zh-profile-search-type"); b && this.h().e(b, "click", this.RQ); this.Xj = this.xz.getAttribute("data_type"); this.h().e(this.xz, "submit", this.search); N(window, "popstate", function (b) { var b = b.state, c; b && b.Ts && (c = H("zh-profile-search-query"), c.value = decodeURIComponent(b.Ts), Wx(this, b.type), this.search(i, m), c.focus()) }, m, this); var b = (new vf(location)).Kc().get("pq"), c = (new vf(location)).Kc().get("type"); c || (c = "all"); if (b && c) {
                    var d = H("zh-profile-search-info");
                    d && Q(d, j); Wx(this, c); H("zh-profile-search-query").value = b; this.search(i, i, m)
                }
            }
        }; t.RQ = function (b) { if ((b = b.target) && b.name) Wx(this, b.name), this.search() }; a.Wx = function (b, c) { var d = Wb("zm-profile-search-type-item"); if (d) for (var e = 0; e < d.length; e++) E.remove(d[e], "current"), d[e].name === c && E.add(d[e], "current"); b.Xj = c };
        t.search = function (b, c, d) {
            this.Ke = H("zh-profile-search-query").value; this.fm = "/people/" + H("zh-profile-search-form").getAttribute("data_url") + "/search"; if (this.Ke) {
                c === i && (c = j); d === i && (d = j); if (window.history.pushState) {
                    if (this.yz) return; b && b.preventDefault(); this.gm = new V(j); this.yz = j; this.h().e(this.gm, "complete", this.II); c && window.history.pushState({ Ts: encodeURIComponent(this.Ke), type: this.Xj }, "", "?pq=" + encodeURIComponent(this.Ke) + "&type=" + this.Xj); this.gm.ajax(this.fm, "type=" + this.Xj + "&pq=" + encodeURIComponent(this.Ke),
                    "", "POST")
                } else b || (d ? (this.Ke = H("zh-profile-search-query").value, this.fm = "/people/" + H("zh-profile-search-form").getAttribute("data_url") + "/search", window.location.href = this.fm + "?type=" + this.Xj + "&pq=" + encodeURIComponent(this.Ke)) : (this.gm = new V(j), this.yz = j, this.h().e(this.gm, "success", this.II), this.Ke = H("zh-profile-search-query").value, this.fm = "/people/" + H("zh-profile-search-form").getAttribute("data_url") + "/search", this.gm.ajax(this.fm, "type=" + this.Xj + "&pq=" + encodeURIComponent(this.Ke), "", "POST")));
                (b = H("zh-profile-search-info")) && Q(b, j)
            } else b && b.preventDefault()
        };
        t.II = function () {
            this.yz = m; yc(H("zh-profile-search-word"), this.Ke); var b = Ie(this.gm); if (b && !b.r) {
                var c = H("zh-profile-search-list"); if (c) if (0 === b.msg[0]) H("zh-profile-list-container").innerHTML = '<div id="' + c.id + '"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>'; else {
                    var d; d = "" + ('<div id="' + c.id + '">'); d += b.msg[1] + "</div>"; H("zh-profile-list-container").innerHTML = d + '<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>'; if ((b = Wb("zm-item",
                    c)) && b.length) this.dh = b[b.length - 1].id.split("-")[1]; this.Pa = k; this.Pa = new ix(H(c.id), k, j); this.Pa.B(); this.Pa.dh = this.dh; this.Pa.url = this.fm; this.Pa.params.pq = this.Ke; this.Pa.params.type = this.Xj; H("zh-profile-search-query").focus()
                }
            }
        }; a.Ux = function () { T.call(this) }; y(Ux, T);
        Ux.prototype.ea = function (b) { this.g = b; this.Oa = new Dt; this.Oa.o(this.g); this.form = H("zm-profile-expert-editform"); this.h().e(this.form, "submit", this.Hy); this.h().e(this.Oa, ["add", "remove", "sort"], function () { this.Od() }); $(".enable").on("change", "input", $.proxy(function () { this.Od() }, this)); var c = H("zh-profile-expert-warning"); c && this.h().e(c, "click", function (b) { "close" === b.target.name && bj(c) }); $(".enable input[type='radio']").click(function (b) { Q(H("zh-profile-expert-reopen-tip"), !Number($(b.target).val())) }) };
        Ux.prototype.Od = function () { $(window).on("beforeunload.profile", v(s("你的更改还未保存，确认离开该页面吗？"), this)) }; Ux.prototype.ue = function () { $(window).off("beforeunload.profile") };
        Ux.prototype.Hy = function (b) { b.preventDefault(); z.map(this.Oa.data, function (b) { return b[3] }); var b = $(this.form).serializeArray()[0].value, c = $("#zh-expert-topics .item").map(function () { return $(this).data("url-token") }).get(); bu("ProfileEditExpertTopicsV2", "save", { settings: { enable_expert: b, expert_topic: c } }, function () { this.ue(); window.location.href = "/people/" + S[1] }, k, this) }; a.Xx = function (b, c, d, e, g) { Su.call(this, b, c, g); this.dw = d || "people"; this.lM = e || ["zg-follow", "zg-unfollow"] }; y(Xx, Su); Xx.prototype.B = function (b) { Xx.n.B.call(this, b); this.Ra(this.g) }; Xx.prototype.JA = ca("JA"); Xx.prototype.Ra = function (b) { if (this.JA) { var c = new Jx, d = this.lM; c.gw = this.dw; c.fw = d || c.fw; this.Ym && c.Cz(this.Ym); c.o(b) } }; Xx.prototype.Cz = ca("Ym"); a.Yx = function () { }; t = Yx.prototype; t.gB = { "lock-question": "block", "unlock-question": "unblock", "mute-question": "mute", "unmute-question": "unmute", "remove-question": "delete", "collapse-answer": "collapse", "uncollapse-answer": "uncollapse", "remove-answer": "delete" }; t.vw = ba(); t.ww = function (b) { var c = new kj(b), d = this.vw(); if (!d) return Nk("OP META DATA ELEMENT DOES NOT PROVIDED"); z.forEach(["question_id", "task_id", "answer_id", "none_queue"], function (b) { var g = d.getAttribute("data-" + b); g && c.add(b, g) }); return c };
        a.Zx = function (b, c) { var d = ww.fW[c]; if (d) { var e; e = []; (e = zc(b, function (b) { return 3 === b.nodeType && La(b.nodeValue) }, e, j) ? e[0] : i) && yc(e, b.getAttribute("data-label") || d.label); b.setAttribute("data-op", c) } else Nk("NO SUCH OP NAME") }; t.Cy = ba(); t.wM = yk(function () { var b = ww.T(); b.on("cancel", this.Cy, m, this); return b }); a.$x = function (b, c, d, e) { var g = c.getAttribute("data-op"); if (g) { Zx(c, g); var h = b.wM(), e = b.ww(e).add("action", b.gB[g]); h.mZ(c, v(d || ha, b), "", e.toString()); h.F(j) } }; a.ay = function (b) { this.Ed = 10; this.Wc = "搜索用户"; this.path = b || "/people/autocomplete" }; y(ay, yn); t = ay.prototype; t.w = function () { var b = K("div", "zg-section zm-tag-editor-command-buttons-wrap", [this.Qa = K("input", "zg-form-text-input zg-mr15"), this.tH = K("span", "zg-mr15"), this.nL = K("a", { "class": "zg-mr15 zg-btn-blue", href: "javascript:;", name: "add" }, "移交")]); this.g.appendChild(b); this.Wc && ((new Co(this.Wc)).o(this.Qa), this.Qa.title = this.Wc); this.gf(b); this.h().e(this.nL, "click", this.Co) };
        t.gf = function (b) { this.O = new Oo(this.path, this.Qa, k, k, b, j); this.O.dg(j); this.O.Vh = this.Ed; this.h().e(this.O, "select", this.NQ) }; t.Co = function () { this.Bz && this.dispatchEvent("select") }; t.NQ = function () { var b = this.O.Fg().slice(1); this.Bz = [b[3], b[0]]; this.tH.innerHTML = b[0] }; t.m = p("g"); t.o = function (b) { this.g = b; this.w() }; t.hide = function () { Q(this.g, m); this.Bz = k; this.tH.innerHTML = "" }; a.by = function (b, c, d, e, g, h) { Tr.call(this, e, c, d, h); this.la = b; this.Xn = this.Vj = m; this.uR = g }; y(by, Tr); a.cy = [{ value: "精简文字描述", label: "精简文字描述" }, { value: "补充必要的信息", label: "补充必要的信息" }, { value: "改进标点或格式", label: "改进标点或格式" }, { value: "other", label: "其他" }]; t = by.prototype; t.o = function (b) { by.n.o.call(this, b); this.h().e(Mi, "anon_change", this.ej) }; t.ej = function (b) { this.Xn || E.enable(this.g, "zm-editable-disabled", b.kb) };
        t.Ji = function () {
            by.n.Ji.call(this); var b = K("a", { "class": "zg-right zg-link-litblue", href: "http://www.zhihu.com/question/19550238/answer/12202028", target: "_blank" }, "为什么问题可以被公共编辑？"), c = K("select", { style: "1px solid #999 " }), d = K("option", { value: "none" }, "请选择一个修改理由..."); c.appendChild(d); z.forEach(cy, function (b, d) { var e = K("option", { value: b.value }, d + 1 + ". " + b.label); c.appendChild(e) }); this.hz = K("div", { "class": "zm-editable-require-reason-wrap", style: "padding:10px 0 0 0" }, [b, this.dZ = c, this.IF = K("span"), this.YR =
            K("div", { "class": "zg-form-text-input", style: "height:22px;margin:10px 0 0 0;display:none" }, this.XR = K("textarea", { style: "width:100%;height:22px !important;min-height:22px !important;" }))]); kc(this.hz, this.vd); this.Vj && this.ji(" * 必选", "zg-gray-normal"); var e = Vb("select", k, this.hz)[0]; this.h().e(e, "change", function () { Q(this.YR, "other" === e.value); this.ji(" * 必选", "zg-gray-normal") })
        };
        t.nf = function (b) { var c = Vb("select", k, this.hz)[0], d = c.value; if (this.Vj) { if ("none" === d) { this.ji("请选择一个修改理由"); return } if ("other" === c.value && (d = Bk(this.XR.value), !d)) { this.ji("请填写修改理由"); return } } "title" === this.Nq && -1 === b.indexOf("?") && -1 === b.indexOf("？") ? this.ji("还没有输入问号") : ("none" === d && (d = ""), this.params = ["id=" + this.la + "&reason=" + encodeURIComponent(d) + "&question_id=" + this.la], this.dispatchEvent("change"), by.n.nf.call(this, b), this.ji("* 必选", "zg-gray-normal"), this.Vj = j) };
        t.ji = function (b, c) { this.IF.innerHTML = b; E.set(this.IF, c || "zg-error-text") }; t.Nf = function () { return this.zd && this.uR ? Ck(Ia(this.Na.value)) : by.n.Nf.call(this) }; t.Od = function () { $(window).on("beforeunload.EditorWithReason", v(s("你对问题的修改还未保存，确认离开该页面吗？"), this)) }; t.ue = function () { $(window).off("beforeunload.EditorWithReason") }; t.eh = function () { by.n.eh.call(this); this.ue() }; t.qd = function () { by.n.qd.call(this); this.Od() }; a.dy = function () { M.call(this); this.WY = []; this.Xx = 0; this.wA = this.XY = k; this.PC = 5; this.cO = "/reviewq/handover" }; y(dy, yn); ya(dy.prototype, Yx.prototype); t = dy.prototype; t.vw = p("ba"); t.ww = function (b) { return Yx.prototype.ww.call(this, b).add("queue_id", this.Kb).add("is_realm", this.Xd) }; t.Cy = function () { this.locked = m };
        t.B = function (b) { this.g = b; this.Kb = (b = H("queue_id")) ? b.value : 0; this.Xd = (b = H("is_realm")) ? b.value : 0; this.w(); this.Ra(); iu.Zr || (b = new Jd(1E3 * this.PC), b.start(), this.h().e(b, Kd, this.nU)); H("zh-load-more") && (new Xx(this.g, window.location.href, "queue", ["zg-btn-follow", "zg-btn-unfollow"], j)).B(); this.h().e(this.g, "click", this.ka) }; t.ka = function (b) { this.Iw(b.target) };
        t.nU = function () { var b = Wb("zm-review-queue-deadline"); b && b.length && z.forEach(b, function (b) { var d = b.getAttribute("data-lefttime"); if (d) if (d = +d, 2E3 < d && (d -= Math.floor(+new Date / 1E3)), 0 >= d && -1E3 < d) b.innerHTML = "已流通"; else { 60 > d && E.add(b, "zm-review-queue-time-warning"); var e = Math.floor(d / 60), g = d % 60; b.setAttribute("data-lefttime", d - this.PC + ""); b.innerHTML = (0 < e ? e + "分" : "") + (g + "秒") } }, this) }; t.MJ = function () { ey(this, ["删除话题", "已删除"], ["delete_topic", ""]); this.vm(); iu.Zr || this.ba.setAttribute("data-lockdown") };
        t.Ew = u(49); t.SQ = function () { this.rH = this.Lj.Bz; this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax(this.cO + "?queue_id=" + this.Kb + "&is_realm=" + this.Xd, "action=assign&assigned_to=" + this.rH[0] + "&task_id=" + this.ba.getAttribute("data-task_id") + "&none_queue=" + this.ba.getAttribute("data-none_queue")) }; t.w = function () { this.Ln = H("zh-queue-new-info"); var b = K("div", { style: "display:none" }, this.gc = K("div", "zu-review-queue-topic-editor", K("div", "zm-tag-editor-labels"))); lc(b, this.g) };
        t.Ra = function () { iu.Zr || this.ak() }; t.ak = function () { this.dk = new V(m); P(this.h(), this.dk, "success", this.Vw); this.dk.ajax("/reviewq/sidebar?queue_id=" + this.Kb, k, "GET") }; t.Vw = function () { var b = Ie(this.dk); if (!b || !b.r) { var c = b.msg, b = Wb("zm-review-queue-live-udatable-num"); z.forEach(b, function (b) { var e = b.getAttribute("data-key"); e && (e = c[e], e || (b.innerHTML = e)) }); setTimeout(v(this.ak, this), 1E4) } }; t.SJ = function () { fy(this, this.mb, "已流通") };
        a.fy = function (b, c, d) { c = c || b.mb; d = d || "已处理"; E.remove(c, "zg-btn-white"); "pass" === c.name && (c.innerHTML = d, iu.Zr || (c.name = "")); b.ba = Jc(c, k, "zm-item"); b.vm(); (b = J("zm-review-queue-deadline", b.ba)) && Q(b, m) }; t.NJ = function () { ey(this, ["移交", "已经移交给：" + this.rH[1]], ["handover", ""]); this.Lj.hide(); this.vm(); Q(this.ba, m) }; a.ey = function (b, c, d) { var e = 0; b.mb.name === d[0] && (e = 1); b.mb.name = d[e]; var d = "", g = b.mb.innerHTML.indexOf("</span>"); -1 < g && (d = b.mb.innerHTML.substring(0, g + 7)); b.mb.innerHTML = d + c[e] };
        t.vm = function () { E.remove(this.ba, "zm-item-unread"); this.locked = m };
        t.Iw = function (b) {
            if (this.locked) this.fF && Nk(this.fF, "last action"); else {
                this.locked = j; var c = b.name; this.fF = c; var d = Jc(b, k, "zm-item"); this.mb = b; this.ba = d; if (d.getAttribute("data-lockdown")) this.locked = m; else {
                    var e = b.getAttribute("data-op"); if (e) switch (e) {
                        case "lock-question": case "unlock-question": $x(this, b, function () { Zx(b, "lock-question" === e ? "unlock-question" : "lock-question"); this.vm() }); break; case "mute-question": case "unmute-question": $x(this, b, function () {
                            Zx(b, "mute-question" === e ? "unmute-question" :
                            "mute-question"); this.vm()
                        }); break; case "remove-question": $x(this, b, function () { L(d); this.locked = m }); break; case "collapse-answer": case "uncollapse-answer": $x(this, b, function () { Zx(b, "collapse-answer" === e ? "uncollapse-answer" : "collapse-answer"); this.vm() }); break; case "remove-answer": $x(this, b, function () { L(d); this.locked = m })
                    } else {
                        switch (c) {
                            case "edit_title": var c = d.getAttribute("data-question_id"), g = d.getAttribute("data-task_id"), c = new by(c, "/reviewq/question?queue_id=" + this.Kb + "&action=edit_title&task_id=" +
                            g, "title", m, j); c.Sq = j; c.zd = j; c.o(b.parentNode); c.Vj = j; c.B(); c.qd(); this.uZ = c; L(b); this.locked = m; break; case "bind_topic": this.locked = m; this.wA || (c = new Ht(this.Kb), c.o(this.gc), this.wA = c); c = this.wA; g = J("zm-review-queue-tags-wrap", d); if (!c.locked) {
                                c.locked = j; c.la = d.getAttribute("data-question_id"); var h = d.getAttribute("data-task_id"); c.uB = c.SB + h + "&question_id=" + c.la + "&action=bind_topic"; c.bH = c.SB + h + "&question_id=" + c.la + "&action=unbind_topic"; c.fs && (h = J("zm-tag-editor-labels", c.fs), Tp(c), h.innerHTML =
                                c.Pe.innerHTML, E.remove(c.fs, "zm-review-queue-editing")); c.DC = d; c.fs = d; E.add(c.DC, "zm-review-queue-editing"); lc(c.g, g); Q(c.Pe, m); c.xA = new V(j); c.h().e(c.xA, "complete", c.fR); c.xA.ajax("/reviewq/fetch_topic", "question_id=" + c.la)
                            } break; case "delete_topic": this.zb = this.MJ; this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax("/reviewq/topic?queue_id=" + this.Kb + "&is_realm=" + this.Xd, "action=delete&topic_id=" + this.ba.getAttribute("data-topicid") + "&task_id=" + this.ba.getAttribute("data-task_id") +
                            "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; case "handover": this.locked = m; this.zb = this.NJ; this.Lj ? Q(this.Lj.m(), j) : (c = new ay("/reviewq/auto"), g = K("div", { id: "zh-review-queue-people-selector" }), this.g.appendChild(g), c.o(g), this.Lj = c, this.h().e(this.Lj, "select", this.SQ)); c = +d.getAttribute("data-hotype"); this.Lj.O.Vh = c; c = Jc(b, "DIV"); lc(this.Lj.m(), c); break; case "pass": case "unpass": this.zb = this.SJ; this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax("/reviewq/pass",
                            "queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&action=" + c + "&task_id=" + this.ba.getAttribute("data-task_id") + "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; case "unflag": break; case "add_question_comment": case "add_answer_comment": this.kL = c.split("_")[1]; this.locked = m; (c = gy(this)) ? Q(c, j) : (g = K("div"), g.innerHTML = H("zh-review-queue-comment-form-template").innerHTML, lc(g, J("zm-item-comment-el", this.ba))); $(".zm-command", c).show(); break; case "delete_comment": this.locked = m; break; case "addnew": this.locked =
                            m; c = Vb("TEXTAREA", k, this.ba); c = c[c.length - 1].value; if (!c) return; this.zb = this.JJ; this.sl(c); break; case "closeform": this.locked = m; Q(gy(this), m); break; case "unbind_topic": this.zb = this.$J; c = this.ba.getAttribute("data-question_id"); g = this.ba.getAttribute("data-topicid"); h = this.ba.getAttribute("data-task_id"); this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax("/reviewq/question?queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&task_id=" + h, "action=unbind_topic&question_id=" + c + "&topic_id=" +
                            g + "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; case "rebind_topic": this.zb = this.TJ; c = this.ba.getAttribute("data-question_id"); g = this.ba.getAttribute("data-topicid"); h = this.ba.getAttribute("data-task_id"); this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax("/reviewq/question?queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&task_id=" + h, "action=bind_topic&question_id=" + c + "&topic_id=" + g + "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; case "cancel_nohelp": this.zb =
                            this.KJ; c = this.ba.getAttribute("data-answer_id"); g = this.ba.getAttribute("data-task_id"); this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax("/reviewq/answer?queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&task_id=" + g, "action=cancel_nohelp&answer_id=" + c + "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; case "nohelp": this.zb = this.RJ; c = this.ba.getAttribute("data-answer_id"); g = this.ba.getAttribute("data-task_id"); this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success",
                            this.qe); this.xhr.ajax("/reviewq/answer?queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&task_id=" + g, "action=nohelp&answer_id=" + c + "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; case "edit_detail": c = d.getAttribute("data-question_id"); g = d.getAttribute("data-task_id"); c = new by(c, "/reviewq/question?queue_id=" + this.Kb + "&action=edit_detail&task_id=" + g, "detail_text", j, m); c.yb = '<div style="font-weight:bold"><a href="javascript:;" name="edit">添加补充说明</a></div>'; c.Sq = j; c.o(b.parentNode); c.Vj = j; c.B();
                                c.qd(); this.MX = c; L(b); this.locked = m; break; case "voteup": case "votedown": c = "voteup" === c ? "vote_up" : "vote_down"; this.zb = this.aK; g = this.ba.getAttribute("data-answer_id"); h = this.ba.getAttribute("data-task_id"); this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax("/reviewq/answer?queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&task_id=" + h, "action=" + c + "&answer_id=" + g + "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; case "thanks": this.zb = this.ZJ; c = this.ba.getAttribute("data-answer_id");
                                    g = this.ba.getAttribute("data-task_id"); this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); this.xhr.ajax("/reviewq/answer?queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&task_id=" + g, "action=thanks&answer_id=" + c + "&none_queue=" + this.ba.getAttribute("data-none_queue")); break; default: this.locked = m
                        } return m
                    }
                }
            }
        }; t.ZJ = function () { this.mb.name = ""; var b = $(this.mb), c = $("i", b); b.html(c).append("感谢已发出"); fy(this, hy(this), "已流通") };
        t.aK = function () { var b = Ie(this.xhr), c = J("vote-bar-hook", this.ba); E.set(c, "zm-item-vote-bar"); "up" === b.msg ? (E.add(c, "zm-item-vote-up-active"), fy(this, hy(this), "已流通")) : "down" === b.msg ? E.add(c, "zm-item-vote-down-active") : (E.remove(c, "zm-item-vote-up-active"), E.remove(c, "zm-item-vote-down-active")); this.locked = m }; a.hy = function (b) { return J("zg-btn-white", b.ba) };
        t.qe = function () { var b = Ie(this.xhr); if (b && b.r) { if ("deleted" === b.msg) { if (this.ba && (E.add(this.ba, "zm-queue-disabled"), this.ba.setAttribute("data-lockdown"), b = Vb("A", k, this.ba), z.forEach(b, function (b) { if ("delete_question" === b.name || "delete_answer" === b.name) b.style.color = "red !important", b.innerHTML = "已删除" }), b = J("zm-review-queue-deadline", this.ba))) b.setAttribute("data-lefttime", -9E3), b.innerHTML = "" } else U(b.msg); this.locked = m } else this.zb() };
        t.RJ = function () { this.mb.name = "cancel_nohelp"; var b = $(this.mb), c = $("i", b); b.html(c).append("撤销没有帮助"); this.locked = m; fy(this, hy(this)) }; t.KJ = function () { this.mb.name = "nohelp"; var b = $(this.mb), c = $("i", b); b.html(c).append("没有帮助"); this.locked = m; fy(this, hy(this)) }; t.TJ = function () { this.mb.name = "unbind_topic"; this.mb.innerHTML = "解除绑定"; this.locked = m }; t.$J = function () { this.mb.name = "rebind_topic"; this.mb.innerHTML = "重新绑定"; this.locked = m };
        t.JJ = function () { var b = gy(this), c = K("div", "zm-comment-list"); c.innerHTML = '<div class="zm-comment-content">已评论</div>'; lc(c, b); Gk(c); setTimeout(function () { L(c) }, 2500); var d = Vb("TEXTAREA", k, this.ba); d.length && (d[d.length - 1].value = ""); Q(b, m) };
        t.sl = function (b) { this.xhr = new V(j); this.zb && P(this.h(), this.xhr, "success", this.qe); var c = this.ba.getAttribute("data-question_id"), c = c ? "&question_id=" + c : "&question_id=0", d = this.ba.getAttribute("data-answer_id"); this.xhr.ajax("/reviewq/" + this.kL, "queue_id=" + this.Kb + "&is_realm=" + this.Xd + "&action=add_comment&task_id=" + this.ba.getAttribute("data-task_id") + c + (d ? "&answer_id=" + d : "&answer_id=0") + "&comment=" + encodeURIComponent(b) + "&none_queue=" + this.ba.getAttribute("data-none_queue")) };
        a.gy = function (b) { return J("zm-comment-form", b.ba) }; a.iy = function (b) { this.xP = this.locked = m; this.url = b || "/reviewq/image" }; y(iy, yn); ya(iy.prototype, Yx.prototype); t = iy.prototype; t.vw = p("g"); t.gB = { "remove-question": "delete_question", "collapse-answer": "collapse", "uncollapse-answer": "uncollapse", "remove-answer": "delete_answer", "remove-image": "delete_image", "remove-video": "delete_video" }; t.Cy = function () { this.locked = m };
        t.o = function (b) {
            this.g = b; var b = J("zm-item-rich-text", this.g), c = K("div", "zm-item-answer-summary"), d = b.innerHTML.replace(/<br>/g, " "), e; e = d.replace(/<p class="video-info">(.+?)<\/p>/g, ""); e = e.replace(/<(\/)?b>/g, "").replace(/<(\/)?i>/g, "").replace(/<(\/)?u>/g, ""); d = e.replace(/<[^>]+>/g, " ").replace(/\s+/g, " "); e = -1 < b.innerHTML.indexOf("<img") || -1 < b.innerHTML.indexOf("<IMG"); var g = -1 < b.innerHTML.indexOf("video-box"), h = Mk(d), l = "", n = e || g; 150 < h ? (n = j, l = d.substring(0, 100) + "… ") : 3 < b.innerHTML.split("br").length ?
            (n = j, l = d) : l = n ? d : b.innerHTML; d = g ? ' <span class="zg-content-video-icon"></span>' : ' <span class="zg-content-img-icon"></span>'; if (e || g) l += d; n && (l += '<a href="javascript:;" class="zg-inline-block" name="expand">显示全部 »</a>'); c.innerHTML = l; lc(c, b); this.Ty(); this.Ra()
        }; t.Ty = function () { this.jX = this.g.getAttribute("data-answer_id"); this.cZ = this.g.getAttribute("data-question_id"); this.jP = this.g.getAttribute("data-task_id") }; t.Ra = function () { this.h().e(this.g, "click", this.ul) };
        t.ul = function (b) { if (!b.target.name || this.xP) return j; this.ka(b.target.name, b.target) }; a.jy = function (b) { E.has(b.g, "zm-item-unread") && (b.locked = j, E.remove(b.g, "zm-item-unread"), Gi(b.url, v(function () { this.locked = m }, b), "POST", "task_id=" + b.jP)); if (b = J("zm-image-queue-button-pass", b.g)) b.innerHTML = "已处理", E.Bk(b, "zm-image-queue-button-pass", "zg-link-gray-normal zg-right") };
        t.ka = function (b, c) {
            if (!this.locked) {
                this.KX = c; var d = j, e = c.getAttribute("data-op"); if (e) switch (e) {
                    case "collapse-answer": case "uncollapse-answer": $x(this, c, function () { Zx(c, "collapse-answer" === e ? "uncollapse-answer" : "collapse-answer"); jy(this) }); break; case "remove-answer": $x(this, c, function () { L(this.g); jy(this) }); break; case "remove-question": $x(this, c, function () { L(this.g); jy(this) }); break; case "remove-image": case "remove-video": var g = sc(c), h, d = g.getAttribute("data-imageid"), l = g.getAttribute("data-videoid");
                        d ? h = "image_hash=" + d : l && (h = "video_id=" + l); $x(this, c, function () { var b = Jc(g, "li"); Q(b, m); this.locked = m }, h)
                } else { switch (b) { case "pass": jy(this); Q(this.g, m); break; case "expand": E.remove(this.g, "zm-item-collap"); break; default: d = m } if (!d) return j }
            }
        }; a.ky = function (b, c, d) { M.call(this); this.vZ = d; this.sJ = b; this.YT = c; this.nA = m }; y(ky, yn); ky.prototype.B = function () { this.h().e(this.sJ, "click", this.JM) }; ky.prototype.JM = function () { this.nA = !this.nA; Q(this.YT, this.nA) }; a.ly = function () { M.call(this); this.Xs = 0; this.Ck = []; this.Xx = 0 }; y(ly, yn); t = ly.prototype; t.rf = function (b) { var c = b.id.split("-")[1], d = new V(j), e = 0, g = Jc(b, k, "zm-item"); g && (-1 < b.innerHTML.indexOf("取消") ? (Tf(g, "background", "#fff"), b.innerHTML = "折叠", E.Bk(b, "zg-unfollow", "zg-follow"), e = 0) : (Tf(g, "background", "#ddd"), b.innerHTML = "取消折叠", E.Bk(b, "zg-follow", "zg-unfollow"), e = 1)); d.ajax("/review/api/collapse_answer", "is_collasped=" + e + "&answer_id=" + c) };
        t.ak = function () { this.dk = new V(m); P(this.h(), this.dk, "success", this.Vw); this.dk.ajax("/reviewq/sidebar?queue_id=" + this.Kb, k, "GET") }; t.Vw = function () { var b = Ie(this.dk); if (!b || !b.r) { var c = b.msg, b = Wb("zm-review-queue-live-udatable-num"); z.forEach(b, function (b) { var e = b.getAttribute("data-key"); e && (e = c[e], e != k && (b.innerHTML = e)) }); setTimeout(v(this.ak, this), 1E4) } };
        t.B = function () {
            var b = H("zh-queue-wrap"); if (b) { var c = new Xx(b, window.location.href, "queue", ["zg-btn-follow", "zg-btn-unfollow"], j); this.h().e(b, "click", this.dG); c.B() } (b = H("zh-review-queue-online-reviewers")) && (new Xx(b, window.location.href, k, k, j)).B(); if (b = H("zh-queue-content-list")) this.oT = b, this.h().e(Y, Tt.wW, this.DN), b = new Xx(b, window.location.href, "queue", ["zg-btn-follow", "zg-btn-unfollow"], j), b.Cz(Rx), b.B(), this.h().e(H("zh-queue-outer-wrap"), "click", this.dG); (b = H("zh-queue-content-list-v2")) &&
            (new dy).B(b); if (b = H("zh-image-queue-list-wrap")) this.Kb = (c = H("queue_id")) ? c.value : 0, this.ak(), b = Wb("zm-item", b), z.forEach(b, function (b) { (new iy).o(b) }); if (b = H("zh-video-queue-list-wrap")) this.Kb = (c = H("queue_id")) ? c.value : 0, this.ak(), b = Wb("zm-item", b), z.forEach(b, function (b) { (new iy("/reviewq/video")).o(b) }); if (b = H("zh-inferiority-queue-list-wrap")) this.Kb = (c = H("queue_id")) ? c.value : 0, this.ak(), b = Wb("zm-item", b), z.forEach(b, function (b) { (new iy("/reviewq/inferiority")).o(b) }); if (mh) {
                b = mh; this.Xs = b[0];
                var d = []; z.forEach(b[1], function (b) { d.push(b) }); this.Ck = d
            } if (b = H("zh-queue-create-wrap")) this.tn = b, this.h().e(this.tn, "click", this.ka), (b = H("zh-queue-delete")) && this.h().e(b, "click", this.LL), (new ky(H("add-desc"), H("add-desc-toggle-wrap"))).B(), (new ky(H("zh-queue-add-admin"), H("zh-queue-add-admin-toggle-wrap"))).B(), this.mH = H("zh-queue-rules-wrap"), this.TT = H("zh-queue-name-input"), this.NL = H("zh-queue-desc-input"), this.Rv = H("zh-queue-error-message"), this.GJ = H("zh-queue-admin-selector"), this.yB = H("zh-queue-admin-members-wrap"),
            this.O = new Oo("/people/autocomplete", this.GJ, k, k, H("zh-queue-add-admin-toogle-wrap"), j), this.O.dg(j), this.h().e(this.O, "select", this.Co), this.DS = H("zh-queue-rule-template").innerHTML; if (b = H("zh-queue-delete")) this.JL = b, this.h().e(b, "click", this.vl)
        }; t.vl = function () { Gi("/review/queues/delete", function () { window.location.href = "/review" }, "POST", "queue_id=" + this.JL.name) };
        t.Co = function () { var b = z.slice(this.O.Fg(), 1), c = b[3], d = 1; z.forEach(this.Ck, function (b) { b === c && (d = m) }); d && this.Ck.push(c); b = ['<div class="zm-item" id="adm-', b[3], '"><a class="zg-right" name="remove_admin" href="javascript:;">删除</a><a class="zm-item-link-avatar" href="/people/', b[1], '" style="float:none"><img title="', b[0], '" src="', b[2], '" class="zm-item-img-avatar" /></a></div>'].join(""); this.yB.innerHTML += b };
        t.ka = function (b) {
            if ((b = Kk(this.tn, b.target)) && b.name) switch (b.name) {
                case "remove_rule": b = Jc(b, k, "zg-section"); L(b); break; case "zh-queue-add-rule-button": b = K("div"); b.innerHTML = this.DS; this.mH.appendChild(b); break; case "add_queue": this.xhr = new V(j); P(this.h(), this.xhr, "success", this.AB); b = new Lk(j); b.add("id", this.Xs); b.add("title", this.TT.value); b.add("bio", this.NL.value); var c = [], d = Vb("SELECT", k, this.mH); d && d.length && z.forEach(d, function (b) { (b = vx(b)) && c.push(b) }); b.add("subscrible", c.join(","));
                    b.add("maintainer", this.Ck.join(",")); this.Xs ? this.xhr.ajax("/review/queues/update", b.Kc()) : this.xhr.ajax("/review/queues/new", b.Kc()); break; case "remove_admin": var b = Jc(b, k, "zm-item"), e = b.id.split("-")[1]; L(b); var g = []; z.forEach(this.Ck, function (b) { b !== e && g.push(b) }); this.Ck = g
            }
        }; t.LL = function () { this.xhr = new V(j); P(this.h(), this.xhr, "success", this.AB); this.xhr.ajax("/review/queues/delete", "id=" + this.Xs) };
        t.AB = function () { var b = Ie(this.xhr); b && !b.r ? (Q(this.Rv, m), b.msg && (window.location.href = b.msg)) : (b = b.msg, this.Rv.innerHTML = ma(b) ? b.join("<br />") : b, Q(this.Rv, j)) }; t.DN = function (b) { this.Xx++; 300 < this.Xx && window.location.reload(); var b = b.pc, c = K("div"); c.innerHTML = b; kc(c, rc(this.oT)); Gk(c) }; t.dG = function (b) { if ((b = Kk(H("zh-queue-outer-wrap"), b.target)) && b.name) switch (b.name) { case "collapse": this.rf(b, 1); break; case "uncollapse": this.rf(b, 0) } }; a.my = function () { }; ia(my); a.ny = $i.create("Report" + S.ws); my.prototype.qJ = '<div id="zh-feedback-form"><select name="type" class="zg-editor-type zg-right"><option value="help">使用帮助 </option><option value="bug">问题反馈</option><option value="suggest">功能建议</option></select><div class="zg-report-title"><span class="zg-gray-darker">请填写你的反馈内容</span><span class="zg-report-msg" style="display:none;">请选择反馈种类：</span></div><div class="zg-editor-simple-wrap zg-form-text-input zg-report-content"><textarea class="zg-editor-input" name="content"></textarea></div></div>';
        my.prototype.defaults = { title: "建议和反馈" }; my.prototype.Ju = function (b) { var c = $("#zh-feedback-form"), d = $("select", c), c = $("textarea", c); new Io(c[0]); d.toggle(!b.type); c.html(ny.get("content") || ""); c.on("input change", function () { ny.Oe("content", this.value) }) };
        my.prototype.create = function (b) { var c = $.extend(this.defaults, b || {}); Di(c.title, this.qJ, function (b) { if (b) { var e = $("#zh-feedback-form"), b = $(".zg-report-msg", e), g = $("textarea", e), e = $("select", e), e = c.type || e.val(), h = $.trim(g.val()); h ? (b.hide(), b = new V(j), g = new kj, b.on("success", function () { U("建议发送成功，我们会尽快处理，感谢您的帮助"); ny.remove("content") }), g.add("type", e).add("content", h), b.ajax("/feedback/report", g.toString()), b = i) : (b.html("请填写反馈内容").show(), g.focus(), b = m); return b } }, this); this.Ju(c) }; $(function () { $("#js-feedback-button").click(function () { my.T().create() }) }); a.oy = function () { M.call(this) }; y(oy, yn);
        oy.prototype.B = function () {
            var b = H("zm-search-result-answers"); b && (b = Wb("feed-item-hook", b), z.forEach(b, function (b) { Ww(b).o(b) })); b = $("#zh-search3-list > .zh-general-list"); if (b.length) { var c = new Bu({ pa: ["autoload"] }); c.pa("nodeSource", { Yu: 15 >= b.children().length }); c.o(b[0]); $(".search-debug-all-btn").click(function () { $("#zh-search3-list").toggleClass("debug") }) } $("#zh-search-report").click(function () { my.T().create({ type: "search_suggest", title: "新搜索建议反馈" }) }); $("#zh-search3-list").on("click", ".zm-search3-item",
            function (b) { b = $(b.delegateTarget).find(".zm-search3-item").index(this) + 1; Nf.set("s-q", encodeURIComponent(bt(new vf(location.href), "q"))); Nf.set("s-i", b); Nf.set("sid", Yk()) })
        }; a.py = function () { T.call(this); this.ia = k }; y(py, T); py.prototype.C = function () { py.n.C.call(this); this.h().e(this.g, "submit", function (b) { b.preventDefault(); this.save() }) }; py.prototype.save = function () { this.update(qy(this)) }; py.prototype.update = function (b) { if (!(this.ia && "pending" === this.ia.state())) { var c = $(this.g).data("init"), b = { method: "save", params: $.extend({}, c.params || {}, { settings: b }) }; this.ia = $.post("/node/" + c.nodename, b, v(this.nf, this)) } };
        py.prototype.nf = function (b) { b && (b[0] ? this.dispatchEvent({ type: "success", data: b }) : this.dispatchEvent({ type: "error", data: b })) }; a.qy = function (b) { b = $(b.g); b = b.serializeArray().concat($("input:checkbox", b).map(function () { return { name: this.name, value: this.checked ? this.value : 0 } }).get()); return z.reduce(b, function (b, d) { b[d.name] = d.value; return b }, {}) }; a.ry = function () { T.call(this) }; y(ry, T); a.sy = function (b) { var c = $.Deferred(); Di("取消屏蔽", b, function (b) { b ? c.resolve() : c.reject() }); return c.promise() };
        ry.prototype.C = function () {
            ry.n.C.call(this); var b = H("zh-topic-block-editor"); b && (new Ft(kh)).o(b); var c = $(".blocked-users", this.m()); if (c.length) $(".item", c).on("click", ".js-unblock", function (b) { var d = $(b.delegateTarget); sy("取消屏蔽之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。").then(function () { return $.post("/settings/unblockuser", { uid: d.data("id") }) }).then(function () { d.fadeOut(function () { d.remove() }); c.children().length || window.location.reload() }) }); var d = $(".blocked-columns", this.m()); if (d.length) $(".item",
            d).on("click", ".js-unblock", function (b) { var c = $(b.delegateTarget); sy("取消屏蔽之后，你将可以看到来自该专栏的文章。").then(function () { return $.post("/settings/unblockcolumn", { id: c.data("id") }) }).then(function () { c.fadeOut(function () { c.remove() }); d.children().length || window.location.reload() }) })
        }; a.ty = function () { T.call(this); this.YX = []; this.$Y = "/profile/validate" }; y(ty, T);
        ty.prototype.B = function () {
            var b = this, c = $("#zh-settings-noti-form-wrapper>form")[0]; if (c) { var d = new py; d.o(c); d.addEventListener(["success", "error"], function (b) { window.scrollTo(0, 0); Hs(F.La(b.data), 3E3) }) } var e = $(".js-ajax-form"); e.submit(function (b) { var c = $(b.target), b = c.attr("action") || location.href; $.post(b, c.serialize()).done(function (b) { Hs(F.La(b), 5E3); c.hasClass("unsubscribe") && (e.remove(), $(".settings-section").remove()) }); return m }); $(".js-unsubscribe-other-reason").on("change", function (b) { $(b.target).parent().siblings().find(".zg-form-text-input").toggle() });
            var g = $(".feedback-form"); g.submit(function () { var b = g.attr("action"); $.post(b, g.serialize()).done(function () { g.before('<div style="font-size:13px;color:black;margin-bottom:20px">感谢您的反馈！</div><a href="/">&laquo; 返回知乎</a>'); g.remove() }); return m }); $("#weibopageenable").on("change", function (b) { b = $(b.target); $.post("/node/SettingsWeiboPageV2", { method: b.is(":checked") ? "enable" : "disable" }).done(function (b) { b.r ? U(b.msg) : Hs([m, "保存成功"]) }); return m }); c = $("#js-settings-account-form"); if (c.length) {
                var h = yk(function () { new Tl(H("password")) }),
                d = $("#url_token"), l = $("#js-url-preview .token"); d.on("input change keyup", function () { l.text($.trim(this.value)) }); var n = $("#email"), q = function () { $("#js-email-confirm").show(); n.off("focus", q); h() }; n.one("focus", q); $(function () { document.activeElement === n.get(0) && q() }); $(".resend-mail", c).click(function () { var b = $(this); Mi.dispatchEvent("/activation/resend-email"); $.post("/settings/resend_reset_email", function (c) { c.r ? U(c.msg) : b.replaceWith("已发送") }); return m }); $(".zg-form-text-input", c).each(function () {
                    function b() {
                        this.value !==
                        this.defaultValue && (d.hide(), c.off("change input keyup", b))
                    } var c = $(this), d = c.next(".validate-error"); if (d.length) c.on("change input keyup", b)
                }); var d = new ls, r = $(".rename-tab", c); d.o(r.get(0)); var w = function () { $("input[placeholder]:visible", r).placeholder() }; d.on("select", w); var C = $(".rename-button", c), c = function () { C.remove(); r.show(); w() }; C.one("click", c); "#rename-section" === location.hash && c()
            } c = $("#js-form-account-password"); c.length && ($("input[placeholder]", c).each(function () { new Tl(this) }), c.validate({
                messages: {
                    np: { required: '<i class="icon icon-validate-error"></i>新密码未填写' },
                    op: { required: '<i class="icon icon-validate-error"></i>旧密码未填写' }, rp: { required: '<i class="icon icon-validate-error"></i>确认密码未填写' }
                }, errorClass: "validate-error"
            })); (c = H("zh-setting-page-black-list-wrap")) && (new ry).o(c); (c = H("zh-setting-page-bind-wrap")) && (new xx).o(c); $(".zu-main-content-inner form").on("change", "input, textarea, select", function () { b.Jv("SettingsPage") }).on("submit", function () { b.Av("SettingsPage") })
        };
        ty.prototype.Jv = function () { $(window).on("beforeunload.SettingsPage", v(s("你的修改还未保存，确认离开该页面吗？"), this)) }; ty.prototype.Av = function () { $(window).off("beforeunload.SettingsPage") }; a.uy = function () { M.call(this); this.U = k; this.sj = 0; this.ZI = "/oauth/friends/sina"; this.jJ = "/invitation/sina"; this.Cc = new Jd(200) }; y(uy, yn); t = uy.prototype; t.B = function () { this.El || (this.El = j, this.w(), this.Ra(), vy(this)) }; t.show = function () { this.B(); this.U.F(j); var b = new Nb(this.U.m().offsetLeft, this.U.m().offsetTop); b.y = 102; $f(this.U.m(), b) }; t.w = function () { var b = H("zh-invitation-sina-diag"); b && (this.g = b, this.U = new zi(k, m), this.U.ab("邀请微博好友"), ii(this.U, k), this.U.Z().appendChild(this.g)) };
        t.ka = function (b) { if ("cancel" === b.target.name) this.U.F(m); else if ("invite" === b.target.name) { var b = Wb("zm-item-checkbox-right", this.yj), c = []; z.forEach(b, function (b) { b.checked && (c.push(b.value), b.checked = "") }, this); c && c.length && (this.az = new V(j), this.h().e(this.az, "complete", this.PJ), this.az.ajax(this.jJ, "sinaids=" + c.join(","))) } };
        a.wy = function (b, c) { b.sj = c ? b.sj + 1 : b.sj - 1; b.RE.innerHTML = b.sj + "" }, a.vy = function (b, c) { b.xF || (b.xF = j, b.xhr = new V(j), P(b.h(), b.xhr, "complete", b.mf), b.xhr.ajax(b.ZI, c ? "force=1" : "")) }; t.mf = function () { this.xF = m; var b = Ie(this.xhr); b && !b.r ? this.setData(b) : U(b.msg) };
        t.setData = function (b) { this.CL = j; this.zU.innerHTML = +b[0]; this.sj = +b[1]; this.RE.innerHTML = this.sj + ""; this.data = b = b[3]; var c = []; z.forEach(b, function (b) { c.push(['<div class="zm-item zm-item-h50"><input type="checkbox" value="', b[0], '" class="zm-item-checkbox-right" /><img class="zm-list-avatar-medium" src="', b[2], '" /><div class="zm-list-content"><strong class="zg-gray-normal">', b[1], '</strong><div class="zg-gray-normal">', b[3], "</div></div></div>"].join("")) }, this); this.yj.innerHTML = c.join("") };
        t.Ra = function () { this.nt = J("zg-form-text-input", this.g); (new Co("搜索微博好友")).o(this.nt); this.Hi = J("zm-command", this.g); this.yj = H("zh-invitation-sina-friends-list"); this.aS = H("zh-invitation-sina-force-refresh"); this.h().e(this.aS, "click", function () { this.yj.innerHTML = "列表刷新中，请稍侯..."; vy(this, j) }); this.h().e(this.yj, "click", this.YP); var b = Vb("strong", k, this.g); this.zU = b[0]; this.RE = b[1]; this.h().e(this.nt, "focus", this.At).e(this.nt, "blur", this.jp).e(this.Cc, Kd, this.bR); this.h().e(this.Hi, "click", this.ka) };
        t.YP = function (b) { var c = Jc(b.target, k, "zm-item"); if (c) { var d = k, e = Vb("input", k, c)[0]; if (E.has(c, "zm-item-active")) E.remove(c, "zm-item-active"), wy(this, j), d = m; else { var g; 0 >= this.sj ? (U("您的邀请码已经用完"), g = m) : g = j; g ? (E.add(c, "zm-item-active"), wy(this, m), d = j) : "INPUT" === b.target.tagName && b.preventDefault() } "INPUT" !== b.target.tagName && (e.checked = d); b.stopPropagation() } }; t.At = function () { this.Cc.start() }; t.jp = function () { this.Cc.stop() };
        t.bR = function () { if (this.CL) { this.items || (this.items = Wb("zm-item", this.yj)); var b = this.nt.value; b == k || "" === b ? z.forEach(this.items, function (b) { Q(b, j) }) : z.forEach(this.data, function (c, d) { this.items[d] && (b === c[0] || -1 < c[1].indexOf(b) ? Q(this.items[d], j) : Q(this.items[d], m)) }, this) } }; t.PJ = function () { var b = Ie(this.az); b && !b.r ? (U("邀请发送完毕"), this.U.F(m)) : U(b.msg) }; a.xy = function () { M.call(this); this.TI = "/oauth/unbind/sina" }; y(xy, yn); xy.prototype.B = function () { var b = H("zh-invite-send-invite-sina"); b && this.h().e(b, "click", this.kT); (b = H("zh-invitation-cancel-bind-sina")) && this.h().e(b, "click", this.hR) }; xy.prototype.kT = function () { this.LH || (this.LH = new uy); this.LH.show() };
        xy.prototype.hR = function () { Di("解除绑定", "你确定要解除与新浪微博的绑定吗？", function (b) { if (b) { var c = new V(j); P(this.h(), c, "success", function () { var b = Ie(c); b && !b.r ? window.location.reload() : U(b.msg) }); c.ajax(this.TI) } }, this) }; a.yy = function (b, c, d, e) { M.call(this); this.g = b; this.dw = c || "people"; this.kM = d || ["zg-btn-follow", "zg-btn-unfollow"]; this.text = e || ["关注", "取消关注"] }; y(yy, yn); yy.prototype.B = function () { this.h().e(this.g, "click", this.vo) }; yy.prototype.vo = function (b) { b = Kk(this.g, b.target); "focus" === (b && b.name) && on(b, this.dw, k, this.kM, { follow_text: this.text[0], unfollow_text: this.text[1] }) }; a.zy = function (b) { M.call(this); this.url = b || "/topic" }; y(zy, yn); t = zy.prototype; t.o = function (b) { this.element = b; var c = $("<ul>"); this.fI = $("<li>"); c.append(this.fI); $(b).append(c); this.gI || (this.gI = j, this.zA = new V(j), P(this.h(), this.zA, "success", this.rQ), this.zA.ajax(this.url, k, "POST")) }; t.rQ = function () { var b = Ie(this.zA); b && (b && b.r ? U(b.msg) : (Ay(this, this.fI, b.msg), this.gI = m, this.C())) }; t.C = function () { this.h().e(this.element, "click", this.vo) };
        t.vo = function (b) { var c = (b = b.target) ? b.name : ""; if (c) switch (c) { case "load": case "loadmore": if (!this.fo) { var c = b.getAttribute("data-token"), d = b.getAttribute("data-parent"); this.fo = j; this.Cj = new V(j); P(this.h(), this.Cj, "success", this.$p); this.Az = b.parentNode; this.Az.innerHTML = '<span class="zg-gray">加载中...</a>'; this.Cj.ajax(this.url + "?child=" + c + "&parent=" + d, k, "POST") } break; case "topic": window.location.href = b.href } };
        a.Ay = function (b, c, d) { var e = d[0], g = ""; "topic" !== e[0] && e[3] && (g = 'data-parent="' + e[3] + '"'); c.html('<a href="' + ("topic" === e[0] ? "/topic/" + e[2] + "/organize/entire" : "javascript:;") + '" data-token="' + e[2] + '" ' + g + ' name="' + e[0] + '">' + e[1] + "</a><ul class='zm-topic-organize-list'></ul>"); "topic" !== d[0][0] && c.addClass("zm-topic-organize-loadmore"); c = $("ul", $(c)); if (1 < d.length) { d = d[1]; for (e = 0; e < d.length; e++) { var g = d[e], h = $("<li>").addClass("zm-topic-organize-item"); c.append(h); Ay(b, h, g) } } };
        t.$p = function () { var b = Ie(this.Cj); if (b) if (b && b.r) U(b.msg); else if (b = b.msg, b[1]) { $(this.Az).hide(); for (var c = $(this.Az.parentNode), d = 0; d < b[1].length; d++) { var e = b[1][d], g = $("<li>").addClass("zm-topic-organize-item"); "topic" !== e[0][0] && g.addClass("zm-topic-organize-loadmore"); c.append(g); Ay(this, g, e) } this.fo = m } }; a.By = function (b) { var c = { xp: m, aZ: m }; return function (d) { if (d === m) return m; d = {}; F.extend(d, c, b || {}); if (d.xp && !S.Dr) return Ei("提示信息", '<a href="http://www.zhihu.com/question/23261456">如何参与知乎话题的公共编辑？</a>'), m; if (d.Yl && !th.question_edit_permission) return Ei("提示信息", '<p>创建时间一个月以上的问题限制公共编辑</p><p><a href="http://www.zhihu.com/question/24501563" target="_blank">如何参与问题公共编辑？</a></p>'), m } }; a.Cy = function (b, c, d) { Qr.call(this, b, c, d) }; y(Cy, Qr); Cy.prototype.nf = function (b) { hh[0][0] === b ? this.eh() : Cy.n.nf.apply(this, arguments) }; Cy.prototype.zB = function (b) { if (b = Ie(b.target)) b.r ? U(b.msg) : b.msg && (window.location.href = b.msg) }; a.Dy = function () { T.call(this); var b = hh; this.vf = b[0][3]; this.vA = b[0]; this.eZ = b[1]; this.uY = b[2]; this.DY = b[3]; this.nq = b[4]; this.Gx = b[5]; this.Tg = "topic" }; y(Dy, T); t = Dy.prototype; t.B = function () { zs.J(this); this.o(document.body) };
        t.C = function () {
            function b(b) { b && b.msg && U(b.msg) } Dy.n.C.call(this); var c = H("zh-topic-side-head"); if (c) { var d = J("zu-entry-focus-button", c); (this.jM = d) && this.h().e(d, "click", function () { on(d, "topic", "", ["zg-btn-green", "zg-btn-white"]) }); (this.Wf = H("zh-topic-operation-menu")) && this.h().e(this.Wf, "click", this.Pz) } if (c = H("zh-current-topic-bio")) { var e = new Qr(j, "/topic/bio/update", "bio"); e.params = ["tid=" + this.vf]; e.yb = '<a href="javascript:;" name="edit">你在 ' + this.vA[0] + " 话题中的经验</a>"; e.Sq = j; e.o(c) } (c = H("zh-topic-top-answerer")) &&
            (new yy(c, "people", ["zg-follow", "zg-unfollow"])).B(); if (c = H("zh-topic-direct-question-list")) c = new Xx(c, k, "question", k, j), c.Yg("question-item"), c.B(); if (c = H("zh-topic-title")) this.bd = new Cy(m, "/topic/update", "title"), this.bd.params = ["tid=" + this.vf], this.bd.addEventListener("beforeedit", By({ xp: j })), this.bd.o(c), $(c).on("click", ".js-pin", function () {
                var b = $(this), c = b.attr("data-action"); $.post(c, { tid: hh[0][3] }).done(function (c) {
                    c.r ? U(c.msg) : (c = b.hasClass("pin") ? '<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消固定</a>' :
                    '<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>固定话题</a>', b.replaceWith(c))
                })
            }); if (c = H("zh-topic-desc")) e = $(c).find(".zm-editable-content").data("editable-maxlength"), this.Uk = new Tr(j, "/topic/update", "description", e), this.Uk.yb = '<a href="javascript:;" name="edit">添加话题描述</a></div>', this.Uk.params = ["tid=" + this.vf], this.Uk.wq = m, this.Uk.qI = m, this.Uk.addEventListener("beforeedit", By({ xp: j })), this.Uk.o(c); if (c = H("zh-topic-faq")) this.fr =
            new Tr(j, "/topic/" + encodeURIComponent(hh[0][1]) + "/faq", "content", 400), this.fr.yb = '<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「' + hh[0][0] + "」添加常见问题</a></div>", this.fr.xZ = function (b) { return !b ? "" : b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi, "") }, this.fr.wq = m, this.fr.o(c);
            if (ph) $("div.topic-avatar").addClass("disabled"); else if (c = J("zm-entry-head-avatar-edit-button")) { e = new Ql(2, hh[0][3]); e.o(c); var g = J("zm-avatar-editor-preview"); N(e, "beforepost", function () { $("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(g.parentNode) }); N(e, "success", function (b) { g && (g.src = b.src); $(".avatar-edit-preview-loading").remove() }); this.h().e(e, "beforeopen", pf(By({ xp: j }), mn(ha, j))) } if (c = H("zh-topic-feed-list")) e = new Bu, this.J(e), e.pa("locationSource", {
                ms: 0,
                offset: function (b) { return z.Je(b).getAttribute("data-score") }
            }), e.pa("childConstructor", { factory: hx }).pa("expandLimit"), e.o(c), this.h().e(e, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("category", this.Tg).fill("label", "topic_activity") }); if (c = H("zh-topic-top-page-list")) e = new Bu({ bh: m }), this.J(e), e.pa("childConstructor", { factory: hx }).pa("expandLimit"), e.o(c), this.h().e(e, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("category", this.Tg).fill("label", "topic_activity") }); var h = this;
            h.Pa && h.h().e(h.Pa, "afterload", function (b) { Y.V({ type: "ga_click_topic_more", data: b.data, target: h.Pa.bc }) }); if (c = H("zh-topic-followers-list-wrap")) c = new Xx(c, ["/topic", encodeURI(this.vA[1]), "followers"].join("/"), k, ["zg-btn-follow", "zg-btn-unfollow"], j), c.Yg("zm-person-item"), c.B(); if (H("zh-topic-organize-page-wrap")) {
                if (c = H("zh-topic-organize-parent-editor")) S.Dr ? (e = new rt(k, this.vf, j), e.Cs = j, e.o(c), e.addEventListener("remove_tag", function (b) { (b = b.data && b.data.id) && $("#wedge-" + b).remove() })) : Ey(c);
                if (c = H("zh-topic-organize-child-editor")) S.Dr ? (e = new rt(k, this.vf, m), e.Cs = j, e.o(c), $("a.entire-link").insertAfter(e.mn).show()) : Ey(c); $("#zm-topic-manage-relation").on("change", '[type="checkbox"]', function () { var b = $(this).closest("li").attr("id").split("-")[1]; $.post("/topic/update", { action: "set_topic_edge", parent_topic_id: b, topic_id: hh[0][3], edge: this.checked ^ 0 }).done(function (b) { b && b.msg && U(b.msg) }) }); this.zu = H("zh-topic-alias-input"); new Tl(this.zu, "输入话题别名"); this.Au = H("zh-topic-alias-list"); this.h().e(H("zh-topic-alias-container"),
                "click", this.eR); if (c = H("zh-topic-merge")) this.Oa = new Gt, this.Oa.o(c); (c = H("zh-topic-merge-btn")) && this.h().e(c, "click", this.GQ)
            } (c = H("zh-topic-organize-page-children")) && (new zy("/topic/" + encodeURIComponent(hh[0][1]) + "/organize/entire")).o(c); if (c = H("zh-topic-side-related-topics")) this.eS = c, this.kz = new V(m), this.h().e(this.kz, "complete", this.QQ), this.kz.ajax("/topic/related?tid=" + this.vf); H("zh-topic-admin-page-wrap") && (c = H("zh-topic-del-btn")) && this.h().e(c, "click", this.nQ); if (c = H("zh-topic-log-list")) (new Xx(c,
            k, k, k, j)).B(), $(c).on("click", 'a[name="revert"]', pf(function (b) { b !== m && Rx(this) }, By({ xp: j }))); this.sx(); (c = J("zm-topic-search-input-new")) && new Tl(c, "在话题中搜索"); var l = $(c); ch.Ac || l.focus(function () { l.addClass("stretch-to") }).blur(function () { l.removeClass("stretch-to") }); (c = J("zm-topic-ask-in-topic")) && this.h().e(c, "click", this.wt); (c = J("zm-topic-feed-container")) && (new yy(c, "question", ["zg-follow", "zg-unfollow"])).B(); (c = H("zh-topic-side-children-list")) && (new yy(c, "topic", ["zg-follow", "zg-unfollow"])).B();
            (this.Qr = H("zh-topic-info-add")) && this.h().e(this.Qr, "submit", this.BQ); (this.IE = J("zm-topic-info-content-main", this.g)) && this.h().e(this.IE, "click", this.zQ); $("#zh-topic-manage-info-form").on("change", 'input[type="radio"]', function () { $.post("/topic/" + hh[0][1] + "/information/manage", { info: $(this).val(), action: "change" }).done(b) }); $("#zh-topic-manage-relation-form").on("change", 'input[type="radio"]', function () { $.post("/topic/update", { action: "set_topic_weaknode", topic_id: hh[0][3], weak: $(this).val() }).done(b) });
            $("#zh-topic-manage-lock-form").on("change", '[type="checkbox"]', function () { $.post("/topic/lock", { url_token: hh[0][1], lock_type: this.name, lock_value: $(this).is(":checked") ? 1 : 0 }).done(b) }); (c = H("zh-topic-info-add")) && z.forEach(pc(c), function (b) { var c; b && (b.getAttribute && (c = b.getAttribute("data-placeholder"))) && new Tl(b, c) }); $(".js-may-disable").click(mn(ha, j))
        };
        t.GQ = function () { this.Lq = this.Oa.JC; if (!this.HF && this.Lq) { this.HF = j; this.hy = new V(j); P(this.h(), this.hy, "success", this.QJ); this.hy.ajax("/topic/" + encodeURIComponent(hh[0][1]) + "/demand", "action=merge&target_topic_id=" + this.Lq[3]); var b = H("zh-topic-merged-msg"); Q(H("zh-topic-merge"), m); Q(b, j); b = Vb("a", k, b)[0]; b.href = "/topic/" + this.Lq[1]; b.innerHTML = this.Lq[0]; this.Oa && (this.Oa.Qa.value = "") } }; t.QJ = function () { var b = Ie(this.hy); b && b.r ? U(b.msg) : this.HF = m };
        t.nQ = function () { this.SC || (this.SC = j, this.wv = new V(j), P(this.h(), this.wv, "success", this.LJ), this.wv.ajax("/topic/" + encodeURIComponent(hh[0][1]) + "/demand", "action=remove")) }; t.LJ = function () { var b = Ie(this.wv); b && b.r ? U(b.msg) : (b = H("zh-topic-del-msg"), Q(H("zh-topic-del-btn"), m), Q(b, j), this.Oa && (this.Oa.Qa.value = ""), this.SC = m) };
        t.eR = function (b) {
            if ((b = b.target) && b.name) if ("add" === b.name) { if (b = this.zu.value) this.Bu = new V(j), P(this.h(), this.Bu, "complete", this.IJ), this.Bu.ajax(window.location.href, "action=add_alias&alias=" + encodeURIComponent(b)) } else "remove" === b.name ? (this.lz = new V(j), b = b.parentNode.getAttribute("data-token"), P(this.h(), this.lz, "complete", this.VJ), this.lz.ajax(window.location.href, "action=remove_alias&alias_token=" + b)) : "remove-merged" === b.name && (this.nz = new V(j), b = b.parentNode.getAttribute("data-token"), P(this.h(),
            this.nz, "complete", this.WJ), this.nz.ajax("/topic/" + encodeURIComponent(hh[0][1] + "/demand"), "action=remove&target_topic_id=" + b))
        }; t.WJ = function () { var b = Ie(this.nz); b && b.r ? U(b.msg) : Fy(this, b.msg) }; t.VJ = function () { var b = Ie(this.lz); b && b.r ? U(b.msg) : Fy(this, b.msg) }; a.Fy = function (b, c) { var d = Vb("li", k, b.Au); z.forEach(d, function (b) { b.getAttribute("data-token") === c[1] && Q(b, m) }) };
        t.IJ = function () { var b = Ie(this.Bu); if (b && b.r) U(b.msg); else { var b = b.msg, c = K("li"); c.setAttribute("data-token", b[1]); c.innerHTML = b[0] + ' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>'; this.Au.appendChild(c); this.zu.value = ""; Q(this.Au.parentNode, j) } }; a.Ey = function (b) { ic(b, gc('<a href="/question/23261456" class="zg-link-gray-normal"><i class="icon-info" style="vertical-align: -3px; margin-right: 6px"></i>如何参与知乎话题的公共编辑？</a>')) };
        t.Pz = function (b) { this.My ? this.fb.S() ? this.fb.F(m) : (this.fb.F(j), b.stopPropagation(), b.preventDefault(), this.Hk()) : (b.stopPropagation(), b.preventDefault(), this.pj(), this.Hk()); this.My = j }; t.Hk = function () { P(this.h(), document, "click", function () { this.fb.F(m) }) };
        t.pj = function () { var b = H("zh-topic-side-head"), c = this.Wf.getAttribute("data-auth"); this.fb = new Ru; this.ax = j; "f-topic-manage" === c && this.fb.Ga(this.lR = new Ou("管理话题")); this.fb.Ga(this.mR = new Ou("组织话题")); this.fb.Ga(this.kR = new Ou("话题日志")); this.ax && (this.fb.Y(b), this.h().e(this.fb, "action", this.hj)) }; t.hj = function (b) { var c = ""; b.target === this.lR ? c = "admin" : b.target === this.mR ? c = "organize" : b.target === this.kR && (c = "log"); window.location.href = ["/topic", this.vA[1], c].join("/") };
        t.QQ = function () { var b = Ie(this.kz); if (b && !b.r) { var c = []; z.forEach(b, function (b) { c.push(Ak(b, k, j)) }); this.eS.innerHTML = c.join("") + '<div class="zg-clear"></div>'; b.length && Q(H("zh-topic-side-related-topics-wrap"), j) } }; t.sx = function () { var b = H("zh-topic-search-list"); b && (this.Pa = new ix(b, k, j), this.Pa.Yg("zm-search-result-item"), this.Pa.Es = function (b) { if (b && 0 !== b.length) return b[b.length - 1].getAttribute("data-offset") }, this.Pa.B()) };
        t.zQ = function (b) { var c = b.target; c && c.name && "remove" === c.name && (this.vO = c, this.JE || (this.JE = j, this.mx = new V(j), this.h().e(this.mx, "success", this.AQ), b = "token=" + this.vO.parentNode.getAttribute("data-token") + "&action=remove&element=" + encodeURIComponent($(b.target).prev("[data-element]").text()), this.mx.ajax("/topic/" + hh[0][1] + "/information/manage", b, "POST"))) }; t.AQ = function () { this.JE = m; var b = Ie(this.mx); b && (b.r ? U(b.msg) : b.msg && (b = b.msg, J("zm-topic-info-content-main", this.g).innerHTML = $(b).html())) };
        t.BQ = function (b) { b.preventDefault(); this.KE || (this.KE = j, this.nx = new V(j), this.h().e(this.nx, "success", this.yQ), b = pc(this.Qr), this.nx.ajax("/topic/" + hh[0][1] + "/information/manage", "title=" + b[0].value + "&content=" + b[1].value + "&url=" + b[2].value + "&action=add", "POST")) }; t.yQ = function () { this.KE = m; var b = Ie(this.nx); b && (b.r ? U(b.msg) : b.msg && (b = b.msg, J("zm-topic-info-content-main", this.g).innerHTML = $(b).html(), b = pc(this.Qr), z.forEach(b, function (b, d) { 3 > d && (b.value = "") }))) };
        t.wt = mn(function () { if (!us()) { var b = Wr.T(); b.show(); var c = J("zm-topic-search-input-new"); c.value && Zr(b, c.value); b.Oa.data.length || b.Oa.$j(hh[0]) } }, j); a.Gy = function (b) { T.call(this, b) }; y(Gy, T); Gy.prototype.w = function () { this.g = this.L().w("FORM", { method: "POST", style: "display:none" }) }; Gy.prototype.post = function (b, c, d) { var e = this.m(); e || (this.Y(), e = this.m()); e.action = c || ""; e.target = d || ""; var c = e, g, h = new Ts; for (g in b) d = b[g], na(d) ? z.forEach(d, v(this.IB, this, h, g)) : this.IB(h, g, d); c.innerHTML = h.toString(); e.submit() }; Gy.prototype.IB = function (b, c, d) { b.append('<input type="hidden" name="', Va(c), '" value="', Va(d), '">') }; a.Hy = function (b) { return $.get("/node/ExploreAnswerListV2", { params: JSON.stringify({ offset: b, type: "day" }) }) }, a.Iy = function (b) { return $.get("/node/ExploreHotFavlistsInnerV2", { params: JSON.stringify({ offset: b }) }) }, a.Jy = function (b) { return $.get("/node/ExploreAnswerListV2", { params: JSON.stringify({ offset: b, type: "month" }) }) }; a.Ky = function () { M.call(this) }; y(Ky, yn); Ky.prototype.B = function () { var b = bt(new vf(window.location.href), "group_id"); b && (this.Gj = new V(m), P(this.h(), this.Gj, "success", this.Uy), b && this.Gj.ajax("/noti7/read", "group_id=" + b, "POST")) }; Ky.prototype.Uy = function () { var b = Ie(this.Gj); if (b && !b.r && b.msg) { var c = b.msg; if (c === j || "true" === c || "True" === c) return; this.UP = b.msg; this.dispatchEvent("change") } (b = Un) && Vn(b) }; a.Ly = function () { T.call(this); var b = jh || [0, 0]; this.ls = b[0]; this.visible = !!b[1]; this.Tg = "collection" }; y(Ly, T); t = Ly.prototype; t.B = function () { zs.J(this); this.o(document.body) };
        t.C = function () {
            Ly.n.C.call(this); var b = H("zh-list-side-head"); if (b) { var c = J("zu-entry-focus-button", b); (this.jM = c) && this.h().e(c, "click", function () { on(c, "favlist", "", ["zg-btn-green", "zg-btn-white"]) }); (this.Wf = H("zh-list-operation-menu")) && this.h().e(this.Wf, "click", this.Pz) } (b = H("zh-single-answer-author-info")) && (new yy(b)).B(); (b = H("zh-list-create-new-list")) && this.h().e(b, "click", this.eT); (b = H("zh-fav-list-side-bar-creator")) && (new yy(b)).B(); (b = H("zh-fav-list-side-bar-report")) && this.h().e(b,
            "click", this.Nl); (this.pk = H("zh-favlist-webshare-container")) && this.h().e(this.pk, "click", this.Sz); if (this.nc = H("zh-list-meta-wrap")) this.h().e(this.nc, "click", this.Nl), this.yX = H("zh-list-comment-num"), bt(new vf(location.href), "fc") && My(this); (b = H("zh-favlists-wrap")) && (new Xx(b, k, "favlist", k, j)).B(); if (b = H("zh-list-answer-wrap")) {
                $(b).on("click", "a[name=unfavo]", $.proxy(this.ZN, this)); var d = new Bu({ bh: m }); this.J(d); d.pa("childConstructor", { Li: bx }).pa("expandLimit"); d.o(b); this.h().e(d, "click!", function (b) {
                    "comment" ===
                    b.namespace && b.Qc.fill("category", this.Tg).fill("label", "collection_answer")
                })
            } (b = H("zh-favlist-log-list-wrap")) && (new Xx(b, k, "favlist", k, j)).B(); (b = H("zh-favlist-following-wrap")) && (new Xx(b, k, "favlist", k, j)).B(); if (b = H("zh-favlist-followers-wrap")) b = new Xx(b, k, "people", ["zg-btn-follow", "zg-btn-unfollow"], j), b.Yg("zm-profile-section-item"), b.JA(j), b.B(); this.h().e(window, "hashchange", this.VY); this.rx(); this.ro = new Ky; this.ro.B()
        };
        t.ZN = function (b) { var b = b.target, c = b.id.split("-"), d = c[1], c = c[2]; (new V(j)).ajax("/collection/remove", "answer_id=" + d + "&favlist_id=" + c); if (c = Jc(b, "div", "zm-item")) b = Wb("zm-item-answer", c), 1 === b.length ? L(c) : (b = z.find(b, function (b) { return b.getAttribute("data-aid") === d })) && L(b.parentNode) }; t.Sz = function (b) { var b = Kk(this.pk, b.target), c = location.pathname.match(/^\/collection\/(\w+)/); b && (b.name && c) && new jv(["分享收藏夹", "collection", c[1], { fid: jh[0] }], "tb-webshare-" + b.name) }; t.eT = mn(function () { lx().show() }, j);
        t.Pz = function (b) { this.My ? this.fb.S() ? this.fb.F(m) : (this.fb.F(j), b.stopPropagation(), b.preventDefault(), this.Hk()) : (b.stopPropagation(), b.preventDefault(), this.pj(), this.Hk()); this.My = j }; t.Hk = function () { P(this.h(), document, "click", function () { this.fb.F(m) }) }; t.pj = function () { var b = H("zh-list-side-head"); this.fb = new Ru; this.ax = j; this.visible || this.fb.Ga(this.oR = new Ou("设置为公开")); this.fb.Ga(this.jR = new Ou("删除此收藏夹")); this.ax && (this.fb.Y(b), this.h().e(this.fb, "action", this.hj)) };
        t.Nl = function (b) { b = b.target; switch (b && b.name) { case "report-favlist": Eu("favlist", this.ls); break; case "edit": tx(lx()); break; case "addcomment": My(this); this.ra.yf(); this.ra.lc() && this.ra.oi("view_comments", parseInt(Gc(b), 10) || 0); break; case "remove": Ny(this) } };
        t.hj = function (b) { b.target === this.oR ? Di("确定设置收藏夹为公开？", "收藏夹设置为公开后，将不能再设置为私密。", function (b) { b && (this.KY = !this.visible, this.oI = new V(j), this.h().e(this.oI, "complete", function () { window.location.reload() }), this.oI.ajax("/collection/update", "favlist_id=" + this.ls + "&is_public=1")) }, this) : b.target === this.jR && Ny(this) }; a.Ny = function (b) { Di("删除收藏夹", "你确定要删除这个收藏夹吗？", function (b) { b && (b = new Lk, b.add("favlist_id", this.ls), b.add("_xsrf", (new Kf(document)).get("_xsrf")), (new Gy).post($s(b), "/collection/delete")) }, b) };
        t.rx = function () { var b = 1, c = $("ul.hot-favlists"), d = k; $("#js-hot-fav-switch").click(function () { d && "pending" === d.state() || (b = 5 <= b ? 1 : b + 1, d = Iy(b).done(function (b) { c.html(b) })) }) }; a.My = function (b) { b.ra || (b.ra = new Iw(b.ls, "favlist"), b.J(b.ra), b.h().e(b.ra, "click!", function (b) { "comment" === b.namespace && (b.Qc.fill("category", this.Tg).fill("label", "collection"), b.Qc.action = b.Qc.action.replace("favlist", "collection")) }), Mw(b.ra, b.nc, $(".toggle-comment", b.nc)[0])) }; a.Oy = function (b, c, d) { Su.call(this, b, c, d) }; y(Oy, Su); Oy.prototype.mf = function (b) { b && !b.r && (b = b.msg, b.length ? (Q(this.bc, 0 < b.length), this.offset += b.length, this.hq(b), Vu(this, m), Yu(this)) : this.vk.hide()) }; a.Py = { ROUNDTABLE_ADD_RELATED: "roundtable", ARTICLE_VOTE_UP: "post_vote", ARTICLE_CREATE: "post_create", RECOMMENDED: "feed_recommended", QUESTION_FOLLOW: "feed_question_follow", QUESTION_CREATE: "feed_question", ANSWER_VOTE_UP: "feed_answer_vote", ANSWER_CREATE: "feed_answer_answer" };
        Oy.prototype.YN = function (b) { var c = b.currentTarget.g.getAttribute("data-feedtype"), c = Py[c]; "comment" === b.namespace && c && b.Qc.fill("category", "feed").fill("label", c) }; Oy.prototype.Ij = function (b) { var c = hx(b); this.J(c); this.h().e(c, "click!", this.YN); c.o(b); return c }; Oy.prototype.OG = function (b) { return { params: b, method: "next" } }; a.Qy = function () { this.interval = 3E4 }; ia(Qy); a.Sy = function (b, c) { if (!b.Cc || c) c && clearInterval(b.Cc), b.Cc = setInterval(v(function () { Ry(this) }, b), b.interval) }, a.Ry = function (b, c) { $(".feed-item-hook .time").each(function () { $(this).text(Wt($(this).data("timestamp"))) }); c && Sy(b, c) }; a.Ty = function () { T.call(this); this.Jx = {}; this.Bs = []; this.WO = "old" === $("#feed-ver").val(); this.bF = !!$("#is-topstory").length; this.gP = !!$("#is-topstory2").length; this.qD = this.WO ? "zm-item" : "feed-item-hook"; window._gaq = window._gaq || []; this.bF ? window._gaq.push(["_setCustomVar", 5, "is_topstory", j, 3]) : window._gaq.push(["_setCustomVar", 5, "is_topstory", m, 3]) }; y(Ty, T); t = Ty.prototype;
        t.C = function () {
            Ty.n.C.call(this); this.K = $(this.g); if (this.we = H("zh-main-feed-fresh-button")) this.Mp = $(this.we), this.gP ? (this.h().e(this.we, "click", this.cS), this.h().e(Y, "topstory2", this.oE)) : this.bF ? (this.h().e(this.we, "click", this.bS), this.h().e(Y, "topstory", this.oE)) : (this.h().e(this.we, "click", this.iT), this.h().e(Y, "homefeed", this.CN)); this.Pa = new Oy(this.g, k, j); this.getParent() && this.getParent().J(this.Pa); var b = "/node/" + $(this.g).data("init").nodename; this.Pa.url = b; this.Pa.Yg("feed-item-hook");
            this.h().e(this.Pa, "itemcreated", function (b) { Uy(this, b.data.kP) }).e(this.Pa, "afterload", function (b) { Y.V({ type: "ga_click_feed_more", data: b.data }) }).e(this.Pa, "ignore", function (b) { var c = b.key, g = b.value; F.forEach(this.Jx, function (b) { b.br[c] === g && $(b.g).fadeOut(150) }) }); this.Pa.B(); this.K.on("click", ".js-more-similar", function () { $(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast") }); var c = this; this.K.on("click", ".js-change-some", function () {
                Ok("feed", "intrests-change"); var b = $(this),
                e = $(this).parent().parent(); $.post("/node/HomeExtraFeedList", { method: "next", params: {} }).done(function (g) { !g.r && g.msg && (0 < g.msg.length ? (e.find(".feed-item-hook").remove(), e.append(g.msg).find(".feed-item-hook").each(function () { c.Pa.Ij(this) })) : b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>')) })
            })
        }; t.bS = function () { this.Mp.text("加载中…"); this.mi = 0; var b = this; this.Pa.offset = 0; this.Pa.dh = 0; Xu(this.Pa, j, function () { Ph(b.Pa, function (b) { $(b.m()).remove() }) }).done(function () { b.Mp.hide(); Uu(b.Pa) }) };
        t.cS = function () { this.Mp.text("加载中…"); var b = this.mi; this.mi = 0; var c = this; this.Pa.offset = b; this.Pa.dh = "live"; Xu(this.Pa, j, k, function (b) { b && b.msg.length && (c.Pa.hq(b.msg, "prepend"), c.Mp.hide()) }) };
        t.iT = function () {
            var b = J("zm-home-question-list-devider", this.g); b && E.remove(b, "zm-home-question-list-devider"); var b = this.Bs.length, c = $("." + this.qD, this.g)[0]; c && 5 <= b && ($(".feed-separator-hook", this.g).next(".feed-item-hook").css("border-top", "1px solid #eee").end().remove(), $(c).css("border-top", "none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>')); z.forEach(this.Bs, function (b) { var c = $("." + this.qD, this.g)[0]; c ? kc(b, c) : this.g.appendChild(b) },
            this); this.Bs = []; Q(this.we, m); c = Qy.T(); Ry(c, j); Y.V({ type: "ga_click_feed_fresh", data: { count: b } })
        };
        t.CN = function (b) { var c = La(b.pc), b = this.Bs, d = b.length; if (c && !(500 < d)) { var e = gc(c), c = this.Jx; if (!F.jr(c, function (b) { return b.m().id === e.id })) { var g = this.Pa.Ij(e); if (g.qa) { if (F.jr(c, function (b) { return b.qa === g.qa })) return } else if (g.la) { if (F.jr(c, function (b) { return b.la === g.la })) return } else if (g.vb && F.jr(c, function (b) { return b.vb === g.vb })) return; Uy(this, g); b.push(e); d += 1; this.we && (this.we.innerHTML = (99 < d ? "99+" : d) + " 条新动态", Q(this.we, j)) } } };
        t.oE = function (b) { this.mi = this.mi || 0; this.mi += +b.pc; this.we && (this.we.innerHTML = (99 < this.mi ? "99+" : this.mi) + " 条新动态", Q(this.we, j)) }; a.Uy = function (b, c) { var d = Jh(Ih.T()); b.Jx[d] = c; $(c.g).attr("data-fid", d) }; a.Vy = function () { }; y(Vy, T); t = Vy.prototype; t.C = function () { Vy.n.C.call(this); var b = H("zh-invite-select"); b && this.h().e(b, "change", this.Fy); (b = J("zm-invite-list")) && this.h().e(b, "click", this.ka); (this.gx = H("zh-invite-ignore-all-btn")) && this.h().e(this.gx, "click", this.rO) };
        t.ka = function (b) {
            if ((b = b.target) && b.name) {
                if ("ignore" === b.name) { this.mY = b; this.nY = j; E.add(b, "zg-btn-disabled"); this.sO = new V(m); var c = "qid=" + b.getAttribute("data-qid") + "&uid=" + S[3] + "&op=pass"; this.sO.ajax("/question/askpeople", c, "POST"); (c = b.parentNode) && bj(c, j) } "recover" === b.name && !this.YG && (this.WG = b, this.YG = j, E.add(b, "zg-btn-disabled"), b.innerHTML = "...", this.XG = new V(m), this.h().e(this.XG, "success", this.UJ), b = "qid=" + b.getAttribute("data-qid") + "&uid=" + S[3] + "&op=recover", this.XG.ajax("/question/askpeople",
                b, "POST"))
            }
        }; t.Fy = function (b) { var c = bt(new vf(location.href), "filter_by"); if ((b = b.target) && b.value) b = b.value, b !== c && (window.location.href = "/question/invited?filter_by=" + b) }; t.UJ = function () { this.YG = m; this.cc(this.WG, "ignore"); this.WG.name = "ignore" };
        t.cc = function (b, c) { var d = b.parentNode, e = J("zm-invite-item-info-label", d); "ignore" === c ? (E.remove(b, "zg-btn-disabled"), E.remove(b, "recover"), E.add(b, "ignore"), E.add(d, "invite"), E.remove(d, "ignore"), e.innerHTML = "新邀请", b.name = "ignore", b.innerHTML = "忽略") : (E.remove(b, "zg-btn-disabled"), E.remove(b, "ignore"), E.add(b, "recover"), E.remove(d, "invite"), E.remove(d, "draft"), E.add(d, "ignore"), e.innerHTML = "已忽略", b.name = "recover", b.innerHTML = "恢复") };
        t.rO = function () { this.hx || (this.hx = j, this.DE = new V(m), this.h().e(this.DE, "success", this.OJ), this.DE.ajax("/question/askpeople", "uid=" + S[3] + "&op=ignore_all", "POST")) }; t.OJ = function () { this.hx = m; Q(this.gx); this.hx = m; z.forEach(Wb("zm-invite-item-control"), v(function (b) { this.cc(b, "recover") }, this)) }; a.Wy = function () { T.call(this) }; y(Wy, T); Wy.prototype.C = function () { Wy.n.C.call(this); this.nl(); this.h().e(this.g, "click", this.ka) }; Wy.prototype.ka = function (b) { b = b.target; if (b.name) switch (b.name) { case "fold": $(b).parent().hide().prev().animate({ height: "show" }, 200); break; case "fold-follow": $(b).parent().hide().prev().show(); break; case "unfold-item": $(b).parent(".author-list").hide().siblings(".hidden").show() } };
        Wy.prototype.nl = function () { this.fo || (this.fo = j, this.Cj = new V(m), this.h().e(this.Cj, "success", this.By), this.Cj.ajax("/noti7/calendar", "", "GET")) }; Wy.prototype.By = function () { this.fo = m; var b = He(this.Cj); if (b) { var c = H("zh-noti7-list-inner"); /category/.test(b) ? (c.innerHTML = b, c && (b = new Su(c, "/noti7/calendar", j), b.hq = function (b) { var c = K("div", "zm-item-more-wrap"); c.innerHTML = b; kc(c, this.bc) }, b.Cr = function (b) { this.dh = this.bc.getAttribute("data-next"); return !b || b.msg[0] && b.msg[1] }, b.B())) : c.innerHTML = '<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>' } }; a.Xy = function () { M.call(this); this.dx = []; this.OC = [] }; y(Xy, yn); Xy.prototype.B = function () { var b = H("home-suggest-block"); b && (this.g = b, b = H("home-suggest-close-button"), P(this.h(), b, "click", function () { (new V(j)).ajax("/option", "key=no_show_lookup&value=1"); Q(this.g, m) }), b = H("home-suggest-refresh-button"), this.h().e(b, "click", this.PQ), this.qs = H("home-suggest-list"), Yy(this)) }; Xy.prototype.PQ = function () { Zy(this); return j };
        a.Zy = function (b) { for (var c = [], d = 0; 3 > d; d++) { var e = b.OC.shift(); e && c.push(e) } 3 === c.length ? (b.qs.innerHTML = c.join(""), c = Wb("suggest-item", b.qs), z.forEach(c, function (b) { this.dx.push(b.id.split("-")[1]) }, b)) : Yy(b) }, a.Yy = function (b) { b.qs.innerHTML = '<img class="bubble-loading" src="http://static.zhihu.com/static/img/noti-loading.gif">'; $.post("/lookup/suggest_member", { ids: b.dx.join(",") }).done(v(b.lQ, b)) };
        Xy.prototype.lQ = function (b) { b.r || ((b = b.msg) && ma(b) && b.length ? (this.dx = [], this.OC = b, Zy(this)) : this.qs.innerHTML = "") }; a.$y = function () { T.call(this) }; y($y, T); $y.prototype.B = function () { zs.J(this); this.o(document.body) };
        $y.prototype.C = function () {
            $y.n.C.call(this); var b = H("js-home-feed-list"); if (b) { var c = new Ty; this.J(c); c.o(b) } (b = J("zm-invite-container")) && (new Vy).o(b); H("home-settings-page-wrap") && (b = H("zh-topic-block-editor")) && (new Ft(kh)).o(b); (b = H("zh-noti7")) && (new Wy).o(b); if (c = H("zm-home-sidebar-domain-entry-link")) b = !!c.getAttribute("data-expanded"), c = new Bp(c, H("zm-home-sidebar-domain-entry-nav"), b), b && xd(c, "toggle", function () { Gi("/notifeature?feature=4", k, "GET"); return j }); $(".zm-side-pinned-topics").on("click",
            ".unpin", function () { var b = $(this).parent(); $.post("/pin-topic/remove", { tid: $(this).attr("data-tid") }).done(function (c) { c.r || b.fadeOut() }) }); if (b = $("#zh-virgin-answer-list > .zh-general-list").get(0)) c = new Bu, this.J(c), c.pa("nodeSource").pa("childConstructor", { Li: bx }), c.o(b), this.h().e(c, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("category", "debuts").fill("label", "debuts") }); (new Xy).B(); var b = S[1], d = H("zu-welcome-once"); d && ("welcome" === location.hash.slice(1) ? (Q(d, j), Nf.set("reg_noti_",
            b, 86400)) : b === Nf.get("reg_noti_") && Q(d, j), N(J("x-m", d), "click", function () { location.hash = ""; L(d); Nf.remove("reg_noti_") })); var e = $("#js-global-notify"); if (e.length) { var g = new ur; g.o(e[0]); Ws(g); $(".zu-global-notify-close", e).click(function () { var b = $(this).data("id"); $.post("/notice/read", { nid: b }); g.H(); e.remove() }) } b = Qy.T(); Sy(b); var h = $("#js-debuts-entry .tour"); h.length && $(".close-button", h).click(function () { var b = $(this).data("feature"); $.get("/notifeature", { feature: b }); h.fadeOut(100, function () { h.remove() }) })
        }; a.az = function () { Xh.call(this, k, m); this.YB = "zh-lightbox-showing"; this.OT = "zh-lightbox-thumb"; this.Jg() }; y(az, Xh); ia(az); t = az.prototype; t.Jg = function () { this.h().e(document, "click", this.tr) };
        t.tr = function (b) {
            b = b.target; if ("IMG" === b.tagName && E.has(b, this.OT)) {
                var c = b.getAttribute("data-original"); if (c) if (sb) window.open(c); else if (!Jc(b, k, "editable")) {
                    this.Ja('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="' + c + '" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="' + c + '" target="_blank">查看原图</a></div></div></div>'); this.F(j); E.add(this.m(), "zm-light-box-fullscreen-image");
                    var c = Zb(), d = H("zm-light-box-x1"), e = H("zm-light-box-x2"), g = b.getAttribute("data-rawheight"), h = b.getAttribute("data-rawwidth"), h = h ? +h : 0; (g ? +g : 0) > c.height - 80 ? e.style.marginTop = "40px" : d.style.lineHeight = c.height + "px"; e.style.width = h > c.width - 80 ? c.width - 80 + "px" : h + "px"; Y.V({ type: "ga_click_enlarge_image", target: b })
                }
            }
        }; t.ma = ha; t.focus = ha; t.oN = function () { this.F(m); E.remove(document.body, this.YB) }; t.bi = function () { az.n.bi.call(this); E.add(document.body, this.YB); P(this.h(), document, "click", this.oN) };
        t.w = function () { az.n.w.call(this); E.add(this.m(), "zm-light-box") }; t.cy = function () { this.Rc = this.L().w("div", this.Gc + "-bg zm-light-box-background"); Q(this.Rc, m) }; az.T(); a.bz = function (b, c, d) { Ou.call(this, b, c, d); this.li(j) }; y(bz, Ou); bz.prototype.$d = function () { return this.dispatchEvent("action") }; gp("goog-option", function () { return new bz(k) }); a.cz = function () { }; y(cz, Ep); ia(cz); cz.prototype.w = function (b) { return b.L().w("div", this.M() + " goog-inline-block", " ") }; cz.prototype.o = function (b, c) { c = cz.n.o.call(this, b, c); E.add(c, "goog-inline-block"); return c }; cz.prototype.M = s("goog-toolbar-separator"); a.dz = function () { }; y(dz, Gp); ia(dz); dz.prototype.xc = function () { return Wc.rJ }; dz.prototype.xn = function (b) { return "HR" == b.tagName ? new Fp(cz.T()) : dz.n.xn.call(this, b) }; dz.prototype.M = s("goog-toolbar"); dz.prototype.ow = function () { return Ip }; a.ez = function () { }; y(ez, ep); ia(ez); t = ez.prototype; t.w = function (b) { var c = { "class": "goog-inline-block " + this.df(b).join(" "), title: b.Of() || "" }, c = b.L().w("div", c, this.Ii(b.eb(), b.L())); bp(this, b, c); return c }; t.xc = function () { return Wc.Qp }; t.Z = function (b) { return b && b.firstChild.firstChild }; t.Ii = function (b, c) { return c.w("div", "goog-inline-block " + (this.M() + "-outer-box"), c.w("div", "goog-inline-block " + (this.M() + "-inner-box"), b)) }; t.vc = function (b) { return "DIV" == b.tagName };
        t.o = function (b, c) { fz(c, j); fz(c, m); var d; a: { d = b.L().LD(c); var e = this.M() + "-outer-box"; if (d && E.has(d, e) && (d = b.L().LD(d), e = this.M() + "-inner-box", d && E.has(d, e))) { d = j; break a } d = m } d || c.appendChild(this.Ii(c.childNodes, b.L())); E.add(c, "goog-inline-block", this.M()); return ez.n.o.call(this, b, c) }; t.M = s("goog-custom-button");
        a.fz = function (b, c) { if (b) for (var d = c ? b.firstChild : b.lastChild, e; d && d.parentNode == b;) { e = c ? d.nextSibling : d.previousSibling; if (3 == d.nodeType) { var g = d.nodeValue; if ("" == La(g)) b.removeChild(d); else { d.nodeValue = c ? g.replace(/^[\s\xa0]+/, "") : Ma(g); break } } else break; d = e } }; a.gz = function () { }; y(gz, ez); ia(gz); gz.prototype.M = s("goog-toolbar-button"); a.hz = function (b, c, d) { pp.call(this, b, c || gz.T(), d) }; y(hz, pp); gp("goog-toolbar-button", function () { return new hz(k) }); a.iz = function () { }; y(iz, ez); ia(iz); B && (iz.prototype.Ja = function (b, c) { var d = iz.n.Z.call(this, b && b.firstChild); d && nc(this.createCaption(c, Tb(b)), d) }); t = iz.prototype; t.Z = function (b) { b = iz.n.Z.call(this, b && b.firstChild); B && (b && b.__goog_wrapper_div) && (b = b.firstChild); return b }; t.o = function (b, c) { var d = Vb("*", "goog-menu", c)[0]; if (d) { Q(d, m); Sb(d).body.appendChild(d); var e = new Ru; e.o(d); b.Zg(e) } return iz.n.o.call(this, b, c) };
        t.Ii = function (b, c) { return iz.n.Ii.call(this, [this.createCaption(b, c), c.w("div", "goog-inline-block " + (this.M() + "-dropdown"), " ")], c) }; t.createCaption = function (b, c) { return jz(b, this.M(), c) }; a.jz = function (b, c, d) { return d.w("div", "goog-inline-block " + (c + "-caption"), b) }; t.M = s("goog-menu-button"); a.kz = function () { }; y(kz, iz); ia(kz); kz.prototype.createCaption = function (b, c) { return kz.n.createCaption.call(this, lz(b, c), c) }; a.lz = function (b, c) { return c.w("div", "goog-color-menu-button-indicator", b) }; kz.prototype.Ba = function (b, c) { b && mz(this.Z(b), c) }; a.mz = function (b, c) { if (b && b.firstChild) { var d; d = c && (lt.test("#" == c.charAt(0) ? c : "#" + c) || vt(c).length || xt && xt[c.toLowerCase()]) ? gu(c).Er : k; b.firstChild.style.borderBottomColor = d || (A ? "" : "transparent") } };
        kz.prototype.De = function (b) { this.Ba(b.m(), b.X()); E.add(b.m(), "goog-color-menu-button"); kz.n.De.call(this, b) }; a.nz = function () { }; y(nz, $o); ia(nz); a.oz = 0; t = nz.prototype; t.w = function (b) { var c = this.df(b); return b.L().w("div", c ? c.join(" ") : k, pz(this, b.eb(), b.ql(), b.L())) }; a.pz = function (b, c, d, e) { for (var g = [], h = 0, l = 0; h < d.height; h++) { for (var n = [], q = 0; q < d.width; q++) { var r = c && c[l++]; n.push(qz(b, r, e)) } g.push(e.w("tr", b.M() + "-row", n)) } return b.lv(g, e) }; t.lv = function (b, c) { var d = c.w("table", this.M() + "-table", c.w("tbody", this.M() + "-body", b)); d.cellSpacing = 0; d.cellPadding = 0; Nc(d, "grid"); return d };
        a.qz = function (b, c, d) { b = d.w("td", { "class": b.M() + "-cell", id: b.M() + "-cell-" + oz++ }, c); Nc(b, "gridcell"); return b }; t.vc = s(m); t.o = s(k);
        t.Ja = function (b, c) { if (b) { var d = Vb("tbody", this.M() + "-body", b)[0]; if (d) { var e = 0; z.forEach(d.rows, function (b) { z.forEach(b.cells, function (b) { jc(b); if (c) { var d = c[e++]; d && b.appendChild(d) } }) }); if (e < c.length) { for (var g = [], h = Tb(b), l = d.rows[0].cells.length; e < c.length;) { var n = c[e++]; g.push(qz(this, n, h)); g.length == l && (n = h.w("tr", this.M() + "-row", g), d.appendChild(n), g.length = 0) } if (0 < g.length) { for (; g.length < l;) g.push(qz(this, "", h)); n = h.w("tr", this.M() + "-row", g); d.appendChild(n) } } } tg(b, j, B) } };
        a.rz = function (b, c, d) { for (c = c.m() ; d && 1 == d.nodeType && d != c;) { if ("TD" == d.tagName && E.has(d, b.M() + "-cell")) return d.firstChild; d = d.parentNode } return k }, a.sz = function (b, c, d, e) { d && (d = d.parentNode, E.enable(d, b.M() + "-cell-hover", e), Oc(c.m().firstChild, "activedescendent", d.id)) }; t.M = s("goog-palette"); a.uz = function (b) { M.call(this); this.Dd = []; tz(this, b) }; y(uz, Hd); t = uz.prototype; t.cg = k; t.qf = k; t.ml = function () { return this.Dd.length }; t.Mh = function (b) { return this.Dd[b] || k }; a.tz = function (b, c) { c && (z.forEach(c, function (b) { this.hm(b, m) }, b), z.extend(b.Dd, c)) }; t.Ga = function (b) { this.zi(b, this.ml()) }; t.zi = function (b, c) { b && (this.hm(b, m), z.Qn(this.Dd, b, c)) }; t.removeItem = function (b) { b && z.remove(this.Dd, b) && b == this.cg && (this.cg = k, this.dispatchEvent("select")) }; t.Eg = p("cg"); t.Mb = function () { return z.clone(this.Dd) };
        t.sf = function (b) { b != this.cg && (this.hm(this.cg, m), this.cg = b, this.hm(b, j)); this.dispatchEvent("select") }; t.pl = function () { return this.cg ? z.indexOf(this.Dd, this.cg) : -1 }; t.ap = function (b) { this.sf(this.Mh(b)) }; t.clear = function () { z.clear(this.Dd); this.cg = k }; t.z = function () { uz.n.z.call(this); delete this.Dd; this.cg = k }; t.hm = function (b, c) { b && ("function" == typeof this.qf ? this.qf(b, c) : "function" == typeof b.lm && b.lm(c)) }; a.vz = function (b, c, d) { ip.call(this, b, c || nz.T(), d); this.Ci &= -89 }; y(vz, ip); t = vz.prototype; t.qc = k; t.Gb = -1; t.na = k; t.z = function () { vz.n.z.call(this); this.na && (this.na.H(), this.na = k); this.qc = k }; t.jm = function (b) { vz.n.jm.call(this, b); wz(this); this.na ? (this.na.clear(), tz(this.na, b)) : (this.na = new uz(b), b = v(this.hm, this), this.na.qf = b, this.h().e(this.na, "select", this.ij)); this.Gb = -1 }; t.Cg = s(""); t.im = ba();
        t.kd = function (b) { vz.n.kd.call(this, b); var c = rz(this.N, this, b.target); (!c || !b.relatedTarget || !tc(c, b.relatedTarget)) && c != xz(this) && yz(this, c) }; t.Oh = function (b) { vz.n.Oh.call(this, b); var c = rz(this.N, this, b.target); (!c || !b.relatedTarget || !tc(c, b.relatedTarget)) && c == xz(this) && sz(this.N, this, c, m) }; t.Ae = function (b) { vz.n.Ae.call(this, b); this.ac() && (b = rz(this.N, this, b.target), b != xz(this) && yz(this, b)) }; t.$d = function (b) { var c = xz(this); return c ? (this.sf(c), vz.n.$d.call(this, b)) : m };
        t.Zb = function (b) {
            var c = this.eb(), c = c ? c.length : 0, d = this.qc.width; if (0 == c || !this.isEnabled()) return m; if (13 == b.keyCode || 32 == b.keyCode) return this.$d(b); if (36 == b.keyCode) return this.Qb(0), j; if (35 == b.keyCode) return this.Qb(c - 1), j; var e = 0 > this.Gb ? this.pl() : this.Gb; switch (b.keyCode) {
                case 37: -1 == e && (e = c); if (0 < e) return this.Qb(e - 1), b.preventDefault(), j; break; case 39: if (e < c - 1) return this.Qb(e + 1), b.preventDefault(), j; break; case 38: -1 == e && (e = c + d - 1); if (e >= d) return this.Qb(e - d), b.preventDefault(), j; break; case 40: if (-1 ==
                e && (e = -d), e < c - d) return this.Qb(e + d), b.preventDefault(), j
            } return m
        }; t.ij = ba(); t.ql = p("qc"); a.zz = function (b, c) { b.m() && f(Error("Component already rendered")); b.qc = pa(c) ? new Pb(c, i) : c; wz(b) }, a.xz = function (b) { var c = b.eb(); return c && c[b.Gb] }; t.Qb = function (b) { b != this.Gb && (Az(this, this.Gb, m), this.Gb = b, Az(this, b, j)) }; a.yz = function (b, c) { var d = b.eb(); b.Qb(d ? z.indexOf(d, c) : -1) }; t.pl = function () { return this.na ? this.na.pl() : -1 }; t.Eg = function () { return this.na ? this.na.Eg() : k }; t.ap = function (b) { this.na && this.na.ap(b) };
        t.sf = function (b) { this.na && this.na.sf(b) }; a.Az = function (b, c, d) { if (b.m()) { var e = b.eb(); e && (0 <= c && c < e.length) && sz(b.N, b, e[c], d) } }; t.hm = function (b, c) { this.m() && b && E.enable(b.parentNode, this.N.M() + "-cell-selected", c) }; a.wz = function (b) { var c = b.eb(); if (c) if (b.qc && b.qc.width) { if (c = Math.ceil(c.length / b.qc.width), !pa(b.qc.height) || b.qc.height < c) b.qc.height = c } else c = Math.ceil(Math.sqrt(c.length)), b.qc = new Pb(c, c); else b.qc = new Pb(0, 0) }; a.Bz = function (b, c, d) { this.Dq = b || []; vz.call(this, k, c || nz.T(), d); this.Dq = this.Dq; this.Ds = k; this.Ja(z.map(this.Dq, function (b) { var c = this.L().w("div", { "class": this.N.M() + "-colorswatch", style: "background-color:" + b }); "#" == b.charAt(0) && (b = wt(b), b = "RGB (" + [parseInt(b.substr(1, 2), 16), parseInt(b.substr(3, 2), 16), parseInt(b.substr(5, 2), 16)].join(", ") + ")"); c.title = b; return c }, this)) }; y(Bz, vz); Bz.prototype.Ds = k; Bz.prototype.zw = function () { var b = this.Eg(); return b ? (b = lu(b, "background-color"), Cz(b)) : k };
        Bz.prototype.$o = function (b) { b = Cz(b); this.Ds || (this.Ds = z.map(this.Dq, function (b) { return Cz(b) })); this.ap(b ? z.indexOf(this.Ds, b) : -1) }; a.Cz = function (b) { if (b) try { return gu(b).Er } catch (c) { } return k }; a.Dz = function (b, c, d, e) { Rt.call(this, b, c, d || e); if (d || e) this.km(65 | (e ? 32 : 132)) }; y(Dz, Rt); a.Ez = function (b, c, d, e) { pp.call(this, b, d || iz.T(), e); lp(this, 64, j); this.Jl = new Dz(k, 5); c && this.Zg(c); this.GF = k; this.oa = new Jd(500); if ((Mg || Ng) && !Eb("533.17.9")) this.as = j }; y(Ez, pp); t = Ez.prototype; t.as = m; t.am = m; t.C = function () { Ez.n.C.call(this); this.ta && Fz(this, this.ta, j); Oc(this.m(), Vc.xk, "true") }; t.jb = function () { Ez.n.jb.call(this); if (this.ta) { this.rb(m); this.ta.jb(); Fz(this, this.ta, m); var b = this.ta.m(); b && L(b) } }; t.z = function () { Ez.n.z.call(this); this.ta && (this.ta.H(), delete this.ta); delete this.MR; this.oa.H() };
        t.Ae = function (b) { Ez.n.Ae.call(this, b); this.ac() && (this.rb(!this.pb(), b), this.ta && (b = this.pb(), this.ta.Uf = b)) }; t.Pf = function (b) { Ez.n.Pf.call(this, b); this.ta && !this.ac() && (this.ta.Uf = m) }; t.$d = function () { this.setActive(m); return j }; t.XM = function (b) { this.ta && (this.ta.S() && !this.Cf(b.target)) && this.rb(m) }; t.Cf = function (b) { return b && tc(this.m(), b) || this.ta && this.ta.Cf(b) || m };
        t.ff = function (b) { if (32 == b.keyCode) { if (b.preventDefault(), "keyup" != b.type) return j } else if ("key" != b.type) return m; if (this.ta && this.ta.S()) { var c = this.ta.Zb(b); return 27 == b.keyCode ? (this.rb(m), j) : c } return 40 == b.keyCode || 38 == b.keyCode || 32 == b.keyCode || 13 == b.keyCode ? (this.rb(j), j) : m }; t.En = function () { this.rb(m) }; t.yN = function () { this.ac() || this.rb(m) }; t.Uc = function (b) { this.as || this.rb(m); Ez.n.Uc.call(this, b) }; t.Za = function () { this.ta || this.Zg(new Ru(this.L())); return this.ta || k };
        t.Zg = function (b) { var c = this.ta; if (b != c && (c && (this.rb(m), this.Aa && Fz(this, c, m), delete this.ta), b)) { this.ta = b; Oh(b, this); b.F(m); var d = this.as; (b.Fm = d) && b.Ne(j); this.Aa && Fz(this, b, j) } return c }; a.Gz = function (b) { b.GF = new Of(7, 0, 7, 0) }; t.Ga = function (b) { this.Za().J(b, j) }; t.zi = function (b, c) { this.Za().Ak(b, c, j) }; t.removeItem = function (b) { (b = this.Za().removeChild(b, j)) && b.H() }; t.Mh = function (b) { return this.ta ? Rh(this.ta, b) : k }; t.ml = function () { return this.ta ? Qh(this.ta) : 0 };
        t.F = function (b, c) { var d = Ez.n.F.call(this, b, c); d && !this.S() && this.rb(m); return d }; t.$a = function (b) { Ez.n.$a.call(this, b); this.isEnabled() || this.rb(m) }; a.Hz = function (b) { b.Jl.km && b.Jl.km(33) }; t.HH = function () { this.rb(j) };
        t.rb = function (b, c) {
            Ez.n.rb.call(this, b); if (this.ta && !!(this.aa & 64) == b) {
                if (b) this.ta.Aa || (this.am ? this.ta.Y(this.m().parentNode) : this.ta.Y()), this.lk = fg(this.m()), this.Ei = pg(this.m()), Iz(this), this.ta.Qb(-1); else if (this.setActive(m), this.ta.Uf = m, this.m() && Oc(this.m(), Vc.Am, ""), this.Ms != k) { this.Ms = i; var d = this.ta.m(); d && mg(d, "", "") } this.ta.F(b, m, c); if (!this.zg) {
                    var d = this.h(), e = b ? d.e : d.Fa; e.call(d, this.L().Da(), "mousedown", this.XM, j); this.as && e.call(d, this.ta, "blur", this.yN); e.call(d, this.oa, Kd, this.Ol);
                    b ? this.oa.start() : this.oa.stop()
                }
            }
        }; a.Iz = function (b) { if (b.ta.Aa) { var c = b.Jl; b.Jl.element = b.MR || b.m(); var d = b.ta.m(); b.ta.S() || (d.style.visibility = "hidden", Q(d, j)); !b.Ms && (b.Jl.yn && b.Jl.yn() & 32) && (b.Ms = og(d)); c.ma(d, c.Df ^ 1, b.GF, b.Ms); b.ta.S() || (Q(d, m), d.style.visibility = "visible") } };
        t.Ol = function () { var b = pg(this.m()), c = fg(this.m()); if (!(this.Ei == b || (!this.Ei || !b ? 0 : this.Ei.left == b.left && this.Ei.width == b.width && this.Ei.top == b.top && this.Ei.height == b.height)) || !(this.lk == c || (!this.lk || !c ? 0 : this.lk.top == c.top && this.lk.right == c.right && this.lk.bottom == c.bottom && this.lk.left == c.left))) this.Ei = b, this.lk = c, Iz(this) }; a.Fz = function (b, c, d) { var e = b.h(), d = d ? e.e : e.Fa; d.call(e, c, "action", b.En); d.call(e, c, "highlight", b.Rw); d.call(e, c, "unhighlight", b.$w) }; t.Rw = function (b) { Oc(this.m(), Vc.Am, b.target.m().id) };
        t.$w = function () { Lt(this.ta) || Oc(this.m(), Vc.Am, "") }; gp("goog-menu-button", function () { return new Ez(k) }); a.Jz = function (b, c, d, e) { Ez.call(this, b, c, d || kz.T(), e) }; y(Jz, Ez);
        a.Kz = { wV: "#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "), IW: "#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "), kW: "#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ") }, a.Lz =
        function (b) { var c = new Ru(b); F.forEach(Kz, function (d) { d = new Bz(d, k, b); zz(d, 8); c.J(d, j) }); return c }; t = Jz.prototype; t.zw = function () { return this.X() }; t.$o = function (b) { this.Ba(b) }; t.Ba = function (b) { for (var c = 0, d; d = this.Mh(c) ; c++) "function" == typeof d.$o && d.$o(b); Jz.n.Ba.call(this, b) }; t.En = function (b) { "function" == typeof b.target.zw ? this.Ba(b.target.zw()) : "none" == b.target.X() && this.Ba(k); Jz.n.En.call(this, b); b.stopPropagation(); this.dispatchEvent("action") };
        t.rb = function (b, c) { b && 0 == this.ml() && (this.Zg(Lz(this.L())), this.Ba(this.X())); Jz.n.rb.call(this, b, c) }; gp("goog-color-menu-button", function () { return new Jz(k) }); a.Mz = function () { }; y(Mz, iz); ia(Mz); Mz.prototype.M = s("goog-toolbar-menu-button"); a.Nz = function () { }; y(Nz, Mz); ia(Nz); Nz.prototype.createCaption = function (b, c) { return jz(lz(b, c), this.M(), c) }; Nz.prototype.Ba = function (b, c) { b && mz(this.Z(b), c) }; Nz.prototype.De = function (b) { this.Ba(b.m(), b.X()); E.add(b.m(), "goog-toolbar-color-menu-button"); Nz.n.De.call(this, b) }; a.Oz = function (b, c, d, e) { Jz.call(this, b, c, d || Nz.T(), e) }; y(Oz, Jz); gp("goog-toolbar-color-menu-button", function () { return new Oz(k) }); a.Pz = function (b, c, d, e) { Ez.call(this, b, c, d || Mz.T(), e) }; y(Pz, Ez); gp("goog-toolbar-menu-button", function () { return new Pz(k) }); a.Rz = function (b, c, d, e) { Ez.call(this, b, c, d, e); Qz(this, b); this.Yo(Wc.cB) }; y(Rz, Ez); t = Rz.prototype; t.na = k; t.vv = k; t.C = function () { Rz.n.C.call(this); Sz(this); Tz(this); Oc(this.m(), Vc.xk, "false") }; t.ea = function (b) { Rz.n.ea.call(this, b); (b = this.Cg()) ? Qz(this, b) : this.ap(0) }; t.z = function () { Rz.n.z.call(this); this.na && (this.na.H(), this.na = k); this.vv = k }; t.En = function (b) { this.sf(b.target); Rz.n.En.call(this, b); b.stopPropagation(); this.dispatchEvent("action") };
        t.ij = function () { var b = this.Eg(); Rz.n.Ba.call(this, b && b.X()); Sz(this) }; t.Zg = function (b) { var c = Rz.n.Zg.call(this, b); b != c && (this.na && this.na.clear(), b && (this.na ? Ph(b, function (b) { Uz(b); this.na.Ga(b) }, this) : Vz(this, b))); return c }; a.Qz = function (b, c) { b.vv = c; Sz(b) }; t.Ga = function (b) { Uz(b); Rz.n.Ga.call(this, b); this.na ? this.na.Ga(b) : Vz(this, this.Za()) }; t.zi = function (b, c) { Uz(b); Rz.n.zi.call(this, b, c); this.na ? this.na.zi(b, c) : Vz(this, this.Za()) }; t.removeItem = function (b) { Rz.n.removeItem.call(this, b); this.na && this.na.removeItem(b) };
        t.sf = function (b) { if (this.na) { var c = this.Eg(); this.na.sf(b); b != c && this.dispatchEvent("change") } }; t.ap = function (b) { this.na && this.sf(this.na.Mh(b)) }; t.Ba = function (b) { if (b != k && this.na) for (var c = 0, d; d = this.na.Mh(c) ; c++) if (d && "function" == typeof d.X && d.X() == b) { this.sf(d); return } this.sf(k) }; t.Eg = function () { return this.na ? this.na.Eg() : k }; t.pl = function () { return this.na ? this.na.pl() : -1 };
        a.Vz = function (b, c) { b.na = new uz; c && Ph(c, function (b) { Uz(b); this.na.Ga(b) }, b); Tz(b) }, a.Tz = function (b) { b.na && b.h().e(b.na, "select", b.ij) }, a.Sz = function (b) { var c = b.Eg(); b.Ja(c ? c.Cg() : b.vv) }, a.Uz = function (b) { b.Yo(b instanceof Ou ? Wc.fB : Wc.kJ) }; t.rb = function (b, c) { Rz.n.rb.call(this, b, c); this.pb() && this.Za().Qb(this.pl()) }; gp("goog-select", function () { return new Rz(k) }); a.Wz = function (b, c, d, e) { Rz.call(this, b, c, d || Mz.T(), e) }; y(Wz, Rz); gp("goog-toolbar-select", function () { return new Wz(k) }); a.Xz = function (b) { var c = b.indexOf(","); a: { b = (-1 != c ? b.substring(0, c) : b).toLowerCase(); for (c = 0; 2 > c; c++) { var d = "\"'".charAt(c); if (b.charAt(0) == d && b.charAt(b.length - 1) == d) { b = b.substring(1, b.length - 1); break a } } } return b }, a.Yz = function (b, c) { z.forEach(c, function (c) { var e = c.caption, c = c.value, g = Xz(c), e = new bz(e, c, b.L()); Mh(e, g); b.Ga(e); e.Z().style.fontFamily = c }) }, a.Zz = [10, 10, 13, 16, 18, 24, 32, 48], a.aA = function (b, c, d, e, g, h) { d = new hz($z(d, e, h), g, h); Mh(d, b); d.Pc(c); return d }, a.bA = function (b, c, d, e, g, h) {
            b = aA(b, c, d,
            e, g, h); lp(b, 16, j); return b
        }, a.cA = function (b, c, d, e, g, h) { g = new Wz(k, k, g, h); e && z.forEach(e.split(/\s+/), g.rh, g); g.rh("goog-toolbar-select"); Qz(g, d); Mh(g, b); g.Pc(c); return g }, a.dA = function (b, c, d, e, g, h) { d = new Oz($z(d, e, h), k, g, h); Mh(d, b); d.Pc(c); return d }, a.$z = function (b, c, d) { if ((!b || "" == b) && B && !Eb("1.9a")) b = " "; return (d || Tb()).w("DIV", c ? { "class": c } : k, b) }; a.eA = x("Link"); x("Edit Link"); x("Text to display:"); a.fA = x("Link to:"); x("Web address"); x("Link to a page or file somewhere else on the web"); x("Test this link");
        x("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.", { startBold: "<b>", endBold: "</b>", searchEngineLink: "<a href='http://www.google.com/' target='_new'>", endLink: "</a>" }); x("To what URL should this link go?"); x("Email address"); x("Link to an email address"); x("Invalid email address");
        x("To what email address should this link?"); x("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.", { preb: "<b>", postb: "</b>" }); x("Open this link in a new window"); x("Image"); a.gA = {}, a.hA = x("Normal"), a.iA = x("Normal / serif"), a.jA = [{ caption: hA, value: "arial,sans-serif" }, { caption: iA, value: "times new roman,serif" }, { caption: "Courier New", value: "courier new,monospace" }, { caption: "Georgia", value: "georgia,serif" }, { caption: "Trebuchet", value: "trebuchet ms,sans-serif" }, { caption: "Verdana", value: "verdana,sans-serif" }], a.kA = {
            ja: [{ caption: "ＭＳ Ｐゴシック", value: "ms pgothic,sans-serif" }, { caption: "ＭＳ Ｐ明朝", value: "ms pmincho,serif" }, { caption: "ＭＳ ゴシック", value: "ms gothic,monospace" }], ko: [{
                caption: "굴림",
                value: "gulim,sans-serif"
            }, { caption: "바탕", value: "batang,serif" }, { caption: "굴림체", value: "gulimche,monospace" }], "zh-tw": [{ caption: "新細明體", value: "pmingliu,serif" }, { caption: "細明體", value: "mingliu,serif" }], "zh-cn": [{ caption: "宋体", value: "simsun,serif" }, { caption: "黑体", value: "simhei,sans-serif" }, { caption: "MS Song", value: "ms song,monospace" }]
        }, a.lA = x("Small"), a.mA = x("Normal"), a.nA = x("Large"), a.oA = x("Huge"), a.pA = [{ caption: lA, value: 1 }, { caption: mA, value: 2 }, { caption: nA, value: 4 }, { caption: oA, value: 6 }], a.qA = x("Heading"),
        a.rA = x("Subheading"), a.sA = x("Minor heading"), a.tA = x("Normal"), a.uA = [{ caption: qA, xa: "H2" }, { caption: rA, xa: "H3" }, { caption: sA, xa: "H4" }, { caption: tA, xa: "P" }], a.vA = function (b, c, d, e, g, h) { var l = aA(b, c, d, e, g, h); l.ri = function (b) { l.$a(b) }; return l }, a.wA = function (b, c) { var d = c; try { if (A) var e = "000000" + d.toString(16), g = e.substr(e.length - 6, 6), d = "#" + g.substring(4, 6) + g.substring(2, 4) + g.substring(0, 2); d != b.X() && b.Ba(d) } catch (h) { } }, a.xA = x("Format"), a.yA = x("Format"), a.zA = x("Undo"), a.AA = x("Redo"), a.BA = x("Font"), a.CA = x("Font size"),
        a.DA = x("Text color"), a.EA = x("Bold"), a.FA = x("Italic"), a.GA = x("Underline"), a.HA = x("Text background color"), a.IA = x("Add or remove link"), a.JA = x("Numbered list"), a.KA = x("Bullet list"), a.LA = x("Decrease indent"), a.MA = x("Increase indent"), a.NA = x("Align left"), a.OA = x("Align center"), a.PA = x("Align right"), a.QA = x("Justify"), a.RA = x("Remove formatting"), a.SA = x("Insert image"), a.TA = x("Strikethrough"), a.UA = x("Left-to-right"), a.VA = x("Right-to-left"), a.WA = x("Quote"), a.XA = x("Edit HTML source"), a.YA = x("Subscript"),
        a.ZA = x("Superscript"), a.$A = x("Edit HTML"), a.aB = {};
        gA.aB = [{ xa: "+undo", R: zA, Ma: "tr-icon tr-undo", factory: vA, gb: j }, { xa: "+redo", R: AA, Ma: "tr-icon tr-redo", factory: vA, gb: j }, { xa: "+fontName", R: BA, Ma: "tr-fontName", factory: function (b, c, d, e, g, h) { var l = cA(b, c, d, e, g, h), b = "en-us".replace(/_/, "-").toLowerCase(), c = []; b in kA && (c = kA[b]); c.length && Yz(l, c); Yz(l, jA); Qz(l, hA); E.add(l.Za().Z(), "goog-menu-noaccel"); l.ri = function (b) { var c = k; b && 0 < b.length && (c = Nh(l.Za(), Xz(b))); c != l.Eg() && l.sf(c) }; return l }, gb: j }, {
            xa: "+fontSize", R: CA, Ma: "tr-fontSize", factory: function (b, c,
            d, e, g, h) { var l = cA(b, c, d, e, g, h); z.forEach(pA, function (b) { var c = b.value, b = new bz(b.caption, c, l.L()); l.Ga(b); b = b.Z(); b.style.fontSize = (Zz[c] || 10) + "px"; b.firstChild.style.height = "1.1em" }); Qz(l, mA); E.add(l.Za().Z(), "goog-menu-noaccel"); l.ri = function (b) { var c; if (c = oa(b)) c = b.match(yt), c = "px" == (c && c[0] || k); c && (b = z.lastIndexOf(Zz, parseInt(b, 10))); b = 0 < b ? b : k; b != l.X() && l.Ba(b) }; return l }, gb: j
        }, { xa: "+bold", R: EA, Ma: "tr-icon tr-bold", gb: j }, { xa: "+italic", R: FA, Ma: "tr-icon tr-italic", gb: j }, {
            xa: "+underline", R: GA, Ma: "tr-icon tr-underline",
            gb: j
        }, { xa: "+foreColor", R: DA, Ma: "tr-icon tr-foreColor", factory: function (b, c, d, e, g, h) { b = dA(b, c, d, e, g, h); b.$o("#000"); b.ri = xa(wA, b); return b }, gb: j }, { xa: "+backColor", R: HA, Ma: "tr-icon tr-backColor", factory: function (b, c, d, e, g, h) { b = dA(b, c, d, e, g, h); b.$o("#FFF"); b.ri = xa(wA, b); return b }, gb: j }, { xa: "+link", R: IA, caption: eA, Ma: "tr-link", gb: j }, { xa: "+insertOrderedList", R: JA, Ma: "tr-icon tr-insertOrderedList", gb: j }, { xa: "+insertUnorderedList", R: KA, Ma: "tr-icon tr-insertUnorderedList", gb: j }, {
            xa: "+outdent", R: LA, Ma: "tr-icon tr-outdent",
            factory: aA
        }, { xa: "+indent", R: MA, Ma: "tr-icon tr-indent", factory: aA }, { xa: "+justifyLeft", R: NA, Ma: "tr-icon tr-justifyLeft", gb: j }, { xa: "+justifyCenter", R: OA, Ma: "tr-icon tr-justifyCenter", gb: j }, { xa: "+justifyRight", R: PA, Ma: "tr-icon tr-justifyRight", gb: j }, { xa: "+justifyFull", R: QA, Ma: "tr-icon tr-justifyFull", gb: j }, { xa: "+removeFormat", R: RA, Ma: "tr-icon tr-removeFormat", factory: aA }, { xa: "image", R: SA, Ma: "tr-icon tr-image", factory: aA }, { xa: "+strikeThrough", R: TA, Ma: "tr-icon tr-strikeThrough", gb: j }, {
            xa: "+subscript", R: YA,
            Ma: "tr-icon tr-subscript", gb: j
        }, { xa: "+superscript", R: ZA, Ma: "tr-icon tr-superscript", gb: j }, { xa: "ltr", R: UA, Ma: "tr-icon tr-ltr", gb: j }, { xa: "rtl", R: VA, Ma: "tr-icon tr-rtl", factory: function (b, c, d, e, g, h) { var l = bA(b, c, d, e, g, h); l.ri = function (b) { b = !!b; E.enable(l.getParent().m(), "tr-rtl-mode", b); l.$c(b) }; return l }, gb: j }, { xa: "+BLOCKQUOTE", R: WA, Ma: "tr-icon tr-BLOCKQUOTE", gb: j }, {
            xa: "+formatBlock", R: xA, caption: yA, Ma: "tr-formatBlock", factory: function (b, c, d, e, g, h) {
                var l = cA(b, c, d, e, g, h); z.forEach(uA, function (b) {
                    var c =
                    b.caption, b = b.xa, d = l.L(), c = new bz(d.w("DIV", k, c), b, d); Mh(c, b); l.Ga(c)
                }); Qz(l, tA); E.add(l.Za().Z(), "goog-menu-noaccel"); l.ri = function (b) { b = b && 0 < b.length ? b : k; b != l.X() && l.Ba(b) }; return l
            }, gb: j
        }, { xa: "editHtml", R: XA, caption: $A, Ma: "tr-editHtml", factory: aA }]; for (var bB = 0, cB; cB = gA.aB[bB]; bB++) aB[cB.xa] = cB; delete gA.aB; a.dB = {}; dB.fU = Ok; a.eB = function (b) { Gv.call(this); this.fa = new ne(this); this.yE = K("div", { style: "display:none" }); this.g = this.wc = k; this.G = {}; F.extend(this.G, this.defaults, b || {}) }; y(eB, Gv); ya(eB.prototype, dB); eB.prototype.defaults = { kk: k, title: "Distraction Free Mode", wK: "back", FS: "publish", jw: "zu-editing-distraction-free", xT: "sticky-goog-scrollfloater", aU: "goog-scrollfloater" }; eB.prototype.jd = lf("FullScreenPlugin"); aB.toggleFullScreen = { xa: "toggleFullScreen", R: "写作模式", Ma: "tr-icon tr-max", factory: aA }; t = eB.prototype;
        t.Fe = xa(F.ug, { TW: "toggleFullScreen", mV: "enterFullScreen", nV: "exitFullScreen" }); t.z = function () { this.fa.H(); L(this.g); this.G = this.up = this.wc = this.sb = this.g = k; eB.n.z.call(this) };
        t.Tu = function () {
            var b = this.G, c = document.createElement("div"); c.id = "zu-distraction-free-editor"; c.innerHTML = '<div class="header"><div class="wrapper"><h1 class="title">' + b.title + '</h1><a href="#" class="' + b.wK + '" name="return">返回</a><a href="#" class="' + b.FS + '" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>'; document.body.appendChild(c); this.fa.e(J("back", c), "click", function (b) { b.preventDefault(); fB(this) }, m, this); this.fa.e(J("publish",
            c), "click", function (b) { b.preventDefault(); this.dispatchEvent("save") && fB(this) }, m, this); this.g = c; this.wc = J("content", c); this.up = K("div", { className: "toolbar-info" }); this.G.kk || (this.G.kk = this.D.field)
        }; t.af = function (b) { this.g || this.Tu(); switch (b) { case "enterFullScreen": gB(this); break; case "exitFullScreen": fB(this); break; case "toggleFullScreen": this.Dx() ? fB(this) : gB(this) } }; t.Dx = function () { return E.has(document.body, this.G.jw) };
        a.gB = function (b) { if (b.dispatchEvent("willEnterFullScreen")) { b.kD || (b.mO = history.length); b.kD = j; hB(b, "writing"); b.EI = Mc(Tb((fa || window).document)); nc(b.yE, b.G.kk); b.wc.appendChild(b.G.kk); E.add(document.body, b.G.jw); b.sb = J(b.G.aU, b.g); b.sb.appendChild(b.up); var c = b.g; c.scrollTop = 0; var d = b.sb.getBoundingClientRect().top; c.onscroll = pf(v(b.DH, b), function () { return c.scrollTop > d }); b.fa.e(document, "keydown", b.yo, m, b); La(Gc(b.D.field)) || b.D.Mf(); b.dispatchEvent("enterFullScreen") } }, a.fB = function (b) {
            b.kD &&
            b.mO !== history.length ? history.back() : hB(b, ""); b.sb.removeChild(b.up); b.DH(m); b.g.onscroll = k; b.fa.Fa(document, "keydown", b.yo, m, b); nc(b.G.kk, b.yE); E.remove(document.body, b.G.jw); window.scrollTo(b.EI.x, b.EI.y); b.dispatchEvent("exitFullScreen")
        }, a.hB = function (b, c) { yd(window, "hashchange", b.iG, m, b); location.hash = c || ""; setTimeout(v(function () { this.fa.e(window, "hashchange", this.iG, m, this) }, b)) }; t.iG = function () { this.Dx() ? fB(this) : "writing" === location.hash.slice(1) && gB(this) };
        t.yo = function (b) { 27 === b.keyCode && this.dispatchEvent("shouldExitFullScreenOnEscape") && fB(this) }; t.DH = function (b) { E[b ? "add" : "remove"](this.sb, this.G.xT) }; a.jB = function (b, c) { M.call(this); this.Vf = b; this.Mz = c || iB; b.Jb || (this.show = ha) }; y(jB, yn); a.iB = "加载中..."; t = jB.prototype;
        t.show = function () {
            lc(this.g = K("div", "zg-mt10", [K("h3", { style: "margin:0 0 5px;" }, "分享到微博"), K("div", "zm-tab-content", [this.oX = K("div", { className: "zg-section zg-clear", innerHTML: '<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> ' }), K("div", "zg-section", K("div", "zg-form-text-input", this.bp = K("textarea", { style: "width:100%;height: 66px;" }, "加载中..."))), K("div", "zm-command", [K("div", ["zm-item-meta", "zg-left"], this.YS =
            K("span")), this.zT = K("a", { "class": "zg-btn-blue weibo-share-button", href: "javascript:;" }, "分享到微博")])])]), H("zh-question-answer-form-wrap")); this.h().e(Y, "sina_callback", function (b) { this.Iz(b.pc.id, b.pc.name) }); this.Iu(); this.Jj(); Dp.T().refresh(); var b = this; this.Mz === iB ? Gi("/answer/" + b.Vf.Jb + "/sharetext", function (c) { if ((c = Ie(c.target)) && c.sina) b.Mz = c.sina, b.Ra() }, "GET") : this.Ra()
        }; t.Iz = function (b, c) { sh.name = c; this.nT = sh.id = b; this.Bc.checked = j; this.Jj() };
        t.Jj = function () { var b = J("weibo-share-button", this.g), c = this.Bc.checked; E.enable(b, "zg-btn-blue", c); E.enable(b, "zg-btn-disabled", !c) }; t.Ra = function () { this.bp.value = this.Mz; this.Yz = new Io(this.bp); this.KH = new iv(this.bp, this.YS, 140, gv); this.h().e(this.zT, "click", this.ka) }; t.Iu = function () { this.Bc = J("sina-checkbox", this.g); this.h().e(this.Bc, "change", this.Jy) }; t.Jy = function (b) { var b = b.target, c = b.getAttribute("data-bindurl"); b === this.Bc && !this.nT ? (window.open(c), b.checked = m) : this.Jj() };
        t.ka = function (b) { if ((b = b.target) && E.has(b, "zg-btn-blue") && this.bp.value) { b = new Lk(j); b.add("content", this.bp.value); var c = []; this.Bc.checked && c.push("sina"); b.add("via", c.join(",")); this.Wl(b); Ok("share", this.qY ? "answer_weibo" : "question_weibo") } else U("请您选择或绑定微博后再进行分享！") }; t.Wl = function (b) { b.add("aid", this.Vf.qa); this.xhr = new V(j); P(this.h(), this.xhr, "complete", this.yu); this.xhr.ajax("/answer/share", b.Kc()) }; t.yu = function () { var b = Ie(this.xhr); b && b.r ? U(b.msg) : (U("分享发送完毕"), Q(this.g, m)) }; a.kB = function (b, c, d) { Ou.call(this, b, c, d); this.To(j) }; y(kB, Ou); gp("goog-checkbox-menuitem", function () { return new kB(k) }); a.lB = function (b, c) { M.call(this); this.la = b; this.Vb = c; this.data = eh }; y(lB, yn); t = lB.prototype;
        t.B = function () {
            this.$l = H("zh-question-redirect-info"); this.$l.innerHTML && (this.Yn = j); this.h().e(this.$l, "click", function (b) { "cancel" === b.target.name && mB(this) }); var b = H("zh-question-side-header-wrap"); if (ch.Ac && !ch.cF && b) { var c = H("zh-question-filter-wrap"); c ? kc(b, c) : b.style[A ? "styleFloat" : "cssFloat"] = "none" } (this.Wf = H("zh-question-operation-menu")) && this.pj(); this.h().e(Mi, "anon_change", function (b) {
                var c = H("zh-question-side-invitation-anon"); c && Q(c, b.kb); (c = H("zh-question-side-invitation-notanon")) &&
                Q(c, !b.kb); this.Pl && this.Pl.$a(au(this.data.Qj) || !b.kb)
            }); (this.pk = H("zh-question-webshare-container")) && this.h().e(this.pk, "click", this.Sz)
        };
        t.pj = function () {
            this.fb = new Ru; var b = this.data.Gm, c = this.Wf.getAttribute("data-auth"), c = c ? c.split(",") : []; if (b == k || 0 === b) {
                this.fb.Ga(this.Js = nB("使用匿名身份", j)); this.Js.$c(this.data.kb); if ((!nh || !z.contains(nh, "question_op_redirect")) && "close" !== eh.status) this.fb.Ga(this.Pl = nB(this.Yn ? "撤消重定向" : "问题重定向")), this.Pl.$a(au(this.data.Qj) || !this.data.kb); z.contains(c, "auth-f-manage") && this.fb.Ga(this.nR = nB("更新话题页显示", m)); this.h().e(this.fb, "action", this.hj); this.Js && this.h().e(Mi, "anon_change", function (b) { this.Js.$c(!!b.kb) });
                this.Vb && z.contains(c, "auth-f-manage") && (this.fb.Ga(this.Ly = nB("优质回答", j)), this.Ly.$c(this.Vb.YO)); b = new Ez("Settings", this.fb); b.am = j; Hz(b); b.o(this.Wf)
            }
        }; a.nB = function (b, c) { return !b ? new Qu : c ? new kB(b) : new Ou(b) };
        t.hj = function (b) {
            var c = this.Js; if (b.target === c) ct(c.Ee() ? 1 : 0, function (b) { b || c.$c(!c.Ee()) }); else if (b.target === this.Pl) { if (By({ Yl: j })() === m) return m; this.Ho || (this.Ho = new Mx(this.la), this.h().e(this.Ho, "change", this.BP)); this.fb.F(m); this.Yn ? mB(this) : this.Ho.show() } else b.target === this.iR ? Gi("/question/" + this.data.Jb + (this.iR.Ee() ? "/unlock_summary" : "/lock_summary"), function () { top !== window ? top.location.href = "/question/" + eh.Jb : window.location.reload() }, "POST") : b.target === this.nR ? $.post("/refresh_topic_feeds",
            { q: eh.Jb }).done(function (b) { b.r || U("操作成功！") }) : b.target === this.Ly && $.post("/answer/" + this.Vb.Jb + (this.Ly.Ee() ? "/good_mark" : "/good_unmark")).done(function (b) { b.r || U("操作成功！") })
        }; t.BP = function () { this.$l.innerHTML = '<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/' + this.Ho.jt + '">' + this.Ho.QG + '</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>'; Q(this.$l, j); this.Yn = j; this.Pl.im("撤消重定向") };
        a.mB = function (b) { b.$l.innerHTML = ""; Q(b.$l, m); b.Yn = m; b.Pl.im("问题重定向"); Gi("/question/unredirect", k, "POST", "qid=" + b.la + "&rqid=" + b.jt) }; t.Sz = function (b) { var c = Kk(this.pk, b.target); c && c.name && mn(function () { var b = $("#zh-question-webshare-container").data(); new jv([b.title, b.type, b.urlToken, { answer: { aid: b.id }, question: { qid: b.id } }[b.type]], "tb-webshare-" + c.name); Y.V({ type: "ga_click_share_question_box", target: c, data: { type: c.name } }) }, function () { return { qg: "letter" === c.name } })() }; a.oB = function (b) { Qr.call(this, j, "/topic/bio/update", "bio"); this.wp = b[0]; this.params = ["tid=" + this.wp[3]]; this.content = b[1]; this.yb = '<a href="javascript:;" name="edit">描述你关于 ' + this.wp[0] + " 的经验</a>"; this.Vt = j }; y(oB, Qr); oB.prototype.Ji = function () { oB.n.Ji.call(this); this.an.innerHTML = "更新" }; oB.prototype.ea = function (b) { oB.n.ea.call(this, b); var b = this.L(), c = b.w("strong", k, K("a", { href: "/topic/" + this.wp[1], title: this.wp[0], "class": "" }, this.wp[0])); b.Rn(c, this.Tb) }; a.pB = function (b, c) { M.call(this); this.EO = c; this.Sk = b; this.items = []; this.wZ = "/url_to_fetch_question_related_topic_bio_items"; this.Ux = m }; y(pB, yn);
        a.qB = k, a.rB = function () { qB || (qB = new pB(gh, m)); return qB }, a.sB = function (b) { if (!b.locked) if (!b.JP && b.Ux) { b.locked = j; var c = new V(j); b.h().e(c, "success", function (b) { this.JP = j; this.locked = m; b = Ie(b.target); b.r || (this.Sk = b.msg, sB(this)) }); c.ajax("/question/" + b.$G + "/bios", k, "GET") } else b.U || (b.U = new zi, b.U.ab("修改话题经验"), ii(b.U, k), ci(b.U, m), c = b.U.Z(), c.innerHTML = '<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>', b.Y(c)), b.U.F(j) };
        pB.prototype.Y = function (b) { this.g = K("div", "zu-bio-editor-wrap", [this.HO = K("div", "zu-bio-editor-inner-wrap"), this.vd = K("div", "zm-command", [this.an = K("a", { name: "save", href: "javascript:;", className: "zg-r3px zg-btn-blue" }, "完成")])]); z.forEach(this.Sk, function (b) { b = new oB(b); b.Y(this.HO); this.items.push(b) }, this); this.EO && Q(this.vd, m); b.appendChild(this.g); this.h().e(this.vd, "click", this.ka) };
        pB.prototype.lw = function () { var b = this.items.length, c; if (!b && this.Sk.length) for (c = 0; c < this.Sk.length; c++) if (this.Sk[c][1]) return this.Sk[c][1]; var d = k; for (c = 0; c < b; c++) if (d = this.items[c].eb()) return d }; pB.prototype.ka = function (b) { if ((b = this.cf(b.target)) && "save" === b.name) this.U && this.U.F(m), this.dispatchEvent("change") }; a.tB = function (b) { T.call(this); this.Ab = b; this.SX = this.Ab.nr(); this.hr = this.Ab.zd ? this.Ab.Na : this.Ab.Na.m(); this.isContentEditable = this.Ab.isContentEditable(); this.QT = 30; this.Cc = new Jd(1E3 * this.QT); this.la = eh ? eh.la : 0 }; y(tB, T); t = tB.prototype; t.z = function () { uB(this); this.Cc.H(); tB.n.z.call(this) };
        t.o = function (b) { this.g = b; this.Ln = J("draft-saved-info", b); Q(this.Ln, m); this.xO = J("draft-saved-time", b); this.YK = J("draft-clear-button", b); this.DX = this.isContentEditable ? Pv : ["change", "input"]; b = this.h().e(this.Cc, Kd, this.tz).e(this.YK, "click", this.ZK).e(this.hr, "keydown", this.lP); "oninput" in this.hr && !A ? b.e(this.hr, "input", this.JO) : b.e(this.hr, "keydown", this.KO); var c = lh && 1E3 * lh[1]; c && (vB(this, c), this.rA = setInterval(v(function () { vB(this, c) }, this), 22E3)) };
        t.lP = function (b) { if ((b.metaKey || b.ctrlKey) && "s" === jk[b.keyCode]) this.yP(), this.isContentEditable || b.preventDefault() }; a.xB = function (b) { wB(b, "保存中…"); b.IO() }; t.JO = function () { this.jp(); xB(this) }; t.KO = function (b) { uh(b.keyCode) && (this.jp(), xB(this)) }; t.At = function () { this.Cc.start() }; t.jp = function () { this.Cc.stop() }; t.Ja = function (b) { this.Ab.Ja(b); this.Ab.Vo() }; t.eb = function () { return this.Ab.Nf() };
        t.nH = function () { if (!this.zg) { var b = this.eb(); b && (wB(this, "保存中…"), b = (new kj).add("qid", this.la).add("content", b), Gi("/answer/draft/save", v(this.nf, this), "POST", b.toString())) } }; t.yU = 150; t.tz = Xk(tB.prototype.yU, tB.prototype.nH); t.zP = 350; t.yP = Xk(tB.prototype.zP, tB.prototype.nH); t.LO = 3E3; t.IO = Xk(tB.prototype.LO, function () { this.zg || (this.eb() ? this.tz() : yB(this)) }); a.uB = function (b) { b.rA && (clearInterval(b.rA), b.rA = k) };
        t.nf = function (b) { var b = Ie(b.target), c = "", c = 0 === b.r ? "已保存" : b.msg || "保存失败！请稍后再试。"; uB(this); Q(this.Ln, j); wB(this, c); this.dispatchEvent("saveContent"); this.At() }; a.vB = function (b, c) { var d = Wt(c || za()); /^\d/.test(d) && (d = " " + d); wB(b, "已存于" + d) }, a.wB = function (b, c) { Q(b.Ln, j); yc(b.xO, c) };
        t.ZK = function (b) { b.preventDefault(); Di("清除草稿", "你确定要清除保存的草稿吗？", function (b) { b && (this.Ja(""), yB(this), this.Ab.ready(function () { var b = this.Na; this.zd ? Zs(b, b.value.length) : b.field.lastChild ? Xs(b.field.lastChild) : b.Mf(); this.Zk && (this.Zk.scrollTop = this.Zk.scrollHeight) })) }, this) }; a.yB = function (b) { Gi("/answer/draft/delete", k, "POST", "qid=" + b.la); uB(b); Q(b.Ln, m); b.dispatchEvent("clearContent") }; a.zB = function (b, c, d) { Tr.call(this, m); this.kb = !!b; this.tI = c; this.yb = "&nbsp;"; this.nq = d; this.Ut = this.Hv = this.BD = this.enabled = j; if (S.yi || !S.wa()) this.ay = '<span style="font-style: normal;color: #999;">写回答…</span>' }; y(zB, Tr); t = zB.prototype; t.MD = function () { var b = Vb("h2", "zm-editable-content", H("zh-question-title"))[0]; return { title: b && (/answer\/\d+$/.test(location.pathname) ? Gc(b) : b.firstChild.nodeValue) || "", kk: this.Vi } }; t.lw = p("nq"); t.pt = ca("kb");
        a.AB = function (b, c) { b.nq = c ? c : S[4]; if (b.El && $.trim(c)) { var d = c; 20 < d.length && (d = d.substring(0, 17) + "..."); b.EK.innerHTML = "，" + Va(d) + '<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>' } }; t.$a = function (b, c) { this.enabled = b; this.El ? (this.eh(), this.yb = c, this.Tb.innerHTML = this.yb) : c && (this.yb = c) }; t.ea = function (b) { zB.n.ea.call(this, b); this.El = j; E.add(this.Tb, "zu-answer-form-disabled-wrap") }; t.z = function () { this.Sr && (L(this.Sr), this.uI = this.Sr = k); zB.n.z.call(this) };
        t.ej = function (b) { this.pt(b.kb); this.cq && (this.cq.checked = b.kb) }; t.C = function () { zB.n.C.call(this); this.h().e(Mi, "anon_change", this.ej) };
        t.xg = function () {
            zB.n.xg.call(this); var b = this.L(), c = S.wa(); this.Sr = b.w("div", "zh-answer-form clearfix", [c ? $t(this.tI) : "", this.uI = b.w("div", k, [b.w("div", "zu-answer-form-title", [c ? Zt(this.tI) : "我来回答这个问题", this.EK = b.w("span")])])]); AB(this, this.nq); b.Rn(this.Sr, this.Vi); this.h().e(this.uI, "click", this.ka); S.wa() ? S.yi || BB(this, '<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>', '<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>', function (b,
            c) { b.attr("data-activate-dialog", ""); c.attr("data-activate-dialog", "") }) : BB(this, '<div class="signin-mask-tip-answer"></div>', '<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>', function (b, c) { function g() { new hn("question_answer_add_start") } b.on("click", g); c.on("click", g) })
        }; a.BB = function (b, c, d, e) { c = $(c).css("top", 0).css("z-index", 9); $(b.vd).hide(); d = $(d); $(b.Vi).append(c).after(d); e && e.call(b, c, d) };
        t.ul = function (b) {
            switch (b) {
                case "edit_bio": b = rB(); if (!this.Ku) { var c = eh.Jb; b.Ux = j; b.$G = c; this.h().e(b, "change", this.xy) } this.Ku = j; sB(b); break; case "cancel_delete": this.dispatchEvent("cancel_delete_answer"); break; case "answer_my_question": var d = this; this.tk ? this.tk.show() : (d.tk = $('<div class="question-tip-box-bottom">确定想要回答你自己提出的问题吗？<br>如果需要对问题做出更多的解释和说明，请编辑问题描述。 如果需要对其他回答做出回应，请在相应回答下通过评论发布。<br><div class="zg-clear"><a href="javascript:;" class="zg-right zg-btn zg-btn-blue" name="confirm">确定</a><a href="javascript:;" class="zg-right zg-link-gray " name="cancel">取消</a></div></div>'),
                d.tk.on("click", '[name="cancel"]', function () { d.tk.hide() }).on("click", '[name="confirm"]', function () { d.tk.hide(); $(d.Tb).hide(); d.$a(j); d.qd() }), $(d.Tb).after(d.tk))
            } return j
        }; t.pe = function () { "editing" === this.status ? this.Lb && Q(this.Lb, j) : this.Lb && Q(this.Lb, m); Q(this.ed, m); this.Tb && Q(this.Tb, !this.enabled) }; t.gL = '<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
        t.Ji = function () { var b = Rk(this.gL); this.vd = gc(b({ questionStatus: eh.status, statusText: { suggest: "建议修改", evaluate: "建议修改", close: "关闭" }[eh.status] })); this.an = $(".submit-button", this.vd)[0]; var b = $("input[name=anno-checkbox]", this.vd)[0], c = $("label", this.vd)[0]; this.cq = b; eh.kb && (this.cq.checked = j); tg(c, j); this.Lb.appendChild(this.vd); this.ready(function () { if (this.Na && this.Na.on) this.Na.on("load", this.AO, m, this) }) };
        t.AO = function () { var b = new tB(this); Sc(this, b); this.h().e(b, "saveContent", function () { var b = !this.zd && this.Na.bj("FullScreenPlugin"); if (b && b.up) { var c = $(b.up); c.stop().text("草稿已经保存").fadeTo(600, 0.5).delay(3E3).fadeOut(600, function () { c.text("") }) } }, m, this); var c = this.zd ? this.Na : this.Na.m(); this.h().e(c, "focus", function () { b.At() }).e(c, "blur", function () { b.jp(); b.tz() }); b.o(this.vd) }; t.xy = function () { var b = rB().lw(); b && AB(this, b) }; a.CB = function (b, c) { Ru.call(this, b, c); this.Fm = j; this.Ne(j); this.F(m, j); this.uf = new Od }; y(CB, Ru); t = CB.prototype; t.WT = m; t.hF = 0; t.We = k; t.ea = function (b) { CB.n.ea.call(this, b); (b = b.getAttribute("for") || b.htmlFor) && this.attach(this.L().m(b), 1) }; t.C = function () { CB.n.C.call(this); Md.forEach(this.uf, this.MB, this); var b = this.h(); b.e(this, "action", this.XP); b.e(this.L().Da(), "mousedown", this.eG, j); D && b.e(this.L().Da(), "contextmenu", this.eG, j) };
        t.attach = function (b, c, d, e, g) { if (!b || !this.uf.Kd(ua(b))) b ? (c = { g: b, TH: c, HP: d, mD: e ? "contextmenu" : "mousedown", dy: g }, this.uf.set(ua(b), c), b = c) : b = k, this.Aa && this.MB(b) }; t.MB = function (b) { this.h().e(b.g, b.mD, this.uG) }; t.detach = function (b) { (!b || !this.uf.Kd(ua(b))) && f(Error("Menu not attached to provided element, unable to detach.")); b = ua(b); if (this.Aa) { var c = this.uf.get(b); this.h().Fa(c.g, c.mD, this.uG) } this.uf.remove(b) };
        a.DB = function (b, c, d, e, g) { var h = b.S(); b.Hx() && b.WT ? b.hide() : (b.We = g || k, b.dispatchEvent("beforeshow") && (d = "undefined" != typeof d ? d : 4, h || (b.m().style.visibility = "hidden"), Q(b.m(), j), c.ma(b.m(), d, e), h || (b.m().style.visibility = "visible"), b.Qb(-1), b.F(j))) }; t.HH = function (b, c, d) { c = la(b.TH) ? new Rt(b.g, b.TH, j) : new Qt(c, d); c.km && c.km(5); DB(this, c, b.HP, b.dy, b.g) }; t.hide = function () { this.S() && (this.F(m), this.S() || (this.hF = za(), this.We = k)) }; t.Hx = function () { return this.S() || 150 > za() - this.hF }; t.XP = function () { this.hide() };
        t.uG = function (b) { for (var c = this.uf.Fb(), d = 0; d < c.length; d++) { var e = this.uf.get(c[d]); if (e.g == b.currentTarget) { this.HH(e, b.clientX, b.clientY); b.preventDefault(); b.stopPropagation(); break } } }; t.eG = function (b) { this.S() && !this.Cf(b.target) && this.hide() }; t.Uc = function (b) { CB.n.Uc.call(this, b); this.hide() }; t.z = function () { CB.n.z.call(this); this.uf && (this.uf.clear(), delete this.uf) }; a.EB = function () { T.call(this) }; y(EB, T); EB.prototype.J = function (b, c) { EB.n.J.call(this, b, c); this.h().e(b, "beforeexpand", this.WN) }; EB.prototype.WN = function (b) { var c = b.target; Ph(this, function (b) { c !== b && b.lc() && b.Ka(m) }) }; EB.prototype.H = function () { this.h().H(); EB.n.H.call(this) }; a.FB = function (b, c) { T.call(this); this.VR = b; this.Us = c; this.QO = this.$ = k; this.gd = m; this.Sn = k; this.Fl = []; this.RH = []; this.$f = m; this.vP = "loading"; this.SE = "zg-btn-white"; this.RO = "invite-button" }; y(FB, T); t = FB.prototype; t.w = function () { this.g = K("div", { style: "display:none", className: "question-invite-panel" }) }; t.Y = function () { this.$f = j; FB.n.Y.call(this) };
        t.C = function () {
            FB.n.C.call(this); var b = this.g, c = this.h(); if (!this.$f) {
                c.e(Mi, "anon_change", this.reload); var d = J("cancel-anon", b); d && c.e(d, "click", this.OM); if (!J("error-message")) {
                    var d = J("search-input", b), e = J("invite-title", b); this.zx = J("invite-status", b); c.e(this.zx, "click", this.PM); var g = J("suggest-persons", b); g && (c.e(g, "click", this.Sw), this.QH = g); $(".invite-status", b).on("mouseenter mouseleave", ".invited-shortlist", function (b) { $(".invited-hovercard", this).toggleClass("in", "mouseenter" === b.type) });
                    this.ox(d, e); this.RH = $(this.QH).children().map(this.GG).get(); this.Fl = $(".invited-fulllist", this.zx).children().map(this.GG).get(); var h = function (b) { 0 > b || b > n - 1 || (w.find("li").hide().slice(4 * b, 4 * (b + 1)).show(), 0 === b ? q.addClass("link-disabled") : q.removeClass("link-disabled"), b === n - 1 ? r.addClass("link-disabled") : r.removeClass("link-disabled"), l = b) }, b = this.g, l = 0, n, q, r, w; w = $(".suggest-persons", b); n = w.find("li").length / 4; q = $(".js-prev", b).on("click", function () { h(l - 1) }); r = $(".js-next", b).on("click", function () {
                        h(l +
                        1)
                    }); h(0); Q(this.g, this.gd)
                }
            }
        }; t.jb = function () { FB.n.jb.call(this); this.h().H() }; t.Ki = s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>'); t.reload = function () { this.lc() ? this.ei() : this.$f = j }; t.ei = function () { var b = this, c = this.vP; this.jb(); E.add(this.g, c); this.g.innerHTML = this.Ki(); return $.get("/node/QuestionInvitePanelV2", { params: { question_id: this.VR } }).done(function (d) { b.$f = m; E.remove(b.g, c); d = gc(La(d)); Q(d, b.lc()); nc(d, b.g); b.g = d; b.C() }) };
        t.z = function () { FB.n.z.call(this); this.QO = k; this.$.H() }; t.lc = p("gd"); t.expand = function () { this.Ka(j) }; t.collapse = function () { this.Ka(m) }; t.Ka = function (b) { if (b !== this.gd) { this.dispatchEvent(b ? "beforeexpand" : "beforecollapse"); var c = v(function () { this.dispatchEvent(b ? "expand" : "collapse") }, this); b && this.$f ? this.ei().done(c) : c(); this.gd = b; Q(this.g, b) } }; t.yf = function () { this.Ka(!this.gd) };
        t.ox = function (b) {
            var c = this, d = Rk('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>'); this.$ = new Lp(b, {
                Ed: 8, source: "/people/autocomplete?type=invite", Tj: b.offsetParent, placeholder: "搜索你想邀请的人", Zc: function (b, c, h) { h.innerHTML = d(b.data) }, filter: function (b) {
                    return z.filter(b, function (b) {
                        var d = b.id; return !z.find(c.Fl, function (b) {
                            return b.id ===
                            d
                        })
                    })
                }, select: function (b) { GB(c, "ask_to_answer_search"); du(c.Us, b.id, "search").done(function (d) { if (d.r) return U(d.msg); HB(c, b); IB(c, b.id, j) }); return "" }
            })
        }; a.JB = function (b, c, d) { b = b.SE; d ? (E.add(c, b), yc(c, "收回邀请")) : (E.remove(c, b), yc(c, "邀请回答")) }; t.OM = function () { ct(0) }; a.GB = function (b, c) { var d = eh; b.dispatchEvent(new vw("click!invitation", { category: "invitation", action: "ask_to_answer", label: c, value: d.ZE ? k : d.ne })) };
        t.Sw = function (b) {
            var c = b.target; if ("BUTTON" === c.tagName || E.has(c, this.RO)) {
                this.Sn && "pending" === this.Sn.state() && this.Sn.abort(); b = "related" === c.getAttribute("data-type") ? "recommended_relative_questions" : "recommended_top_answerers"; GB(this, b); var d = c.getAttribute("data-uid"), e = this.SE, g = v(function (b) { b ? (JB(this, c, j), b = z.find(this.RH, function (b) { return b.id === d }), HB(this, b)) : (JB(this, c, m), KB(this, d)) }, this); E.has(c, e) ? (this.Sn = cu(this.Us, d), g(m)) : (this.Sn = du(this.Us, d, b).done(function (b) {
                    b.r && (U(b.msg),
                    g(m))
                }), g(j))
            }
        }; t.PM = function (b) { b = b.target; "BUTTON" === b.tagName && (b = b.getAttribute("data-uid"), cu(this.Us, b), IB(this, b, m), KB(this, b)) }; a.IB = function (b, c, d) { var e = $(".invite-button", b.QH).filter(function () { return this.getAttribute("data-uid") === c }).get(0); e && JB(b, e, d) }; t.GG = function () { var b = $(this), c = $(".zm-item-link-avatar", b); return { id: String($("button", b).data("uid")), avatar: $("img", c).attr("src"), fullname: c.attr("title"), url_token: c.attr("href").split("/").slice(-1)[0] } };
        a.HB = function (b, c) { b.Fl.unshift(c); LB(b); $(".ignore-invite-hint").css("display", "none") }, a.KB = function (b, c) { b.Fl && z.iS(b.Fl, function (b) { return b.id === c }) && (LB(b), $(".ignore-invite-hint").css("display", "none")) }; t.ZS = '您已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
        t.uM = '<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
        a.LB = function (b) { var c = b.Fl, d = { each: z.forEach, fullList: function () { return Rk(b.uM, { persons: c, helper: d }) } }; b.zx.innerHTML = c.length ? Rk(b.ZS, { persons: c, helper: d }) : "" }; a.MB = function (b) { this.data = b; this.ra = k }; y(MB, T); t = MB.prototype; t.C = function () { MB.n.C.call(this); this.h().e(this.g, "click", this.Nl); var b = J("panel-container", this.g); b && (this.Ej = new EB, this.J(this.Ej), this.Ej.o(b), this.ra = new Iw(this.data.la, "question"), this.Ej.J(this.ra), Mw(this.ra, this.Ej.m(), $(".toggle-comment", this.g)[0]), NB(this)); this.h().e(this, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("label", "question") }) };
        t.Nl = function (b) {
            var c = (b = Kk(this.g, b.target)) && b.name; if (c) switch (c) {
                case "report-question": Eu("question", this.data.la, '<a href="http://www.zhihu.com/question/19806261" class="zg-link-gray">知乎提问规范</a>'); break; case "addcomment": "添加评论" === $.trim($(b).text()) ? mn(this.sl, { wa: "question_add_comment_start" }).call(this, b) : this.sl(b); break; case "remove": Di("删除问题", "你确定要删除这个问题吗？相关的评论也将被删除。", function (b) {
                    if (b) {
                        var c = new V(j); N(c, "complete", function () { var b = Ie(c); b && !b.r ? window.location.href = "/" : U(b.msg) }); c.ajax("/question/delete/" +
                        this.data.la)
                    }
                }, this); break; case "admin": c = this.EJ; c || (c = new CB, c.o(H("zh-question-admin-menu")), Ph(c, function (b) { b.Ba(b.m().getAttribute("data-action")) }), this.h().e(c, "action", function (b) { b = this.pB = b.target; (new ww).open(b.m(), { id: this.data.la, type: "question" }, v(this.mL, this)) }), this.EJ = c); c.S() ? c.F(m) : DB(c, new Rt(b, 1, j), 0, new Of(5, 0, 5, 0)); break; case "share": Y.V({ type: "ga_click_share_question_box", target: b }); this.zc(); break; case "invite": this.Sw()
            }
        };
        t.sl = function (b) { this.ra.yf(); this.ra.lc() && this.ra.oi("view_comments", parseInt(Gc(b), 10) || 0) }; a.NB = function (b) { if ("normal" === eh.status) { var c = new FB(b.data.la, b.data.Jb), d = H("question-invite-panel"); d ? (c.o(d), b.Ej.J(c), c.Ka(!b.ra.lc()), b.dispatchEvent(new vw("show!invitation", { category: "invitation", action: "ask_to_answer_card", label: "" }))) : (c.Y(b.Ej.m()), b.Ej.J(c)); b.yx = c } };
        t.Sw = function () { if (this.yx) { this.yx.yf(); var b = this.yx.lc(); this.dispatchEvent(new vw("click!invitation", { category: "invitation", action: (b ? "show" : "hide") + "_ask_to_answer_card", label: "?", value: this.data.ne })) } else NB(this) }; t.zc = mn(function () { new jv(["分享问题", "question", this.data.Jb, { qid: this.data.la }], "tb-webshare-sina") }, { wa: "question_question_share" }); t.mL = function (b) { this.pB.X(b.msg.action); this.pB.im(b.msg.caption) }; a.Zw = function (b, c) { this.vb = b; this.entryType = c; this.Xl = k; this.gd = m }; y(Zw, T); t = Zw.prototype; t.lc = p("gd"); t.Ka = function (b) { this.gd = !!b }; t.Va = function () { return this.Jp.data("votecount") }; t.ei = function () { this.Xl && "pending" === this.Xl.state() || (this.Xl = ("post" === this.entryType ? $u : fu)(this.vb, this.gd).done(v(this.dt, this))) }; t.dt = function (b) { if (b = La(b)) b = $(b), this.Jp.replaceWith(b), this.Jp = b, this.Ra(), this.dispatchEvent("change") }; t.Ra = function () { var b = this; $("a.more", this.Jp).click(function () { b.Ka(j); b.ei() }) };
        t.C = function () { this.Jp = $(this.g); this.Ra() }; a.OB = function (b) { this.K = $(b); this.Jg() }; OB.prototype.Jg = function () { var b = [this.K.get(0)].concat(this.K.parents().get()), c = $.map(b, function (b) { return $(b).data("navigable") })[0], d = c && $.grep(c.items(), function (c) { return ~$.inArray(c, b) })[0]; this.IY = c; this.SP = d }; OB.prototype.getItem = p("SP"); a.PB = function (b, c, d, e) { Tr.call(this, b, c, d, e) }; y(PB, Tr); PB.prototype.Od = function () { $(window).on("beforeunload.AnswerEditor", v(s("你的修改还未保存，确认离开该页面吗？"), this)) }; PB.prototype.ue = function () { $(window).off("beforeunload.AnswerEditor") }; PB.prototype.eh = function () { PB.n.eh.call(this); this.ue() }; PB.prototype.qd = function () { PB.n.qd.call(this); this.Od() }; a.QB = function () { this.$u = [] }; y(QB, Ju); ia(QB); QB.prototype.w = function (b) { var c = QB.n.w.call(this, b); E.add(c, "goog-submenu"); RB(this, b, c); return c }; QB.prototype.o = function (b, c) { c = QB.n.o.call(this, b, c); E.add(c, "goog-submenu"); RB(this, b, c); var d = Vb("div", "goog-menu", c); if (d.length) { var e = new Ru(b.L()), d = d[0]; Q(d, m); b.L().Da().body.appendChild(d); e.o(d); b.Zg(e, j) } return c };
        QB.prototype.Ja = function (b, c) { var d = this.Z(b), e = d && d.lastChild; QB.n.Ja.call(this, b, c); e && (d.lastChild != e && E.has(e, "goog-submenu-arrow")) && d.appendChild(e) }; QB.prototype.De = function (b) { QB.n.De.call(this, b); var c = b.Z(), d = b.L(), d = Ub(d.Ha, "span", "goog-submenu-arrow", c)[0]; SB(b, d); d != c.lastChild && c.appendChild(d); Oc(b.m(), Vc.xk, "true") };
        a.RB = function (b, c, d) { var e = c.L().w("span"); e.className = "goog-submenu-arrow"; SB(c, e); b.Z(d).appendChild(e) }, a.SB = function (b, c) { b.Cd() ? (E.add(c, "goog-submenu-arrow-rtl"), yc(c, b.aq ? "◄" : "►")) : (E.remove(c, "goog-submenu-arrow-rtl"), yc(c, b.aq ? "►" : "◄")) }; a.TB = function (b, c, d, e) { Ou.call(this, b, c, d, e || QB.T()) }; y(TB, Ou); a.UB = 218; t = TB.prototype; t.Ld = k; t.Rz = k; t.vE = m; t.rc = k; t.er = m; t.aq = j; t.$O = m; t.C = function () { TB.n.C.call(this); this.h().e(this.getParent(), "hide", this.oG); this.rc && VB(this, this.rc, j) }; t.jb = function () { this.h().Fa(this.getParent(), "hide", this.oG); this.rc && (VB(this, this.rc, m), this.er || (this.rc.jb(), L(this.rc.m()))); TB.n.jb.call(this) }; t.z = function () { this.rc && !this.er && this.rc.H(); this.rc = k; TB.n.z.call(this) };
        t.pd = function (b, c) { TB.n.pd.call(this, b); c && (this.Za().Uf = j); b || (this.Ld && Id.clearTimeout(this.Ld), this.Ld = Ld(this.yg, UB, this)) }; t.zt = function () { var b = this.getParent(); b && Lt(b) == this && (WB(this, j), XB(this), this.yY = m) }; t.yg = function () { var b = this.rc; b && b.getParent() == this && (WB(this, m), Ph(b, function (b) { "function" == typeof b.yg && b.yg() })) }; a.YB = function (b) { b.Ld && Id.clearTimeout(b.Ld); b.Rz && Id.clearTimeout(b.Rz) }; t.F = function (b, c) { var d = TB.n.F.call(this, b, c); d && !this.S() && this.yg(); return d };
        a.XB = function (b) { Ph(b.getParent(), function (b) { b != this && "function" == typeof b.yg && (b.yg(), YB(b)) }, b) }; t.Zb = function (b) { var c = b.keyCode, d = this.Cd() ? 37 : 39, e = this.Cd() ? 39 : 37; if (this.vE) { if (!this.Za().Zb(b)) if (c == e) this.yg(); else return m } else if (this.isEnabled() && (c == d || c == this.ly)) this.zt(), Mt(this.Za()), YB(this); else return m; b.preventDefault(); return j }; t.jQ = function () { this.rc.getParent() == this && (YB(this), this.Rl.pd(this), XB(this)) }; t.oG = function (b) { b.target == this.Rl && (this.yg(), YB(this)) };
        t.kd = function (b) { this.isEnabled() && (YB(this), this.Rz = Ld(this.zt, UB, this)); TB.n.kd.call(this, b) }; t.$d = function (b) { YB(this); if (this.Rb & 8) return TB.n.$d.call(this, b); this.zt(); return j };
        a.WB = function (b, c) { b.dispatchEvent(Lh(64, c)); var d = b.Za(); if (c != d.S() && (c && (d.Aa || d.Y(), d.Qb(-1)), b.vE = c, E.enable(b.m(), "goog-submenu-open", c), d.F(c), c)) { var d = new Rt(b.m(), b.aq ? 6 : 4, b.$O), e = b.Za(), g = e.m(); e.S() || (g.style.visibility = "hidden", Q(g, j)); d.ma(g, b.aq ? 4 : 6); e.S() || (Q(g, m), g.style.visibility = "visible") } }, a.VB = function (b, c, d) { var e = b.h(); (d ? e.e : e.Fa).call(e, c, "highlight", b.jQ) }; t.Ga = function (b) { this.Za().J(b, j) }; t.zi = function (b, c) { this.Za().Ak(b, c, j) };
        t.removeItem = function (b) { (b = this.Za().removeChild(b, j)) && b.H() }; t.Mh = function (b) { return Rh(this.Za(), b) }; t.ml = function () { return Qh(this.Za()) }; t.Mb = function () { return this.Za().Mb() }; t.Za = function () { this.rc ? this.er && this.rc.getParent() != this && Oh(this.rc, this) : this.Zg(new Ru(this.L()), j); this.rc.m() || this.rc.w(); return this.rc }; t.Zg = function (b, c) { var d = this.rc; b != d && (d && (this.yg(), this.Aa && VB(this, d, m)), this.rc = b, this.er = !c, b && (Oh(b, this), b.F(m, j), b.Fm = m, b.Ne(m), this.Aa && VB(this, b, j))) }; t.Cf = function (b) { return this.Za().Cf(b) };
        gp("goog-submenu", function () { return new TB(k) }); a.ZB = function (b, c, d, e) { TB.call(this, b, c, d, e) }; y(ZB, TB); ZB.prototype.Zb = function (b) { var c = ZB.n.Zb.call(this, b), b = parseInt(jk[b.keyCode], 10); isNaN(b) || this.Za().Qb(b - 1); return c }; a.ex = function (b, c, d) { T.call(this); this.la = b; this.qa = d; this.yL = c || eh; this.hv = k }; y(ex, T); a.$B = { all_can_comment: "允许任何人评论", followee_can_comment: "允许我关注的人评论", nobody_can_comment: "关闭评论" }; t = ex.prototype; t.ey = function () { nv("answer", this.Jb, "read") }; t.Dj = function () { nv("answer", this.Jb, /^\/question\//.test(location.pathname) ? "read" : "touch") };
        t.C = function () {
            function b() { c(); var b = q.Zp.Mh(0); b.Za && b.Za() && (b.zt(), b.Za().Qb(0)) } function c() { aC(q); q.Zp.Qb(0) } ex.n.C.call(this); var d = J("zm-item-answer", this.g) || this.g; this.qa = d.getAttribute("data-aid"); this.Ie = "1" === d.getAttribute("data-isowner"); this.Jb = d.getAttribute("data-atoken"); this.Lg = "1" === d.getAttribute("data-deleted"); this.mv = +d.getAttribute("data-created"); this.iO = +d.getAttribute("data-helpful"); this.YO = "1" === d.getAttribute("data-good"); this.tj = "1" === d.getAttribute("data-collapsed");
            this.kb = k; this.Af = J("zm-item-answer-author-info", this.g); d = m; !S.wa() && 0 < $(this.g).parents('div[data-fixed-summary="1"]').length && (d = j); var e = {}; e.kr = !!d; d = this.Gt = new Au(e); this.J(d); d.o(this.g); d.hd() && P(this.h(), d, "expand", this.ey); zu(this.g, this.Dj, this); this.nc = this.nc || J("zm-item-meta", this.g); (this.mo = J("zm-meta-panel", this.nc)) && this.h().e(this.mo, "click", this.Nl); if (this.Ie) {
                d = $('[name="comment_opt"]', this.nc); if (d.length) {
                    var e = d.data(), g = new Ru, h = new kB("禁止转载"); h.$c(!e.copyable); g.Ga(h);
                    g.Ga(new Qu); this.iv = []; F.forEach($B, function (b, c) { var d = new kB(b); d.Ba(c); d.$c(c === this.hv); this.iv.push(d); g.Ga(d) }, this); g.Ga(new Qu); g.Ga(new Ou("删除")); this.h().e(g, "action", this.SM); bC(this, g); E.add(g.m(), "zg-gray-normal"); e = new Ez("comment", g); e.am = j; Hz(e); Gz(e); e.vc = nf; e.o(d[0]); this.AX = g
                } this.Af && (this.AG = (this.kb = Xa(this.Af.innerHTML, "匿名用户")) ? k : this.Af.innerHTML.replace(/src=".+?"/g, 'src="' + S[2] + '"'), this.h().e(this.Af, "click", function (b) { "cancel-anon" === b.target.name && ct(m) }))
            } else this.vx();
            if (d = J("zm-item-vote-info", this.g)) { this.mk = new Zw(this.qa); this.J(this.mk); this.mk.o(d); d = $(".zm-item-vote-count", this.g); d[0] || (d = $(".zm-item-vote-count", this.nc)); var l = [d[0], $(".zm-votebar .count", this.g)[0]]; if (l.length) { var n = this.mk; this.mk.on("change", function () { z.forEach(l, function (b) { zk(b, n.Va()) }) }) } } this.Pn(); $(this.g).on("contentchange", $.proxy(this.Pn, this)); this.px(); this.Ra(); d = new OB(this.g); d = xk.FI(d.getItem() || this.g); wk(wk(wk(wk(wk(wk(wk(d.register("v", function () { this.tb && this.tb.Qt() },
            this), { group: "操作", name: "赞同" }).register("d", function () { this.tb && this.tb.Pt() }, this), { group: "操作", name: "反对" }).register("f x", this.zc, this), { group: "操作", name: "分享" }).register("s c", this.tl, this), { group: "操作", name: "收藏" }).register("t", this.zr, this), { group: "操作", name: "感谢" }).register("c", this.Kw, this), { group: "操作", name: "打开评论" }).register("shift+c", this.sl, this), { group: "操作", name: "定位到评论框" }); var e = kb ? "⌘" : "ctrl", q = this; ch.TE && $("a[name=admin]", this.nc)[0] && wk(wk(d.register("meta+.", c), {
                group: "管理", name: "展开菜单", key: e +
                "+."
            }).register("meta+k", b), { group: "管理", name: "展开折叠子菜单 (Kill)", key: e + "+k" }); if (sb && !Ng && (d = J("more-actions", this.nc))) {
                var r = { share: { label: "分享", action: this.zc }, fav: { label: "收藏", action: this.tl }, report: { label: "举报", action: this.yr }, nohelp: { label: this.iO ? "没有帮助" : "撤销没有帮助", action: this.bE } }, w = new Ru, e = function (b) { Qh(w) && w.Ga(new Qu); var c = new Ou(r[b].label); c.Ba(b); w.Ga(c) }; e("share"); e("fav"); this.Ie || (e("nohelp"), S.wa() && e("report")); e = new Ez("operation", w); e.am = j; Hz(e); Gz(e); e.Ol = ba(); e.vc = nf; e.o(d); E.add(w.m(),
                "zh-answer-more-actions"); this.h().e(w, "action", function (b) { var c = r[b.target.X()]; c && c.action && c.action.call(this, b) })
            }
        }; t.Kz = function (b) { var c = this.Pn(); c && zr(c, b) };
        t.vx = function () { var b = J("zm-votebar", this.g) || J("zm-votebar", this.mo); if (b) { var c = new av(this.qa); c.o(b); this.tb = c; this.h().e(c, "change", this.fS).e(c, "action", function (b) { b.data.state === bv.je ? Y.V({ type: "ga_click_vote_up", target: this }) : b.data.state === bv.og && Y.V({ type: "ga_click_vote_down", target: this }) }); (b = J("votenum-mobile", this.mo)) && (new Xw(c)).o(b) } };
        t.Pn = function () { if (this.Fp) return this.Fp; var b = J("zm-editable-content", this.g), c = this.tb && this.tb.m(); !this.Ie && (!sb && S.wa()) && (c && $(c).is(":visible") && b && 230 < $(b).height()) && (b = this.Fp = new Cr(k, b), this.J(b), b.hh = "votebar", b.Ry = 50, b.o(c)) }; t.fS = function () { this.mk && this.mk.ei() };
        a.cC = function (b) { if (!b.me && b.Ie && eh && b.qa) { b.me = new PB(m, "/answer/content", "content"); Sc(b, b.me); b.me.Ut = j; b.me.Hv = j; b.me.MD = zB.prototype.MD; var c = J("zm-item-rich-text", b.g); b.me.params = ["id=" + b.la]; b.me.o(c); b.h().e(b.me, "shouldUpdateContent", function (b) { if (ma(b.data)) return m }); b.h().e(b.g, "click", function (b) { "suggest_edit" === b.target.name && (this.me.qd(), $(".zh-question-censor-tip", this.g).hide()); return j }) } };
        t.Ra = function () { this.Af && this.h().e(this.Af, "click", this.ka); this.Ie && (this.qK = S); this.h().e(Mi, "anon_change", function (b) { this.Ie ? this.pt(b.kb) : this.tb.Ud() === bv.je && this.mk.ei() }); cC(this); $(this.g).on("focusin focusout", function (b) { $(this).toggleClass("focusin", "focusin" === b.type) }) }; t.cf = function (b) { return Kk(this.g, b) };
        t.ka = function (b) { if (b = (b = this.cf(b.target)) && b.name) if ("edit" === b) { b = rB(); if (!this.Ku) { var c = eh.Jb; b.Ux = j; b.$G = c; this.h().e(b, "change", this.xy) } this.Ku = j; sB(b) } else "complex" === b && (b = J("zm-item-answer-summary", this.g), c = J("zm-item-rich-text", this.g), Q(b, m), Q(c, j)) }; t.xy = function () { var b = rB().lw() || S[4] || ""; if (b) { var c = J("zu-question-my-bio", this.Af); c.title = b; c.innerHTML = b } }; t.px = function () { var b = J("zm-item-answer-author-wrap", this.g), b = J("zm-list-avatar", b); ek.add(b) };
        t.pt = function (b) {
            b ? this.Af.innerHTML = '<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>' : this.Ie && (this.AG ? this.Af.innerHTML = this.AG.replace("</h3>", "").replace("</H3>", "") + '<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>' : (b = [], b.push('<h3 class="zm-item-answer-author-wrap">'), b.push(Xt()), b.push(Yt(S, "zm-item-answer-creator")), b.push("</h3>"), this.Af.innerHTML =
            b.join("")))
        };
        a.dC = function (b, c) { if (!b.ra) { b.ra = new Iw(b.qa, "answer", c); b.J(b.ra); Mw(b.ra, b.nc, $(".toggle-comment", b.nc)[0]); Vw(b.ra); var d = location.hash.slice(1).split("-"); "comment" === d[0] && d[1] && (b.ra.Ka(j), b.h().e(b.ra, "expand", function () { Kw(this.ra) })) } }, a.aC = function (b) {
            if (b.Zp) b.Zp.F(j); else {
                var c; var d = $("a[name=admin]", b.nc)[0]; if (d) {
                    b.FJ = d; UB = 0; c = new CB; b.J(c); c.attach(d, 5); var e = b.tj ? new Ou("取消折叠") : new ZB("折叠"); e.Ba("collapse"); var g = function (b, c) { var d = new Ou(c + 1 + " " + b.label); d.Ba(b.value); e.Ga(d) };
                    b.tj || yw("answer", "collapse").then(function (b) { z.forEach(b, g); E.add(e.Za().m(), "manage-menu") }); d = new Ou("删除"); d.Ba("delete"); c.Ga(e); c.Ga(d); c.Y(b.g); E.add(c.m(), "manage-menu")
                } else c = i; c && (DB(c, new Rt(b.FJ, 1, j), 0, new Of(5, 0, 5, 0)), b.h().e(c, "action", function (b) {
                    var c = b.target, b = c.X(), c = c.m(), d = new kj; "collapse" === b ? (d.add("answer_id", this.qa).add("action", "collapse2").add("collapse", this.tj ? "cancel" : "done"), c.setAttribute("data-op", this.tj ? "uncollapse-answer" : "collapse-answer"), c.setAttribute("data-action",
                    "/manage?" + d.toString()), eC(this, c)) : "delete" === b ? (d.add("answer_id", this.qa).add("action", "remove_answer2"), c.setAttribute("data-op", "remove-answer"), c.setAttribute("data-action", "/manage?" + d.toString()), eC(this, c)) : pa(b) && (c = new kj, c.add("answer_id", this.qa).add("action", "collapse2").add("collapse", this.tj ? "cancel" : "done").add("reason", b), xw("/manage", c.toString(), v(this.rG, this)))
                }), bC(b, c), b.Zp = c)
            }
        }; t.rG = function () { var b = $(this.g); b.hide("fast", function () { b.remove() }); this.H() };
        a.eC = function (b, c) { (new ww).open(c, { id: b.qa, type: "answer" }, v(b.rG, b)) };
        t.Nl = function (b) {
            var c = this.cf(b.target), d = c && c.name; if (d) switch (d) {
                case "addcomment": this.Kw(); this.ra.lc() && this.ra.oi("view_comments", parseInt(Gc(c), 10) || 0); break; case "remove": this.vl(); break; case "thanks": Y.V({ type: "ga_click_thank_answer", target: c }); this.zr(); break; case "comment_opt": if (!this.hv && (!this.lC || !this.lC.ac())) b = new V(j), P(this.h(), b, "success", function (b) { if ((b = Ie(b.target)) && !b.r) { var c = b.msg; z.forEach(this.iv, function (b) { b.X() === c && b.$c(j) }); this.hv = c } else U(b.msg) }), b.ajax("/answer/comment_permission?answer_id=" +
                this.qa, k, "GET"), this.lC = b; break; case "admin": aC(this); break; case "share": Y.V({ type: "ga_click_share_answer_box", target: c }); this.zc(); break; case "nohelp": this.bE(b); break; case "report": this.yr(); break; case "favo": Y.V({ type: "ga_click_collect_answer_box", target: c }), this.tl()
            }
        }; t.yr = function () { Eu("answer", this.qa) };
        t.bE = mn(function (b) { var b = b.target, c = !!b.m; Y.V({ type: "ga_click_answer_not_helpful", target: c ? b.m() : b }); this.yv && "pending" === this.yv.state() && this.yv.abort(); var d, e; e = c ? b.Cg() : b.innerHTML; e = (d = -1 < e.indexOf("撤销")) ? "没有帮助" : "撤销没有帮助"; c ? b.im(e) : b.innerHTML = e; d = d ? "/answer/helpful" : "/answer/not_helpful"; c || Gk(b); this.yv = $.post(d, { aid: this.qa }) }, { wa: "question_answer_not_helpful", qg: j }); t.zc = mn(function () { new jv(["分享回答", "answer", this.Jb, { aid: this.qa }], "tb-webshare-sina") }, { wa: "question_answer_share" });
        t.tl = mn(function () { var b = lx(); qx(b, this.qa); b.show() }, { wa: "question_answer_collect", qg: j }); t.jL = function () { this.ra || dC(this); this.ra.yf(); $(this.mo).toggleClass("focusin", this.ra.lc()) }; t.Kw = mn(ex.prototype.jL, function () { return { wa: "添加评论" === $.trim($(J("toggle-comment", this.g)).text()) ? "question_answer_add_comment_start" : m } }); t.sl = mn(function (b) { this.ra && this.ra.lc() ? this.ra.field.focus() : this.Kw(); b.preventDefault() }, { wa: "question_answer_add_comment_start" });
        t.zr = mn(function () { var b = $("a[name=thanks]", this.nc)[0]; b && !E.has(b, "disabled") && (zk(b, "已感谢"), E.add(b, "disabled"), Gk(b), $.post("/answer/thanks", { aid: this.qa })) }, { wa: "question_answer_thank" }); a.bC = function (b, c) { b.h().e(c, "show", function () { E.add(this.nc, "zm-item-meta-has-menu") }).e(c, "hide", function (b) { b.currentTarget === b.target && E.remove(this.nc, "zm-item-meta-has-menu") }) };
        t.SM = function (b) { var c = b.target, b = c.X(); "禁止转载" === b ? (b = !c.Ee(), $.post("/node/AnswerMetaV2", { method: "set_copyright", params: { answer_id: this.qa, is_copyable: Number(b) } }), $(".copyright", this.nc).html(b ? "" : '<span class="zg-bull">&bull;</span> 禁止转载')) : "删除" === b ? this.vl() : b in $B && $.post("/answer/comment_permission", { answer_id: this.qa, permission: b }).done(v(function (b) { b && !b.r && z.forEach(this.iv, function (b) { b.$c(b === c) }) }, this)) };
        t.vl = function () { Di("你确定要删除自己的答案吗？", "答案内容不会被永久删除，你还可以撤消本次删除操作。", function (b) { b && (this.Lg = j, this.status = -1, fC(this)) }, this) }; a.fC = function (b) { var c = new V(j); P(b.h(), c, "success", function () { Q(this.g, !this.Lg); this.Lg ? this.nu = "set_delete" : (cC(this), this.nu = "cancel_delete"); this.dispatchEvent("change"); $(this.g).parent(".zm-item").hide() }); c.ajax("/answer/" + (b.Lg ? "remove" : "unremove"), "aid=" + b.qa) }; t.m = p("g"); a.gC = function (b, c, d) { ex.call(this, b, c, d) }; y(gC, ex); gC.prototype.o = function (b) { gC.n.o.call(this, b); this.Ie && this.pt(this.yL.kb) }; gC.prototype.S = function () { return $(this.g).is(":visible") }; a.hC = function () { T.call(this); this.data = eh || {}; this.la = this.data.la; this.Yn = m; this.Ai = {}; this.Gu = []; this.dq = []; this.Xh = 0; this.Vf = fh && fh.url_token ? fh : k }; y(hC, T); t = hC.prototype; t.B = function () { zs.J(this); this.o(document.body) };
        t.C = function () { hC.n.C.call(this); var b = H("zh-question-meta-wrap"); b && (this.SG = new MB(this.data), this.J(this.SG), this.SG.o(b)); this.tx(); var c = this; $(".js-ignore-invite").click(function () { $(".question-invited-by").hide(); $.post("/question/askpeople", { qid: c.data.Jb, uid: S.ws, op: "pass" }) }); this.ro = new Ky; this.h().e(this.ro, "change", this.Uy); this.ro.B(); this.EH() };
        t.EH = function () {
            this.data.Jb = eh.Jb; iC(this, j); if (S.wa() && ("close" !== eh.status && (this.Oa = new Rp(this.data.yA, this.data.la), this.Oa.us = 5, this.Oa.xs = 1, this.Oa.sB = j, this.Oa.Cs = j, this.Oa.o(J("zm-tag-editor", this.g)), this.h().e(this.Oa, ["remove_tag", "add_tag"], function () { Y.V("ga_edit_question_topic_changed") }), this.h().e(this.Oa, "start_editing", function () { Y.V("ga_question_topic_edit_finish_changed") }), this.Oa.addEventListener("beforeedit", By({ Yl: j }))), "close" !== eh.status)) {
                var b = H("zh-question-title");
                if ("false" !== b.getAttribute("data-editable")) {
                    this.bd = new by(this.data.la, "/question/title", "content", m, j); this.bd.Sq = j; this.bd.zd = j; this.bd.Vj = j; var c = au(this.data.Qj); this.bd.Xn = c; this.bd.o(b); this.h().e(this.bd, "change", function () { Mi.dispatchEvent("question_title_change"); document.title = this.bd.eb() + " - 知乎" }); this.h().e(this.bd, "click_edit", function () { Y.V("ga_question_title_edit_start") }); this.h().e(this.bd, "cancel_edit", function () { Y.V("ga_question_title_edit_cancel") }); this.h().e(this.bd, "save_changed",
                    function () { Y.V("ga_question_title_edit_save_changed") }); this.h().e(this.bd, "save_unchanged", function () { Y.V("ga_question_title_edit_save_unchanged") }); this.bd.addEventListener("beforeedit", By({ Yl: j }))
                }
            } this.fq = H("zh-question-answer-num"); this.gq = H("zh-question-answer-wrap"); this.xh = H("zh-question-collapsed-link"); this.Zm = H("zh-question-collapsed-wrap"); this.dL = H("zh-question-collapsed-num"); this.iK = H("zh-question-answer-form-wrap"); this.hk = H("zh-question-notification-summary"); this.sm = H("zh-answers-filter");
            this.Ws = H("zh-add-question-sug"); this.fq && (this.data.ne = +this.fq.getAttribute("data-num")); this.gq && (this.data.AR = +this.gq.getAttribute("data-pagesize")); this.xh && this.h().e(this.xh, "click", this.ET); this.Ws && this.h().e(this.Ws, "click", this.WD); this.sm && Sg && this.h().e(this.sm, "click", function (b) { b.stopPropagation(); E.add(this.sm, "activated"); P(this.h(), document, "click", function () { E.remove(this.sm, "activated") }) }); (this.fv = H("zg-question-suggested-topics")) && this.h().e(this.fv, "click", this.$P); this.On();
            this.h().e(window, "hashchange", function (b) { b = b.Yb; b.oldURL && "writing" === b.oldURL.split("#")[1] || jC(this) }); if (b = H("zh-question-answer-wrap")) { var d = new Bu({ pa: ["expandLimit", "nodeSource"], bh: this.data.ne > this.data.AR && !J("question-page-pager") }); this.J(d); this.h().e(d, "itemcreated", function (b) { d.J(kC(this, b.item)); $("img.lazy", b.item).lazyload({ data_attribute: "actualsrc", threshold: 400 }) }); d.o(b) } b = S[4]; gh && gh.length && (b = gh[0][1]); this.Ab = new zB(this.data.kb, S, b); this.J(this.Ab); this.Ab.o(this.iK);
            lh && lh.length ? this.Ab.Ja(lh[0]) : !ch.Ac && B && this.Ab.Ja("<p></p>"); if (!this.data.Gx && !this.Xh && (!this.Vf || !this.Vf.url_token)) if (this.data.Gm && this.data.Gm.length && this.data.Gm[3] !== S[3]) this.Ab.$a(m, "只有 " + Yt(this.data.Gm) + " 能回答此问题"); else if ("normal" === eh.status || lh) S.Qj || this.Ab.qd(); this.h().e(this.Ab, "change", this.aQ); this.h().e(this.Ab, "cancel_delete_answer", this.iQ); this.Ab.ready(function () { var b = this.nr(); b && "writing" === location.hash.slice(1) && b.execCommand("toggleFullScreen") }); lC(this); jC(this,
            k); mC(this); this.h().e(Mi, "anon_change", function (b) { this.data.kb = b.kb }); dh && setTimeout(function () { location.href = dh }, 5E3)
        }; t.tx = function () { nv("question", this.data.Jb, "read"); this.h().e(this, ["click!", "show!"], function (b) { "comment" === b.namespace && b.Qc.fill("category", "question_answer").fill("label", "question_answer"); "invitation" === b.namespace && b.Qc.fill("label", "question_page") }) };
        t.Uy = function () { this.eO = j; this.hk = $(this.ro.UP)[0]; lc(this.hk, H("zh-question-redirect-info")); Q(this.hk, j); ch.Ac || (this.Zi = new ur, this.Zi.o(this.hk), Ws(this.Zi)); this.h().e(this.hk, "click", this.WD); jC(this) }; a.iC = function (b, c) { !S.wa() || !c ? (nC(b, "zh-question-detail", ha), nC(b, "zh-question-answer-summary", ha)) : (nC(b, "zh-question-detail", b.zO), nC(b, "zh-question-answer-summary", b.BO)) }, a.nC = function (b, c, d) { if (c = H(c)) { var e = new Au; b.h().e(e, "expand", d).e(e, "invalid", d); e.o(c) } };
        t.zO = function (b) {
            if ("close" !== eh.status) {
                b = b.target.m(); this.Bb = new by(this.data.la, "/question/detail", "content", j, k, 600); var c = au(this.data.Qj); this.Bb.Xn = c; this.Bb.wX = Mk; J("zm-editable-content", b).innerHTML && (this.Bb.Vj = j); this.Bb.o(b); this.h().e(this.Bb, "click_edit", function () { Y.V("ga_question_supplement_edit_start") }); this.h().e(this.Bb, "cancel_edit", function () { Y.V("ga_question_supplement_edit_cancel") }); this.h().e(this.Bb, "save_changed", function () { Y.V("ga_question_supplement_edit_save_changed") });
                this.h().e(this.Bb, "save_unchanged", function () { Y.V("ga_question_supplement_edit_save_unchanged") }); this.Bb.addEventListener("beforeedit", By({ Yl: j }))
            }
        };
        t.BO = function (b) { var b = b.target.m(), c = H("zh-question-answer-summary-link"), d; if (b && (ch.TE || !this.data.CT)) d = new Tr(j, "/question/summary", "content"), d.params = ["id=" + this.data.la], d.wq = m, d.o(b); if (c) { var e = H("zh-question-answer-summary-wrap"); this.h().e(c, "click", function () { d && (Q(e, j), d.qd()) }).e(e, "click", function (b) { "cancel" === b.target.name && (b = !d.Nf(), Q(e, !b)) }) } this.BT = d; this.BT.addEventListener("beforeedit", By({ Yl: j })) };
        t.WD = function (b) {
            if ("close" === b.target.name) { if (this.Zi && (Ar(this.Zi), zr(this.Zi, m), history.replaceState)) { var b = new vf(location.href), c = b.Kc(); c.remove("q"); c.remove("psq"); history.replaceState({}, "", b.Zf + "?" + c.toString()) } Q(this.hk, m); Q(this.Ws, m) } else if ("A" === b.target.tagName && "zh-question-suggest-reask" === b.target.id && (Q(this.Ws, m), Y.fireEvent("query_string_change")), c = "a" === $(b.target).prop("tagName").toLowerCase() ? b.target : this.cf(b.target, "A")) b.preventDefault(), b.stopPropagation(), b = c.getAttribute("data-source") ||
            c.href, c = b.indexOf("#"), b = 0 > c ? k : b.substr(c + 1), jC(this, b && decodeURIComponent(b))
        };
        a.mC = function (b) { b.data.Bq = +b.dL.innerHTML; S.wa() || (b.data.Bq = 0); Q(b.xh, 0 < b.data.Bq); b.fq && yc(b.fq, b.data.ne ? b.data.ne + " 个回答" : "还没有回答"); b.sm && Q(b.sm, 1 < b.data.ne); Q(b.xh, 0 < b.data.Bq) }, a.kC = function (b, c, d, e) { e = new gC(b.la, k, e); e.o(c); b.Ai[e.qa] = e; b.dq.push(e.qa); b.h().e(e, "change", b.wy); e.Ie && (b.Xh = e.qa, e.qK = S, b.h().e(e.me, "change", b.BN), b.rg = e); e.tj ? e.Ie && b.Zm.appendChild(e.m()) : b.Gu.push({ added_time: e.mv, vote: d, aid: e.qa }); e.Lg && Q(e.m(), m); return e };
        t.BN = function () { var b = this.rg, c = b.m(), d = b.me.eb()[0]; Q(c, m); d = gc(La(d)); kc(d, c); this.Ai[b.qa] = k; this.dq = z.filter(this.dq, function (c) { return c !== b.qa }, this); var e = 999; this.Gu = z.filter(this.Gu, function (c) { c.aid === b.qa && (e = c.vote); return c.aid !== b.qa }, this); L(c); b.H(); kC(this, d, e, m) };
        t.wy = function (b) { b = b.target; if (b instanceof gC) { var c = b.m(); switch (b.nu) { case "collap": this.Zm.appendChild(c); E.add(c, "zm-item-collapsed"); this.data.ne--; mC(this); break; case "cancel_collap": this.gq.appendChild(c); E.remove(c, "zm-item-collapsed"); oC(this, c); this.data.ne++; mC(this); break; case "set_delete": lC(this); this.data.ne--; mC(this); break; case "cancel_delete": oC(this, this.Ai[this.Xh].m()), lC(this), this.data.ne++, mC(this) } } };
        a.lC = function (b) {
            var c = k, d = k, e, g = { suggest: "建议修改", evaluate: "建议修改", close: "关闭" }; !lh && "normal" !== eh.status && (d = "被" + g[eh.status] + '的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>'); b.Xh ? (e = b.Ai[b.Xh], c = "#answer-" + e.qa, e = e.Lg) : b.Vf && (c = "/question/" + eh.Jb + "/answer/" + b.Vf.url_token, e = b.Vf.is_delete); c && (d = e ? '你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>' : '一个问题你只能回答一次，但你可以对 <a href="' +
            c + '">现有的回答</a> 进行修改'); S.Qj && (!b.Xh && !b.Vf) && (d = '添加回答：<a href="javascript:;" name="answer_my_question">回答自己的提问</a>'); b.data.Gx && (d = '该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>'); d && b.Ab.$a(m, d)
        }; t.FD = function (b) { return this.Ai[b] }; a.pC = function (b, c) { var d = H("zh-question-collapsed-switcher"); c ? (d.name = "collap", b.mC = j, Q(b.Zm, j), E.add(b.xh, "zu-question-collap-title-active")) : (b.mC = m, d.name = "expand", Q(b.Zm, m), E.remove(b.xh, "zu-question-collap-title-active")) };
        t.ET = function (b) {
            if ((b = Kk(this.xh, b.target)) && b.name) if ("expand" === b.name) {
                if (!this.fL) { this.fL = j; var c = this, d = this.Zm, b = $.get("/node/QuestionCollapsedAnswerListV2", { params: { question_id: this.data.la } }); b.done(function (b) { b = gc(b); pC(c, j); E.remove(d, "zm-question-collapsed-list-loading"); d.appendChild(b); z.forEach(pc(d), function (b) { b !== e && kC(c, b, 99999) }); $("img.lazy", d).lazyload({ data_attribute: "actualsrc", threshold: 400 }) }); var e = pc(d)[0]; e && (Q(e, m), b.done(function () { Q(e, j) })); Q(d, j); E.add(d, "zm-question-collapsed-list-loading") } pC(this,
                j)
            } else pC(this, m)
        }; t.iQ = function () { var b = this.Ai[this.Xh], c; b ? (b.Lg = m, b.status = 0, fC(b), oC(this, b.m())) : (c = this.Vf, b = new V(j), P(this.h(), b, "success", function () { window.location.href = "/question/" + eh.Jb + "/answer/" + c.url_token }), b.ajax("/answer/unremove", "aid=" + c.id)) };
        t.aQ = function () {
            var b = this.Ab.cq.checked, c = { MF: j, title: "确认放弃匿名身份？", content: "你在该问题下的赞同和关注行为将以实名显示。" }, d = v(function () {
                if (!this.xhr || !this.xhr.ac()) {
                    var c = this.Ab.Nf(); if (c) {
                        var d = new V(j), h = new kj, l = b ? 1 : 0; h.add("id", this.la).add("content", c).add("anon", l); d.on("success", function () {
                            eh.kb !== l && Mi.dispatchEvent(new Us(l)); var b = Ie(this.xhr); b && !b.r ? (b = gc(La(b.msg[0])), this.gq.appendChild(b), kC(this, b, this.dq.length, j), lC(this), eh.kb || (this.QP = new jB(this.Ai[this.Xh]), this.QP.show()), S.hM && $("#answer-my-question-tip").insertAfter($("#zh-question-answer-form-wrap")).show(),
                            this.data.ne++, mC(this)) : U(b.msg)
                        }, m, this); d.ajax("/answer/add", h.toString()); this.xhr = d
                    }
                }
            }, this); eh.kb && !b ? Di(c, function (b) { b && d() }) : d()
        }; t.cf = ba(); t.$P = function (b) { if ((b = this.cf(b.target)) && b.name) { var c = b.name; "close" === c ? Q(this.fv, m) : "addtag" === c && (this.Oa.Se(b.id.split("-")[1], b.innerHTML), Q(b, m)) } }; t.On = function () { this.Uz = new lB(this.la); this.Uz.B() };
        a.jC = function (b, c) { if (c = c || location.hash.slice(1)) { var d = c.split("-"), e = d[1]; "answer" === d[0] && (d = b.FD(e)) && (d.tj && !b.mC ? oC(b, b.xh) : oC(b, d.m())) } }, a.oC = function (b, c) { if (c) { var d = xg(document.body).top, e = b.eO ? og(b.hk).height : 0, d = { paddingTop: d + e }; "number" === $.type(d) && (d = { offsetTop: d }); d.yI = ut; tt(c, d); Gk(c); b.Zi && b.Zi.Ap() } }; a.qC = function () { hC.call(this); this.data = eh; this.la = this.data.la }; y(qC, hC); t = qC.prototype;
        t.EH = function () {
            (this.Tq = H("zh-single-answer-disable-wrap")) && this.h().e(this.Tq, "click", this.zS); this.Dl(); this.On(); var b = $("#zh-question-answer-collestions"); b.length && $("a[name=focus]", b).click(function () { on(this, "favlist") }); iC(this, m); if (b = $("#zh-question-answer-collections > .zh-general-list").get(0)) { var c = new Bu({ pa: ["autoload", "nodeSource"] }); this.J(c); c.o(b) } if (b = $(".awesome-answer-list").get(0)) {
                var d = new Bu({ pa: ["expandLimit"], bh: m }); this.J(d); this.h().e(d, "itemcreated", function (b) {
                    var c =
                    new bx; c.o(b.item); d.J(c)
                }); d.o(b)
            }
        }; t.tx = function () { this.h().e(this, ["click!", "show!"], function (b) { "invitation" === b.namespace && b.Qc.fill("label", "answer_page") }); qC.n.tx.call(this) }; t.zS = function (b) { b.target && b.target.name && (b = this.Vb, b.Lg = m, b.status = 0, fC(b)) };
        t.Dl = function () {
            var b = J("zm-item-answer", H("zh-question-answer-wrap")); if (b) {
                this.Vb = new gC(this.la); this.J(this.Vb); this.Vb.o(b); b = this.h(); b.e(this.Vb, "change", this.wy); if (this.Vb.Ie) {
                    b.e(Mi, "anon_change", function (b) { var c = b.kb, b = $("#js-sidebar-author-info"); if (!$("a[name=focus]", b).length) { var g = { "0": "fullname", 1: "url_token", 2: "avatar_path", 3: "hash", 4: "headline" }, h = z.reduce(S, function (b, c, d) { b[g[d]] = c; return b }, {}), c = Rk(this.rK, { author: !c && h }); b.html(c) } }); var c = this.Vb.me; c && b.e(c, "change", function () {
                        var b =
                        La(c.eb()[0]), b = gc(b); nc(b, this.Vb.g); this.Dl(b)
                    })
                } rC(this); dC(this.Vb, { autofocus: m, rF: j })
            }
        }; t.FD = function (b) { if (this.Vb.qa === b) return this.Vb }; t.rK = '<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
        t.On = function () { this.Uz = new lB(this.la, this.Vb); this.Uz.B(); var b = H("js-sidebar-author-info"); b && (new yy(b)).B() }; t.wy = function (b) { b = b.target; if (b instanceof gC) switch (b.nu) { case "collap": E.add(b.m(), "zm-item-collapsed"); break; case "cancel_collap": E.remove(b.m(), "zm-item-collapsed"); break; case "set_delete": case "cancel_delete": rC(this), location.reload() } };
        a.rC = function (b) { b.Vb ? b.Vb.Lg ? (b.Tq.innerHTML = b.Vb.Ie ? '你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>' : "此答案已经被作者删除", Q(b.Vb.m(), m)) : Q(b.Vb.m(), j) : b.Tq.innerHTML = "此答案已经被作者删除" }; a.sC = function () { T.call(this); this.page = 1 }; y(sC, T); sC.prototype.B = function () { var b = J("js-topic-feed-page"); this.o(b) };
        sC.prototype.C = function () {
            sC.n.C.call(this); var b = this; this.RA = $(".js-topic-feed-container", this.g); this.RA.find(".js-topic-item").each(function () { var c = new tC; b.J(c); c.o(this) }); this.Os = new uC; this.Os.o($(".js-pinned-topics", this.element)[0]); (this.bc = H("js-load-more")) && this.h().e(this.bc, "click", this.Gy); $(".instruction .close-normal").click(function () { var b = new V(m); b.ajax("/notifeature?feature=6", k, "GET"); xd(b, "success", function () { $(".instruction").fadeOut() }) }); this.h().e(this.Os, "change", function (b) {
                $("#tf-" +
                b.aI).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')
            })
        }; a.vC = function (b, c) { yc(b, c ? "加载中..." : "更多") }; sC.prototype.Gy = function () { vC(this.bc, j); this.xhr = new V(j); P(this.h(), this.xhr, "complete", v(this.mf, this)); var b = new Lk; b.add("page", ++this.page); this.xhr.ajax(location.pathname, b.Kc()) };
        sC.prototype.mf = function () { var b = this, c = Ie(this.xhr); c && !c.r && (0 < c.msg.length ? ($(c.msg).each(function (c, e) { var g = new tC; b.J(g); g.o($(e)[0]); b.RA.append(g.m()) }), vC(this.bc, m)) : $(this.bc).hide()) }; a.tC = function () { T.call(this) }; y(tC, T); tC.prototype.C = function () { tC.n.C.call(this); this.h().e(this.g, "click", v(this.uy, this)) };
        tC.prototype.uy = function (b) {
            var c = b.target, b = $(c).attr("data-action"), d = $(this.g).find(".topic-avatar img"), e = d.clone(), g, h = $(this.g).data("id"); if ("pin-topic" === b) g = this.getParent().Os, $.post("/pin-topic/add", { tid: h }, $.proxy(function (b) { !b.r && b.msg ? ($(this.g).append($(this.pS({ topic: b.msg })).hide().fadeIn()), wC(this)) : U(b.msg, 2E3) }, g)).done(function (b) {
                if (!b.r && b.msg) {
                    Gk(c); $(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="zg-gray unpin topic-hover-content" style=""><i class="z-icon-unpin"></i>取消固定</a>');
                    var b = d.offset(), h = $(g.g).offset(); 1E3 < b.top - h.top ? (h = $(".top-nav-topic-selector.current a").offset(), h = { top: h.top + 20, left: h.left + 15, width: "25px", height: "25px", opacity: 0.1 }, e.css({ position: "absolute", "z-index": "999" }).css("top", b.top).css("left", b.left).appendTo("body").animate(h, 300, function () { e.remove() })) : e.css({ position: "absolute", "z-index": "999" }).appendTo("body").css("top", b.top).css("left", b.left).animate({ top: h.top - 63 + $(g.g).height(), left: h.left, width: "-=50px", height: "-=50px", opacity: 0.5 },
                    300, function () { e.remove() })
                }
            }); else if ("unpin-topic" === b) { var l = this.getParent().Os, n = function () { var b = $(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')[0]; Gk(b) }, q = $(l.g).find("[data-topicid=" + h + "]"); q.fadeOut(function () { q.remove(); l.Ht().done(function () { n && n() }); l.dispatchEvent({ type: "change", aI: q.attr("data-topicid") }) }) } else if ("follow" === b || "unfollow" === b) on(c, "topic", k, ["follow", "unfollow"]),
            $(this.g).fadeOut()
        }; a.uC = function () { T.call(this) }; y(uC, T); uC.prototype.pS = Rk('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
        uC.prototype.C = function () { uC.n.C.call(this); this.h().e(this.g, "click", v(this.uy, this)); wC(this) }; a.wC = function (b) { b.Ff && b.Ff.H(); var c = new Yl; c.Xq = "pin-topic-moving"; Zl(c, b.g, 0); c.B(); b.h().e(c, "dragend", v(b.Ht, b)); b.Ff = c; $("a", b.g).each(function () { b.h().e(this, "mousedown", function (b) { b.stopPropagation() }) }) };
        uC.prototype.uy = function (b) { var c = this, d = b.target, e = $(d).attr("data-action"); if (e) { var g = $(d).parents(".js-pin-item"); if ("up" === e) { var b = g.position(), h = g.clone(); g.before(h).css({ position: "absolute", "z-index": "999" }).css("top", b.top).animate({ top: $(c.g).position().top }, 200, function () { h.remove(); g.css({ position: "relative", top: 0 }).prependTo(c.g); c.Ht() }); h.css("opacity", 0) } else "remove" === e && g.fadeOut(function () { g.remove(); c.Ht(); c.dispatchEvent({ type: "change", aI: g.attr("data-topicid") }) }) } else b.stopPropagation() };
        uC.prototype.Ht = function () { var b = []; $(this.g).find("div.js-pin-item").each(function () { b.push($(this).attr("data-topicid")) }); return $.post("/pin-topic", { topic_ids: b.join(",") }, ba()) }; a.xC = function () { T.call(this); this.lD = "even"; this.en = "current" }; y(xC, T); t = xC.prototype; t.B = function () { zs.J(this); this.o(document.body) };
        t.C = function () { xC.n.C.call(this); this.cu = $("ul.zm-topic-cat-main").children(); var b = this.td = $("div.zh-general-list"), c = new Bu({ pa: ["autoload", "nodeSource"] }); this.J(c); c.o(b.get(0)); this.h().e(c, "next", this.$p); this.mF = c; b.on("click", "a.follow", function () { on(this, "topic", xa(Gk, this), k, { follow_text: "关注" }) }); N(window, "hashchange", this.jG, m, this); this.jG() || (b.show(), this.$p()) };
        t.$p = function () { var b = this.td.show().children(); if (!b.length) return this.td.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>'); b.removeClass("no-border " + this.lD); b.filter(":odd").addClass(this.lD); b = b.last(); b.index() % 2 ? b.add(b.prev()).addClass("no-border") : b.addClass("no-border"); var b = this.qr(), c = b.params && b.params.topic_id, b = this.cu.filter(function () { return $(this).attr("data-id") === String(c) }); b.length && b.addClass(this.en).siblings().removeClass(this.en) };
        t.qr = function () { return this.td.data("init") }; t.jG = function () { var b; a: { var c = decodeURIComponent(location.hash.slice(1)); if (c && (b = this.cu.filter(function () { return $(this).text() === c }), b.length && this.cu.filter("." + this.en).text() !== c)) { b.addClass(this.en).siblings().removeClass(this.en); b = { params: { topic_id: b.data("id") } }; var d = this.qr(); $.extend(j, d, b); this.td.attr("data-init", JSON.stringify(d)); this.td.empty(); this.mF.Ii(); this.mF.Zx(); b = j; break a } b = i } return b }; a.yC = function () { T.call(this) }; y(yC, T); yC.prototype.B = function () { zs.J(this); this.o(document.body) }; yC.prototype.C = function () { yC.n.C.call(this); zC(this, "zh-global-logs-wrap"); zC(this, "zh-global-logs-questions-wrap"); zC(this, "zh-question-log-list-wrap") }; a.zC = function (b, c) { var d = H(c); if (d) { var e = new Bu; b.J(e); e.pa("locationSource", { Do: j }); e.o(d); $(d).on("click", 'a[name="revert"]', function () { if (By({ Yl: j })() === m) return m; Rx(this); return m }) } }; a.AC = function () { T.call(this) }; y(AC, T); AC.prototype.B = function () { zs.J(this); this.o(document.body) }; AC.prototype.C = function () { AC.n.C.call(this); this.Nn("zh-question-followers-list-wrap") }; AC.prototype.Nn = function (b) { if (b = H(b)) { var c = new Bu; this.J(c); c.pa("locationSource"); c.o(b) } }; a.BC = function () { }; BC.prototype.B = function () { var b = H("zh-invited-member-list"); b && (new Xx(b, "/invitation/more", "people", ["zg-btn-follow", "zg-btn-unfollow"], j)).B(); (b = H("zh-invited-sina-member-list")) && (new Xx(b, k, "people", ["zg-btn-follow", "zg-btn-unfollow"], j)).B(); H("zh-sina-invite") && (new xy).B(); new Tl(H("invite_friend")) }; a.CC = function (b, c) { var d = this.G = {}; F.extend(d, this.defaults, c || {}); this.input = b; this.Xb = d.Xb; this.ih = this.GR(); this.Uu = []; this.Uu.push({ action: "remove", method: this.removeTag, nv: d.gS, R: "删除" }); setTimeout(v(this.pg, this)) }; y(CC, Hd);
        ya(CC.prototype, {
            defaults: { source: "/topic/autocomplete", Xb: k, FL: "", Zu: m, qU: "/topic/%s", template: '<li data-id="<%=id%>"><a class="tag-link" href="<%=url%>"><%=name%></a></li>', parse: function (b) { var c = $(b); return { et: j, id: c.data("id"), url: b.href, name: c.text() } }, dT: nf, WL: "canedit", Gv: "empty", Tm: "button", gS: "remove-button" }, HT: function (b) { return wu(this.G.qU, b.url_token) }, has: function (b) { return !!z.find(this.ih, function (c) { return c.name === b.name || c.id === b.id }) }, tD: function (b) {
                return z.find(this.ih, function (c) {
                    return c.name ===
                    b
                })
            }, TX: function (b) { return z.find(this.ih, function (c) { return c.id === b }) }, Zh: function () { var b = !!pc(this.Xb).length; E.enable(this.Xb, this.G.Gv, !b); this.dispatchEvent("change") }, add: function (b, c) { if (b && (this.has(b) || this.ih.push(b), b.et = m, c || this.G.dT.call(this, b))) this.nS(b), b.et = j, this.dispatchEvent("add"), this.Zh() }, remove: function (b) { this.ih = z.filter(this.ih, function (c) { return b !== c.id }, this); this.dispatchEvent("remove"); this.Zh() }, FM: function () {
                return z.filter(this.ih, function (b) {
                    return b.et !==
                    m
                })
            }, EM: function () { return z.map(this.FM(), function (b) { return b.id }) }, nS: function (b) { b = gc(this.eH(b)); this.Xb.appendChild(b); this.Zd(b) }, eH: function (b) { return Rk(this.G.template, b) }, Y: function () { this.Xb.innerHTML = z.map(this.ih, this.eH, this).join("") }, GR: function () { return z.map(this.QD(), this.G.parse) }, QD: function () { return pc(this.Xb) }, pg: function () {
                var b = this, c = b.G, d = this.input, e = {
                    source: c.source, Tj: Ic(b.input, function (b) { return "static" !== $.css(b, "position") }), placeholder: this.input.getAttribute("placeholder"),
                    select: function (d) { b.add({ id: d.id, name: d.id ? d.label : b.input.value, url: b.HT(d), avatar: d.avatar, url_token: d.url_token }); return c.FL }, filter: function (d) { return z.filter(d, function (d) { return c.Zu && !d.id ? m : !z.find(b.ih, function (b) { return b.et && b.id === d.id }) }) }
                }, g = { Zc: function (b, c, d) { d.innerHTML = l(b.data) } }; F.extend(g, e || {}); var h = new Lp(d, g); N(h, "show", function () { 1 < h.hb.length && !h.hb[0].id && qm(h) }); var l = Rk('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
                this.$ = h; z.forEach(this.QD(), this.Zd, this); N(this.input, "keypress", function (d) { var e; if (13 === d.keyCode && !c.Zu && (e = La(this.value)) && !b.$.pb()) b.add(b.tD(e) || { id: k, name: e, url: "/topic/" + e }) }); this.Zh()
            }, removeTag: function (b) { this.remove($(b).remove().data("id")) }, JR: function (b, c) { var d = z.find(this.Uu, function (c) { return c.action === b }); d && d.method && d.method.call(this, c); this.input.focus() }, Zd: function (b) {
                var c = this.G; E.add(b, c.WL); z.forEach(this.Uu, function (d) {
                    var e = new pp(" ", yp.T()); e.rh([c.Tm, d.nv].join(" "));
                    e.Y(b); e.$a(j); e.Pc(d.R); e.addEventListener("action", function () { this.JR(d.action, b) }, m, this)
                }, this)
            }
        }); a.DC = function () { this.TA = this.UA = k };
        DC.prototype.B = function () {
            function b(b, c) { var g = K("li"), h = K("span", "item-label", b); g.appendChild(h); var l = new pp("", yp.T()); l.rh("zm-profile-tag-btn zm-profile-tag-btn-del"); l.$a(j); l.Pc("移除动作"); l.Ba(c); l.addEventListener("action", function () { var b = l.X(); e(b, m); L(g); X.bt(j); d() }); l.Y(g); Na.appendChild(g) } function c() { ja.F(X.ml() !== z.filter(X.Mb(), function (b) { return !!(b.aa & 8) }).length) } function d() { z.forEach(R, function (b) { b.selected || (b = new bz(b.text, b.value), X.Ga(b)) }); c() } function e(b, c) {
                var d = z.find(R,
                function (c) { return c.value === b }); d && (d.selected = c)
            } function g() { var b = $.grep(n.get(0).options, function (b) { return b.selected }); $.map(b, function (b) { return b.value }) } function h() { q = I.EM(); G.val(q.join(",")) } var l = $("#rq-settings-ui"), n = $("select.select", l); $(".topics-num", l); $(".actions-num", l); var q = []; this.TA = $("#rq-info-block"); l.on("click", ".beginedit-button", function (b) { b.preventDefault(); l.addClass("expanded-view") }).on("click", ".exitedit-button", function (b) { b.preventDefault(); l.removeClass("expanded-view") }).on("click",
            ".endedit-button", function (b) { b.preventDefault(); l.get(0).submit() }); var r = $(".topic-editor", l), w = $("input.topic-input", r).get(0), C = $("ul.tag-list", r).get(0), I = new CC(w, { Zu: j, Xb: C }), G = $('input[name="topics"]', r); I.on("change", h); n.on("change", g); h(); g(); r = n.get(0); Q(r, m); var R = r.options, X = new Ru; X.on("action", function (d) { d = d.target; b(d.Cg(), d.X()); e(d.X(), j); X.removeItem(d); c() }); var ja = new Ez("添加动作", X); ja.rh("menu-button"); ja.Y(r.parentNode); ja.am = j; Hz(ja); var Na = K("ul", "display-list"); d(); z.forEach(R,
            function (c) { c.selected && b(c.text, c.value) }); r.parentNode.insertBefore(Na, ja.m()); var Ra = this, r = $("#rq3-item-list"), Wa = { MT: function (b) { return $.post("/watch/thank", { id: b, rq_type: "thank" }) }, WR: function (b) { return $.post("/watch/seen", { id: b, rq_type: "seen" }) } }; r.on("click", ".read-button", function () { var b = $(this).closest(".rq-item"), c = b.data("id"); Wa.WR(c); c = ie.text() || 0; 0 < c && ie.text(c - 1); var d = Ra.TA, e = Number(Ra.UA.text()); setTimeout(function () { d.toggleClass("hidden", !!e) }, 210); b.slideUp(function () { b.remove() }) }).on("click",
            ".thank-button", function (b) { b.preventDefault(); var b = $(this), c = b.closest(".rq-item").data("id"); b.hasClass("thanked") || (Wa.MT(c), b.addClass("thanked").text("已感谢")) }); Sx(r); r = new Su(r.get(0), location.href, j); r.HG = function (b) { return b.getAttribute("data-id") }; r.Yg("rq-item"); r.B(); var r = $("#rq3-sidenav-link"), ie = $(".zg-num", r); this.UA = ie
        }; a.EC = function () { }; EC.prototype.B = function () { $("a.js-obfuscate-email").each(function () { var b = $(this), c = b.data("email").split("").reverse().join(""); b.attr("href", "mailto:" + c).text(c) }) }; a.FC = function () { }; y(FC, T); FC.prototype.B = function () { zs.J(this); this.o(document.body) }; FC.prototype.C = function () { FC.n.C.call(this); var b = $("#zh-following-question-item-list").children(".zh-general-list"); if (b.length) { var c = new Bu; this.J(c); c.pa("nodeSource"); c.o(b.get(0)) } }; a.GC = function () { T.call(this) }; y(GC, T); GC.prototype.C = function () { this.h().e(this.g, "click", this.vo) }; GC.prototype.vo = function (b) { var c = b.target; c && "rmdraft" === c.name && Di("删除草稿", "你确定要删除这个草稿吗？", function (b) { b && (Gi("/answer/draft/delete", k, "POST", "qid=" + c.id.split("-")[1]), L(this.g)) }, this) }; a.HC = function () { }; y(HC, T); HC.prototype.B = function () { var b = H("zh-draft-page-wrap"); b && this.o(b) };
        HC.prototype.C = function () { N(H("zh-clear-all-draft"), "click", function () { Di("删除所有草稿", "你确定要删除所有草稿吗？删除后将无法恢复", function (b) { b && Gi("/draft/clear", function () { window.location.href = "/draft" }, "POST") }); return m }); this.Nn() }; HC.prototype.Nn = function () { var b = H("zh-draft-item-list"); if (b) { var c = new Bu; c.pa("locationSource", { Do: j }).pa("childConstructor", { Li: GC }); c.o(b) } }; a.IC = function () { this.Tg = "explore"; this.fM = "explore_feed" }; y(IC, T); IC.prototype.B = function () { zs.J(this); this.o(document.body) };
        IC.prototype.C = function () {
            IC.n.C.call(this); var b = this, c = $("#js-explore-tab"); if (c.length) {
                var d = $(".tab-panel", c), e = $(".tab-nav", c), g = k; e.children().click(function () { g = ac(document) }); c = function () {
                    var c = { "daily-hot": 0, "monthly-hot": 1 }[window.location.hash.slice(1)] || 0; e.removeClass("active").eq(c).addClass("active"); c = d.hide().eq(c).show().children("[data-type]"); if (!c.data("inited")) { c.data("inited", j); var h = { daily: Hy, monthly: Jy }[c.data("type")], h = new JC(h); h.pa("expandLimit"); b.J(h); h.o(c[0]) } g &&
                    window.scrollTo(g.x, g.y)
                }; this.h().e(window, "hashchange", c); c()
            } this.rx(); if (c = $("#zh-recommend-list-full>.zh-general-list")[0]) { var h = new Bu; h.pa("nodeSource"); tu(h, function (b) { var c = hx(b); c && (h.J(c), c.o(b)) }); this.J(h); h.o(c) } this.h().e(this, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("category", this.Tg).fill("label", this.fM) })
        }; IC.prototype.rx = function () { var b = 1, c = $("ul.hot-favlists"), d = k; $("#js-hot-fav-switch").click(function () { d && "pending" === d.state() || (b = 5 <= b ? 1 : b + 1, d = Iy(b).done(function (b) { c.html(b) })) }) };
        a.JC = function (b) { su.call(this, { source: function () { return b($(this.Mb()).last().data("offset")).then(function (b) { return { results: b } }) }, pa: ["autoload"] }) }; y(JC, Bu); JC.prototype.C = function () { JC.n.C.call(this); this.pa("childConstructor", { Li: bx }) }; a.KC = function () { T.call(this) }; y(KC, T); KC.prototype.B = function () { zs.J(this); this.o(document.body) }; KC.prototype.C = function () { KC.n.C.call(this); this.Nn() }; KC.prototype.Nn = function () { var b = H("js-suggest-people"); if (b) { var c = 0, d = new Bu({ source: function () { return $.get("", { start: c + 20, limit: 20 }).then(function (b) { if (!b.r) return b = b.msg, b.hasmore && (c += 20), { results: b.htmls, next: Boolean(b.hasmore) } }) } }); this.J(d); d.o(b) } }; a.LC = function () { su.call(this, { pa: ["autoload", "dataPagingSource"] }) }; y(LC, Bu); LC.prototype.tq = function () { return gc('<button class="feeds-loading"><span>更多</span></button>') }; LC.prototype.Qz = function (b) { this.Jd && (yc(this.Jd.firstChild, b ? "努力加载中..." : "更多"), E.enable(this.Jd, "loading", b)) }; a.MC = function () { T.call(this); this.Tg = "roundtable"; this.No = th.roundtable }; y(MC, T); MC.prototype.wi = function () { Ww.call(this, "answer"); this.Vv = "entry-expaneded"; this.jy = "item-footer" }; y(MC.prototype.wi, Ww); t = MC.prototype.wi.prototype; t.Om = function () { MC.prototype.wi.n.Om.call(this, { ".js-thank": this.zr, ".js-expand": this.Ka, ".js-show": this.ZT }); this.vx() }; t.Ka = function (b) { b && (b.target && "A" === b.target.nodeName) && b.preventDefault(); MC.prototype.wi.n.Ka.call(this, Boolean(b)) };
        t.ZT = function () { var b = $(".voters", this.m())[0], b = $(b), c = b.find(".member"); c.removeClass("hide"); c.removeClass("hide-mark"); b.siblings().remove(); b.after($("<span>赞同</span>")) };
        t.vx = function () {
            var b, c, d = $(".votebar", this.m())[0]; d && (b = this.tb = new av(this.vb, this.entryType), this.J(b), Sc(this, b), b.o(d), (d = $(".js-mobi-vote", this.m())[0]) && (new Xw(b)).o(d)); if (d = $(".zm-item-vote-info", this.m())[0]) c = new Zw(this.vb, this.entryType), this.J(c), Sc(this, c), c.o(d); b && c && this.h().e(b, "change", function () { c.ei() }).e(c, "change", function () { $("[data-bind-votecount]", this.m()).text(c.Va()) }); b = $(".phone-actions", this.m()); d = new Ru; d.o($(".menu", b)[0]); d = new Ez("operation", d); d.am = j; Hz(d);
            Gz(d); d.vc = nf; d.o($(".menubutton", b)[0])
        }; t.zr = mn(function (b) { if ((b = b.target) && !E.has(b, "thanked")) zk(b, "已感谢"), E.add(b, "thanked"), $.post("/answer/thanks", { aid: this.vb }) }, { wa: "question_answer_thank" }); t.zc = function () { MC.prototype.wi.n.zc.call(this, "分享回答", "answer", this.Gh, { aid: this.vb }) }; t.tl = mn(function () { var b = lx(); qx(b, this.vb); b.show() }, { wa: "question_answer_collect", qg: j });
        t.le = function () {
            MC.prototype.wi.n.le.call(this); wk(this.eg.register("v", function () { this.tb && this.tb.Qt() }, this), { group: "操作", name: "赞同" }); wk(this.eg.register("d", function () { this.tb && this.tb.Pt() }, this), { group: "操作", name: "反对" }); wk(wk(wk(wk(wk(this.eg.register("o", this.yf, this), { group: "操作", name: "显示全部/收起" }).register("c", this.tp, this), { group: "操作", name: "打开评论" }).register("f x", this.zc, this), { group: "操作", name: "分享" }).register("s c", this.tl, this), { group: "操作", name: "收藏" }).register("shift+c", this.Pw, this), {
                group: "操作",
                name: "定位到评论框"
            })
        }; MC.prototype.iB = function () { Ww.call(this, "question"); this.jy = "item-footer" }; y(MC.prototype.iB, Ww);
        MC.prototype.B = function () { function b(b) { b = b.getAttribute("data-type"); return (b = { answer: MC.prototype.wi, question: MC.prototype.iB }[b]) ? new b : new T } zs.J(this); this.o(document.body); this.ux(); var c = this; $("[data-paging]").each(function () { var d = new LC; d.pa("childConstructor", { factory: b }); this.getAttribute("data-navigable") !== k && d.pa("shortcut", { items: ">.item" }); c.J(d); d.o(this) }); NC(); var d = $(".rt-comment-box")[0]; if (d) { var e = new Iw(this.No.id, "roundtable"); this.J(e); e.o(d) } };
        MC.prototype.ux = function () { this.h().e(this, "click!", function (b) { "comment" === b.namespace && b.Qc.fill("label", "roundtable").fill("category", this.Tg) }) };
        a.NC = function () {
            var b = $(".roundtable-profile"); $(".share", b).click(mn(function () { var b = $(this).data(); new jv(["分享活动", "roundtable", b.token, { roundtable_id: b.id }], "tb-webshare-sina"); Y.V({ type: "ga_click_share_roundtable_box", target: this, data: { type: "sina" } }) })); $(".follow", b).click(mn(function () {
                var c = this; on(c, "roundtable", function (d) { $(".label", c).text(d ? "取消关注" : "关注"); var e = $(".followers .count", b), d = Number(e.data("count")) + (d ? 1 : -1); e.length && (d = Math.max(d, 0), e.text(d).data("count", d)) }, ["button-success",
                "button-cancel"])
            }))
        }; a.OC = function (b) { function c(b, c) { var d; d = d || "slug"; return { source: b, filter: function (b) { return b.filter(function (b) { return c.every(function (c) { return c[d] !== b[d] }) }) }, select: function (b) { c.push(b); return "" } } } this.lt = b; b.activityUrl = ""; var b = this.lt, d = b.roundtable; b.topicsSuggestOpitons = c("/r/ac/topics", d.topics); b.organizationsSuggestOpitons = c("/r/ac/topics", d.organizations); b.presentersSuggestOpitons = c("/r/ac/users", d.presenters); b.guestsSuggestOpitons = c("/r/ac/users", d.guests) }; OC.$inject = ["$scope"];
        OC.prototype.removeTag = function (b, c) { b.splice((0, z.indexOf)(b, c), 1) }; OC.prototype.moveupTag = function (b, c) { var d = (0, z.indexOf)(b, c); 0 < d && (b.splice(d, 1), b.splice(d - 1, 0, c)) }; OC.prototype.onActvityUrlChange = function () { var b = this.lt, c = b.activityUrl, d = b.roundtable.activityUrls; c && -1 === (0, z.indexOf)(d, c) && (d.push(c), b.activityUrl = "") };
        OC.prototype.submit = function (b, c) { var d = "create" === c, e = { roundtable: JSON.stringify(b) }; if (d && 3 > b.activityUrls.length) return U("请至少添加三条动态"); $.post(location.pathname + location.search, e).then(function (d) { d.success ? "create" === c ? (U(d.message || "活动创建成功，请等待审核"), setTimeout(function () { location.href = "/roundtable" }, 3E3)) : (U(d.message || "活动修改成功"), setTimeout(function () { location.href = "/roundtable/" + b.slug }, 3E3)) : U(d.message || "提交失败") }) }; a.PC = function (b, c) { var d = { Ed: 5, className: "ui-suggest", gi: "row", pD: 200 }; F.extend(d, c || {}); var e = d.Y; e && (d.Zc = ha, d.Y = function (b, c) { e.apply(this, arguments) !== m && (b.bg = Wb(b.gi, c)) }); Lp.call(this, b, d); var g = this.N; g.className = d.className; g.gi = d.gi; g.lo = d.pD }; y(PC, Lp); a.QC = function (b, c) { return function (d, e, g) { $(e).datetimepicker({ autoclose: j, forceParse: m, format: "yyyy 年 m 月 d 日 hh:ii", startDate: new Date, language: "zh-CN" }); c(function () { $(e).datetimepicker("update", new Date(b(g.ngModel)(d))) }) } }; QC.$inject = ["$parse", "$timeout"];
        a.RC = function () { return { scope: { id: "@id", avatar: "=avatar" }, link: function (b, c) { var d = new Ql(4, b.id, "xl"); d.o(c); d.addEventListener("success", function () { b.$apply(function () { b.avatar.id = d.getData() }) }) } } }, a.SC = function (b) {
            return {
                scope: { options: "=suggestOptions" }, link: function (c, d, e) {
                    var g, h, e = { CS: '<div class="row"><img class="avatar" src="[[avatar | avatarUrl]]"><span class="name">[[name]]</span></div>', pD: 100, source: e.source, Tj: d.parent()[0], Y: function (b, c, d) { c.innerHTML = d.map(function (b) { return h(b.data) }).join("") } };
                    h = b(e.CS); angular.extend(e, c.options); if (e.select) { var l = e.select; e.select = function (b) { return c.$apply(function () { return l(b) }) } } g = new PC(d[0], e); return c.$on("destroy", function () { return g.H() })
                }
            }
        }; SC.$inject = ["$interpolate"]; a.TC = function () { return function (b, c) { return "string" === typeof b ? b : b.template.replace("{id}", b.id).replace("{size}", c || "xs") } }, a.UC = function (b) { b.startSymbol("[[").endSymbol("]]") }; UC.$inject = ["$interpolateProvider"]; a.VC = function () { MC.call(this); this.No = th.roundtable }; y(VC, MC);
        VC.prototype.B = function () {
            zs.J(this); this.o(document.body); var b = $(".add-pending-activities-form"); if (b.length) {
                var c = $(".url", b), d = this.No; b.submit(function (b) {
                    function e(b) { b.success ? (U("添加成功"), setTimeout(function () { location.reload() }, 3E3)) : U(b.message || "提交失败") } b.preventDefault(); if (!c.val()) return U("回答或问题地址必须填写"); var b = (b = c.val().match(/\/question\/\d+\/answer\/(\d+)/)) && b[1], g = c.val().match(/\/question\/(\d+)/), g = g && g[1]; b ? $.post("/roundtable/" + d.slug, {
                        action: "add_pending_activity", type: "answer",
                        url_token: b
                    }, e) : g ? $.post("/roundtable/" + d.slug, { action: "add_pending_activity", type: "question", url_token: g }, e) : U("回答或问题地址不正确")
                })
            } var e = this.No; $(".feeds.pending-questions").on("click", ".add", function () { var b = $(this).data("token"), c = $(this).closest(".item"); $.post("/roundtable/" + e.slug, { action: "approve_question", url_token: b }).then(function (b) { b.success ? c.fadeOut(function () { c.remove() }) : U(b.message || "提交失败") }) }).on("click", ".remove", function () {
                var b = $(this).data("token"), c = $(this).closest(".item"); $.post("/roundtable/" +
                e.slug, { action: "ignore_question", url_token: b }).then(function (b) { b.success ? c.fadeOut(function () { c.remove() }) : U(b.message || "提交失败") })
            }); var g = this.No; $(".feeds.pending-activities").on("click", ".remove", function () { var b = $(this).data(), c = $(this).closest(".item"); $.post("/roundtable/" + g.slug, { action: "remove_pending_activity", type: b.type, url_token: b.token }).then(function (b) { b.success ? c.fadeOut(function () { c.remove() }) : U(b.message || "提交失败") }) }); NC()
        }; Ca("ZH.entryQuestionLog", function () { (new yC).B() }); Ca("ZH.entryQuestionFollowersPage", function () { (new AC).B() }); Ca("ZH.entrySQ", function () { (new hC).B() }); Ca("ZH.entrySA", function () { (new qC).B() }); Ca("ZH.entryL", function () { (new Ly).B() }); Ca("ZH.entryT", function () { (new Dy).B() }); Ca("ZH.entryTS", function () { (new xC).B() }); Ca("ZH.entryP", function () { (new Tx).B() }); Ca("ZH.entryM", function () { (new oy).B() }); Ca("ZH.entryPM", function () { (new Fu).B() }); Ca("ZH.entryPMDetail", function () { (new Gu).B() });
        Ca("ZH.entryHelp", function () { (new ou).B() }); Ca("ZH.entryInvite", function () { (new BC).B() }); Ca("ZH.entryQueue", function () { (new ly).B() }); Ca("ZH.entryTest", ba()); Ca("ZH.entrySettings", function () { (new ty).B() }); Ca("ZH.entryTopicFeed", function () { (new sC).B() }); Ca("ZH.entryTest", function () { (new Ut.YW).B() }); Ca("ZH.entryRQ3", function () { (new DC).B() }); Ca("ZH.entryTerms", function () { (new EC).B() }); Ca("ZH.entryHome", function () { (new $y).B() }); Ca("ZH.entryQuestionFollowing", function () { (new FC).B() });
        Ca("ZH.entryDraft", function () { (new HC).B() }); Ca("ZH.entryExplore", function () { (new IC).B() }); Ca("ZH.entryLookup", function () { (new KC).B() }); Ca("ZH.entryCC", function () { $(function () { $("#js-apply-button").click(mn(function () { $.post("/classical-chinese"); var b = $(this), c = b.data("num"); b.text("您已申請使用").addClass("disabled"); $(".apply-num").text("已有 " + (c + 1) + " 人申請") })) }) }); Ca("ZH.entryRb", function () { (new MC).B() });
        Ca("ZH.entryRbEdit", function () { var b = angular.module("roundtableApp", []); b.controller("RoundtableFormCtrl", OC); b.directive("uiAvatarEditor", RC); b.directive("uiSuggest", SC); b.directive("uiTimepicker", QC); b.filter("avatarUrl", TC); b.config(UC); angular.bootstrap(document.body, ["roundtableApp"]) }); Ca("ZH.entryRbPending", function () { (new VC).B() }); If("app");
    }
})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js